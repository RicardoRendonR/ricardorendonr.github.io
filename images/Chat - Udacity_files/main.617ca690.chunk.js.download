(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){e.exports={nav:"lobby-list-item_nav__1YdI9",roomList:"lobby-list-item_roomList__UIueH",navHeader:"lobby-list-item_navHeader__21pWq",ndTitle:"lobby-list-item_ndTitle__3dYVZ",programTitle:"lobby-list-item_programTitle__3WTft",rooms:"lobby-list-item_rooms__3TOGj",groupingHeader:"lobby-list-item_groupingHeader__37r06",default:"lobby-list-item_default__1w5bc",conversationsList:"lobby-list-item_conversationsList__30HSD",conversationsListInner:"lobby-list-item_conversationsListInner__3yzIY",conversationsLink:"lobby-list-item_conversationsLink__2CRcp",unreadsOverlayBottom:"lobby-list-item_unreadsOverlayBottom__-ClGT",unreadsOverlayTop:"lobby-list-item_unreadsOverlayTop__3VRuD",notificationContainer:"lobby-list-item_notificationContainer__1Wkax",roomListItem:"lobby-list-item_roomListItem__1Abha",archiveButton:"lobby-list-item_archiveButton__asJ_J",locked:"lobby-list-item_locked__2I8Kn",selected:"lobby-list-item_selected__yAvGt",unlocked:"lobby-list-item_unlocked__3Qs7p",layout:"lobby-list-item_layout__2Gy72",content:"lobby-list-item_content__Dt2kd",roomStatus:"lobby-list-item_roomStatus__39UVV",right:"lobby-list-item_right__3cZEt",icon:"lobby-list-item_icon__3k-Ee",activityContainer:"lobby-list-item_activityContainer__1-FB1",lockedTooltip:"lobby-list-item_lockedTooltip__1m3Oy"}},112:function(e,t,n){e.exports={accordion:"accordion_accordion__eiJ6U",link:"accordion_link__208jk",open:"accordion_open__1YyE-",closed:"accordion_closed__s92lo",caret:"accordion_caret__39WJz",rotated:"accordion_rotated__H1yCP",unrotated:"accordion_unrotated__2psKQ"}},114:function(e,t,n){e.exports={message:"topic_message__3610s",messageInner:"topic_messageInner__3LmkW",avatar:"topic_avatar__1D0n1",name:"topic_name__3FCIX",imageWrapper:"topic_imageWrapper__HeKbe",downloadButtonWrapper:"topic_downloadButtonWrapper__2rtOy"}},124:function(e,t,n){e.exports={avatar:"avatar_avatar__3MBHJ","avatar-role--mentor":"avatar_avatar-role--mentor__xOOaU","avatar-role--staff":"avatar_avatar-role--staff__1PxkI","avatar-size--sm":"avatar_avatar-size--sm__2JEUd","avatar-size--md":"avatar_avatar-size--md__2Lary","avatar-size--lg":"avatar_avatar-size--lg__2fNrv","avatar-size--xl":"avatar_avatar-size--xl__1KbzF",onlineIndicator:"avatar_onlineIndicator__2fXg6",clickable:"avatar_clickable__3aYWp",previewError:"avatar_previewError__1Fa5Y"}},125:function(e,t,n){e.exports={badge:"badge_badge__3RgaW",mentor:"badge_mentor__1JU7D badge_badge__3RgaW",text:"badge_text__2j5se",staff:"badge_staff__2pcJ_ badge_badge__3RgaW",mentee:"badge_mentee__3cnh- badge_badge__3RgaW"}},126:function(e,t,n){e.exports={unstyledButton:"modal_unstyledButton__1jmw9",close:"modal_close__1tAYT",closeBottom:"modal_closeBottom__j2DPi",content:"modal_content__3pHCK",fullscreen:"modal_fullscreen__1t0Q2",overlay:"modal_overlay__1dVZ-"}},127:function(e,t,n){e.exports={link:"knowledge-link_link__3VpB0",title:"knowledge-link_title__2MXTi",body:"knowledge-link_body__3wyIo",answers:"knowledge-link_answers__3Sy1w",icon:"knowledge-link_icon__3TvJl",text:"knowledge-link_text__3YoOP"}},128:function(e,t,n){e.exports={hide:"markdown-key_hide__3rlqI",code:"markdown-key_code__3K2iJ",markdownKeyContainer:"markdown-key_markdownKeyContainer__3PzhB",markdownKey:"markdown-key_markdownKey__NUPY2",fadeIn:"markdown-key_fadeIn__HIIB3",fadeOut:"markdown-key_fadeOut__6f0iP"}},129:function(e,t,n){e.exports={sidebar:"room-details_sidebar__2-1o6",channelMeta:"room-details_channelMeta__1ji-p",channelSummary:"room-details_channelSummary__3N01a",participants:"room-details_participants__4-2Jy",messageAction:"room-details_messageAction__2SArr"}},130:function(e,t,n){e.exports={progressWrapper:"file-progress_progressWrapper__1v877",progressBar:"file-progress_progressBar__2_pnq",progressBarProgress:"file-progress_progressBarProgress__YeuNs",Gradient:"file-progress_Gradient__EVErp",progressContentGrid:"file-progress_progressContentGrid__39M2T",cancelButtonWrapper:"file-progress_cancelButtonWrapper__3Wl7r",cancelButton:"file-progress_cancelButton__GjZyq"}},131:function(e,t,n){e.exports={lobby:"lobby-scene_lobby__1C1Vk",main:"lobby-scene_main__2ifEa",contextSidebarHidden:"lobby-scene_contextSidebarHidden__2J3eI",section:"lobby-scene_section__qUsn0",contextSidebar:"lobby-scene_contextSidebar__DgDqK",overlay:"lobby-scene_overlay__IoN5C"}},132:function(e,t,n){e.exports={rating:"mentor-rating-inputs_rating__3tHkg",questions:"mentor-rating-inputs_questions__2ye45",section:"mentor-rating-inputs_section__3IOIX"}},154:function(e,t,n){e.exports={transitionDuration:"400ms",alertWrapper:"toast-alert_alertWrapper__1n2eV",slideUp:"toast-alert_slideUp__2iRYv",slideOut:"toast-alert_slideOut__39CUe",slideDown:"toast-alert_slideDown__1whsL",dismissButton:"toast-alert_dismissButton__1QzP_"}},156:function(e,t,n){e.exports={banner:"new-messages-banner_banner__1figw",container:"new-messages-banner_container__11aCS",buttons:"new-messages-banner_buttons__2TFPA",numMessages:"new-messages-banner_numMessages__1Ctqw",flexEnd:"new-messages-banner_flexEnd__1UlYq"}},157:function(e,t,n){e.exports={nanodegreeList:"nanodegree-list_nanodegreeList__ueqMb",subheading:"nanodegree-list_subheading__1XenN",borderTop:"nanodegree-list_borderTop__3jFK4",graduatedListItem:"nanodegree-list_graduatedListItem__vmusU",marginBottom:"nanodegree-list_marginBottom__2I1Gt"}},158:function(e,t,n){e.exports={editPhoto:"edit-avatar-button_editPhoto__224Mm",avatarMenu:"edit-avatar-button_avatarMenu__2MdLI",avatarList:"edit-avatar-button_avatarList__UEntW"}},159:function(e,t,n){e.exports={dropTargetWrapper:"file-drop-target_dropTargetWrapper__DKsq9",fileDropTrigger:"file-drop-target_fileDropTrigger__31H2m",dropTargetPlaceholder:"file-drop-target_dropTargetPlaceholder__248KB",dropTargetActive:"file-drop-target_dropTargetActive__2bT_y",iconWrapper:"file-drop-target_iconWrapper__3ENj1"}},175:function(e,t,n){e.exports={markdown:"markdown-renderer_markdown__3Lwfm",mention:"markdown-renderer_mention__3arsv"}},177:function(e,t,n){e.exports={participant:"participant-list-item_participant__3qUYo",active:"participant-list-item_active__1tkBn",inactive:"participant-list-item_inactive__1v-uV",link:"participant-list-item_link__3T93P",right:"participant-list-item_right__24IWg",avatar:"participant-list-item_avatar__2i3pU"}},178:function(e,t,n){e.exports={sidebar:"participant-list_sidebar__1bmQ_",members:"participant-list_members__1E5gG",person:"participant-list_person__1L-0v",participants:"participant-list_participants__SlU8g",participantHeader:"participant-list_participantHeader__2xayz",more:"participant-list_more__20lb6",loading:"participant-list_loading__14XB4",note:"participant-list_note__qZBCD"}},179:function(e,t,n){e.exports={threadLink:"thread-link_threadLink__2AdJS",link:"thread-link_link__1BlZH",badge:"thread-link_badge__1PaI5",timestamp:"thread-link_timestamp__3xxS-"}},180:function(e,t,n){e.exports={emojiButton:"emoji-button_emojiButton__UB0-N",tooltipMark:"emoji-button_tooltipMark__3gam9",emoji:"emoji-button_emoji__2JVVw",emojiCount:"emoji-button_emojiCount__1cF70"}},181:function(e,t,n){e.exports={staticImage:"static-image_staticImage__2pz5p",loaded:"static-image_loaded__2NYHB",placeholder:"static-image_placeholder__2tjU4"}},182:function(e,t,n){e.exports={container:"bio-preview_container__1bTaP",bioContainer:"bio-preview_bioContainer__20TvN",bio:"bio-preview_bio__1xXlO",avatar:"bio-preview_avatar__3r_zR",name:"bio-preview_name__3puAx"}},183:function(e,t,n){e.exports={threadListContainer:"thread-list_threadListContainer__22uHG",header:"thread-list_header__2pYyx",threadList:"thread-list_threadList__3FxwR",threadListItem:"thread-list_threadListItem__34qDA"}},184:function(e,t,n){e.exports={newThread:"new-thread-container_newThread__wY6rC",subHeader:"new-thread-container_subHeader__2cywC",messageList:"new-thread-container_messageList__WxkQQ",chatInputWrapper:"new-thread-container_chatInputWrapper__1SzeY"}},185:function(e,t,n){e.exports={threadHeader:"thread-header_threadHeader__1Oedv",titleContainer:"thread-header_titleContainer__1d5Od",title:"thread-header_title__3LOqU",headerRight:"thread-header_headerRight__9ji95"}},186:function(e,t,n){e.exports={newConversation:"new-conversation-container_newConversation__18nnY",messageList:"new-conversation-container_messageList__29w5c",chatInputWrapper:"new-conversation-container_chatInputWrapper__2RRCd",empty:"new-conversation-container_empty__bf60j"}},187:function(e,t,n){e.exports={"pagination-wrapper":"pagination-footer_pagination-wrapper__N3Ura","pagination-text-wrapper":"pagination-footer_pagination-text-wrapper__jPWhm"}},188:function(e,t,n){e.exports={conversation:"conversation-container_conversation__WyfvT",messageList:"conversation-container_messageList__1zpZd",chatInputWrapper:"conversation-container_chatInputWrapper__39N-Y"}},189:function(e,t,n){e.exports={room:"room-container_room__Jt9DA",messageList:"room-container_messageList__3Hc-0",chatInputWrapper:"room-container_chatInputWrapper__32Yvw",banner:"room-container_banner__2oQyR",loading:"room-container_loading__NiGZf"}},228:function(e,t,n){e.exports=n.p+"static/media/illustration_error-message-ghost.bba6a358.svg"},230:function(e,t,n){e.exports={notificationOuter:"notification-badge_notificationOuter__3nPlx",notificationInner:"notification-badge_notificationInner__v70QS",count:"notification-badge_count__2jfa7"}},231:function(e,t,n){e.exports={warningHeader:"delete-message_warningHeader__3mmsJ",modalContent:"delete-message_modalContent__3bSev",actionButtons:"delete-message_actionButtons__Nk5wC"}},232:function(e,t,n){e.exports={mentionSuggestion:"mention-suggestion_mentionSuggestion__gv6TU",channel:"mention-suggestion_channel__1Uia_",avatar:"mention-suggestion_avatar__1yrvN"}},233:function(e,t,n){e.exports={leaders:"room-leaders_leaders__CwqMU",mentorParticipants:"room-leaders_mentorParticipants__12dq2",mentorHeading:"room-leaders_mentorHeading__5w1mW"}},234:function(e,t,n){e.exports={project:"project-list-item_project__1KUjc",check:"project-list-item_check__m859l",circle:"project-list-item_circle__1BURW"}},235:function(e,t,n){e.exports={nanodegreeList:"nanodegree-list-accordion_nanodegreeList__2z2nn",nanodegree:"nanodegree-list-accordion_nanodegree__1gG1H",marginBottom:"nanodegree-list-accordion_marginBottom__X9lTz"}},237:function(e,t,n){e.exports={header:"conversation-header_header__1YKz_",titleContent:"conversation-header_titleContent__1KFo2",headerLeft:"conversation-header_headerLeft__eC0n2"}},238:function(e,t,n){e.exports={room:"thread-container_room__1_LUb",messageList:"thread-container_messageList__23Yt5",chatInputWrapper:"thread-container_chatInputWrapper__2ZIIe"}},239:function(e,t,n){e.exports={header:"room-header_header__2FLDr",headerLeft:"room-header_headerLeft__1y8SD"}},240:function(e,t,n){e.exports={navGroup:"layout-sidebar_navGroup__3nKzl",highlightedLinkWrapper:"layout-sidebar_highlightedLinkWrapper__dAuHV",highlightedLink:"layout-sidebar_highlightedLink__2_i9F",knowledgeLink:"layout-sidebar_knowledgeLink__1N_OT layout-sidebar_highlightedLink__2_i9F",studentHubLink:"layout-sidebar_studentHubLink__2cam2 layout-sidebar_highlightedLink__2_i9F",tooltip:"layout-sidebar_tooltip__3wVvC"}},241:function(e,t,n){e.exports={ratings:"mentor-ratings-scene_ratings__1cVNU",ratingsWrapper:"mentor-ratings-scene_ratingsWrapper__2cJ0M",backLink:"mentor-ratings-scene_backLink__2GD3_"}},302:function(e,t,n){e.exports={circle:"online-indicator_circle__Nx6Is",offline:"online-indicator_offline__2mefu",online:"online-indicator_online__1ucDD"}},303:function(e,t,n){e.exports={nav:"lobby-list-conversation_nav__2ef_i",roomList:"lobby-list-conversation_roomList__1QbYc",navHeader:"lobby-list-conversation_navHeader__1yWtt",ndTitle:"lobby-list-conversation_ndTitle__3O2DT",programTitle:"lobby-list-conversation_programTitle__30Koz",rooms:"lobby-list-conversation_rooms__12pYQ",groupingHeader:"lobby-list-conversation_groupingHeader__363DZ",default:"lobby-list-conversation_default__2KbKu",conversationsList:"lobby-list-conversation_conversationsList__CZ-UJ",conversationsListInner:"lobby-list-conversation_conversationsListInner__2a14h",conversationsLink:"lobby-list-conversation_conversationsLink__24uZU",unreadsOverlayBottom:"lobby-list-conversation_unreadsOverlayBottom__3fzHF",unreadsOverlayTop:"lobby-list-conversation_unreadsOverlayTop__1fSKt",notificationContainer:"lobby-list-conversation_notificationContainer__XJy49",conversationWrapper:"lobby-list-conversation_conversationWrapper__2rRW1",conversation:"lobby-list-conversation_conversation__2spNL"}},304:function(e,t,n){e.exports={form:"participant-list-search_form__HSw1c",input:"participant-list-search_input__1cBFy"}},307:function(e,t,n){e.exports={avatarGrouping:"avatar-group_avatarGrouping__2vCn9",avatarItem:"avatar-group_avatarItem__1c_pn"}},309:function(e,t,n){e.exports={editInput:"edit-user-message_editInput__3GR0j",actionButtons:"edit-user-message_actionButtons__1Ctg-"}},310:function(e,t,n){e.exports={links:"helpful-links_links__2VkgY",questions:"helpful-links_questions__3LcRq"}},311:function(e,t,n){e.exports={nanodegree:"nanodegree-title-info_nanodegree__-Ol6Y",info:"nanodegree-title-info_info__1vysb"}},312:function(e,t,n){e.exports={wrapper:"empty-conversation_wrapper__38rUV",image:"empty-conversation_image__2lB6m"}},313:function(e,t,n){e.exports={emptyLobby:"empty-lobby-scene_emptyLobby__13ICT",image:"empty-lobby-scene_image__2kdB3"}},314:function(e,t,n){e.exports={errorNotFound:"page-notfound_errorNotFound__1WVqV",image:"page-notfound_image__EnSTZ"}},315:function(e,t,n){e.exports={conversations:"conversations-scene_conversations__3UBUd",innerContent:"conversations-scene_innerContent__37vPp"}},316:function(e,t,n){e.exports={error:"error-page_error__lVM1i",image:"error-page_image__3BHgJ"}},317:function(e,t,n){e.exports={app:"app-scene_app__2zgev",contextSidebarHidden:"app-scene_contextSidebarHidden__191YR"}},318:function(e,t,n){e.exports={form:"mentor-ratings-form_form__1Ijh_",mentorRatingInputs:"mentor-ratings-form_mentorRatingInputs__2K6TA"}},319:function(e,t,n){e.exports={loading:"mentor-ratings-form-container_loading__2SHtM",complete:"mentor-ratings-form-container_complete__1F1ut"}},418:function(e,t,n){e.exports={wrapper:"lobby-list-unreads-overlay_wrapper__1U9Pn",badge:"lobby-list-unreads-overlay_badge__1pXUG"}},433:function(e,t,n){e.exports={sidebar:"lobby-scene-sidebar_sidebar__GqS_m"}},434:function(e,t,n){e.exports={close:"close-context-sidebar-button_close__dSBbV"}},435:function(e,t,n){e.exports={responsiveImage:"responsive-image_responsiveImage__222tv"}},436:function(e,t,n){e.exports={download:"download-attachment-button_download__170PS"}},437:function(e,t,n){e.exports={links:"links-list_links__1BDj3"}},446:function(e,t,n){e.exports={mentionSuggestion:"emoji-suggestion_mentionSuggestion__3AJHn"}},447:function(e,t,n){e.exports={mentions:"mentions_mentions__2c50H",mentions__suggestions__list:"mentions_mentions__suggestions__list__3IKbl",mentions__suggestions__item:"mentions_mentions__suggestions__item__yjEql","mentions__suggestions__item--focused":"mentions_mentions__suggestions__item--focused__Rzrwz",mentions__suggestions:"mentions_mentions__suggestions__288_r"}},448:function(e,t,n){e.exports={messageDivider:"message-divider_messageDivider__xVx81"}},452:function(e,t,n){e.exports={expandBtn:"truncated-text_expandBtn__1kK9P"}},453:function(e,t,n){e.exports={project:"project-description_project__22a2o"}},454:function(e,t,n){e.exports={projectList:"project-list_projectList__3pbdG"}},460:function(e,t,n){e.exports={wrapper:"thread-list-item_wrapper__2dgNu"}},461:function(e,t,n){e.exports={navToggle:"nav-sidebar-toggle_navToggle__PDloL"}},462:function(e,t,n){e.exports={emptyThreads:"empty-threads_emptyThreads__3KQiD"}},463:function(e,t,n){e.exports={button:"open-context-sidebar-button_button__1Bth7"}},465:function(e,t,n){e.exports=n.p+"static/media/illustration-dm-empty.5e95bd88.svg"},466:function(e,t,n){e.exports=n.p+"static/media/illustration_messages.e64891c0.png"},467:function(e,t,n){e.exports={inner:"conversations-list_inner__1IWhv"}},468:function(e,t,n){e.exports={loading:"message-list-container_loading__ot99B"}},469:function(e,t,n){e.exports={banner:"environment-banner_banner__RABG3"}},472:function(e,t,n){e.exports={inverted:"tooltip_inverted__1bk_I",fadein:"tooltip_fadein__2Ay3l"}},473:function(e,t,n){e.exports={textInput:"checkbox-form-group_textInput__3buUG"}},475:function(e,t,n){e.exports={rating:"stars-form-group_rating__pLUJR"}},48:function(e,t,n){e.exports={nav:"lobby-list_nav__37nGX",roomList:"lobby-list_roomList__1_cFe",navHeader:"lobby-list_navHeader__26HI7",ndTitle:"lobby-list_ndTitle__UU8jV",programTitle:"lobby-list_programTitle__37NS-",rooms:"lobby-list_rooms__3s2Oq",groupingHeader:"lobby-list_groupingHeader__1V8BN",default:"lobby-list_default__2aOLQ",conversationsList:"lobby-list_conversationsList__3DYx5",conversationsListInner:"lobby-list_conversationsListInner__1-5Jx",conversationsLink:"lobby-list_conversationsLink__4yhvs",unreadsOverlayBottom:"lobby-list_unreadsOverlayBottom__e77yr",unreadsOverlayTop:"lobby-list_unreadsOverlayTop__vSdPc",notificationContainer:"lobby-list_notificationContainer__1VLyI"}},489:function(e,t,n){e.exports=n(798)},49:function(e,t,n){e.exports={container:"project-status_container__2764z",projectStatus:"project-status_projectStatus__3RQn9",icon:"project-status_icon__Vt-Ra",greenStatus:"project-status_greenStatus__1n-9k",orangeStatus:"project-status_orangeStatus__3U7xT",blueStatus:"project-status_blueStatus__1G1yQ",redStatus:"project-status_redStatus__1maId",cta:"project-status_cta__1hXkK",ctaBtn:"project-status_ctaBtn__MHh5m"}},52:function(e,t,n){e.exports={container:"participant-details_container__1orAB",backLink:"participant-details_backLink__1brjB",hidden:"participant-details_hidden__32SNa",header:"participant-details_header__DNYR8",user:"participant-details_user__2vPCb",avatar:"participant-details_avatar__-RLDL",info:"participant-details_info__3J6yf",badge:"participant-details_badge__ZK1qs",location:"participant-details_location__S7a9x",body:"participant-details_body__1ZkDA",bioSegment:"participant-details_bioSegment__3Xq_b",bodySegment:"participant-details_bodySegment__v46XI",button:"participant-details_button__32p0t",editIcon:"participant-details_editIcon__2IFQ5"}},68:function(e,t,n){e.exports={messageMenu:"message-menu_messageMenu__3Qmr9",reactionEmojiPicker:"message-menu_reactionEmojiPicker__tt_Ne",menuItem:"message-menu_menuItem__1Dvc9",moreOptions:"message-menu_moreOptions__3SS8p",above:"message-menu_above__3YCnx",moreOptionsList:"message-menu_moreOptionsList__mMFQf"}},69:function(e,t,n){e.exports={chatInput:"chat-input_chatInput__3OWMg",mentionsInput:"chat-input_mentionsInput__3Nwdf",inputLabel:"chat-input_inputLabel__2kJo8",desktopFileButtonWrapper:"chat-input_desktopFileButtonWrapper__2OA1m",mobileFileButtonWrapper:"chat-input_mobileFileButtonWrapper__1Yltk",fileInput:"chat-input_fileInput__aXhvv",desktopFileButton:"chat-input_desktopFileButton__3plAH",chatInputWrapperGrid:"chat-input_chatInputWrapperGrid__Q2kQg",disconnected:"chat-input_disconnected__3eiom",mobileSendButton:"chat-input_mobileSendButton__KLQS4",avatarContainer:"chat-input_avatarContainer__1UCG5",controlsContainer:"chat-input_controlsContainer__3L1s6"}},784:function(e,t,n){},79:function(e,t,n){e.exports={profileForm:"profile-editor_profileForm__2tWgA",label:"profile-editor_label__2JFSg",photoSection:"profile-editor_photoSection__3MLJT",profilePhoto:"profile-editor_profilePhoto__36KVA",profilePhotoLeft:"profile-editor_profilePhotoLeft__33XQe",profilePhotoRight:"profile-editor_profilePhotoRight__24geR",error:"profile-editor_error__2MLW3",locationSection:"profile-editor_locationSection__1BVfB",buttons:"profile-editor_buttons__2qrO9"}},797:function(e,t,n){},798:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(28),s=n.n(o),i=n(6),c=n(7),u=n(10),l=n(8),d=n(9),m=n(18),p=n(34),f=n(40),_=n(53),h=n.n(_),v={isMobile:!1,isShortBrowser:!1,isContextSidebarOpen:!1,toggleContextSidebar:h.a},E=r.a.createContext(v),g=E.Provider,b=E.Consumer,O=n(80),S=n.n(O),I=n(172),y=n.n(I),T={isWindowShort:function(){return window.innerHeight<=600},isWindowMobileSize:function(){return window.innerWidth<=900},isWindowTabletSize:function(){return window.innerWidth<=1100}},j=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).updateViewState=function(){n.setState(function(e){var t=T.isWindowTabletSize();return{isMobile:t,isShortBrowser:T.isWindowShort(),isContextSidebarOpen:e.isMobile===t?e.isContextSidebarOpen:!t}})},n.toggleContextSidebar=function(e){n.setState(function(t){return{isContextSidebarOpen:y()(e)?e:!t.isContextSidebarOpen}})},n.handleResize=S()(n.updateViewState,50),n.state={isMobile:!1,isShortBrowser:!1,isContextSidebarOpen:!T.isWindowTabletSize(),toggleContextSidebar:n.toggleContextSidebar},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.updateViewState(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return r.a.createElement(g,{value:this.state},this.props.children)}}]),t}(r.a.Component),A=n(32),R=n(148),C=n.n(R),N=n(12),k=Object(N.a)({},Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_ENV:"production",REACT_APP_NAME:"HubWeb",REACT_APP_ROOT_PHOTO_URL:"https://cdn.udacity.com/profile/production/photo/",REACT_APP_COMMUNITY_API_URL:"https://community-api.udacity.com/api/v1",REACT_APP_CLASSROOM_API_URL:"https://classroom-content.udacity.com/api/v1",REACT_APP_UCHAT_REAL_TIME_API_URL:"wss://uchat-realtime.udacity.com",REACT_APP_PROFILES_API_URL:"https://profiles-gql.udacity.com",REACT_APP_CLASSROOM_URL:"https://classroom.udacity.com",REACT_APP_SEGMENT_WRITE_KEY:"gV62XbeEY1FlWnGNY6QQpOhTfy6YjLGb",REACT_APP_KNOWLEDGE_HOME:"https://knowledge.udacity.com",REACT_APP_UPLOADER_API_URL:"https://uploader.udacity.com/api/v1",REACT_APP_STUDENT_HUB_HOME:"https://hub.udacity.com",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyDYMz1TBeOM_daW7uR9B4vfxQKT_NoQE5U",REACT_APP_HUB_BFF_API_URL:"https://hub-bff.udacity.com",REACT_APP_STATUSPAGE_STUDENTHUB_ID:"rd6mn8f3t5zw",REACT_APP_STATUSPAGE_API_URL:"https://6wfwt6j15d1z.statuspage.io/api/v2",REACT_APP_REVIEWS_HOME:"https://review.udacity.com",REACT_APP_EXPERIMENTS_API_URL:"https://experiments-api.udacity.com/api/v1",REACT_APP_SERVICES_OPTIMIZELY_PROJECT_ID:"14297780053",REACT_APP_SENTRY_DSN:"https://5134d43563cc4f79ad988d7aacf06988@sentry.io/2684195",REACT_APP_BUGSNAG_KEY:"e06758fd99505d04f4436e365ac3fd5f"}));function L(e,t){return{payload:t,type:e}}var P=function(e,t){return["READY","START","PENDING","FULFILLED","REJECTED"].reduce(function(n,a){return n["".concat(e,"_").concat(a)]="".concat(t,"/").concat(e,"_").concat(a),n},{})},w=function(e,t){return{payload:{error:t,message:t.message,state:"rejected"},type:e}},x=Object(N.a)({},P("BOOTSTRAP","SESSION"),P("FETCH_ME","SESSION"),P("UPDATE_ME","SESSION"),P("FETCH_CLASSROOM_METADATA","SESSION"),{FETCH_STATUS_FULFILLED:"".concat("SESSION","/FETCH_STATUS_FULFILLED"),SHOW_WELCOME_FLOW:"".concat("SESSION","/SHOW_WELCOME_FLOW"),HIDE_WELCOME_FLOW:"".concat("SESSION","/HIDE_WELCOME_FLOW")}),M={bootstrap:function(){return L(x.BOOTSTRAP_PENDING)},fetchProfile:function(){return L(x.FETCH_ME_START)},updateProfile:function(e){return L(x.UPDATE_ME_START,{profile:e})},fetchClassroomUserMetadata:function(e){if(e)return L(x.FETCH_CLASSROOM_METADATA_START,{userId:e})},showWelcomeFlow:function(){return L(x.SHOW_WELCOME_FLOW)},hideWelcomeFlow:function(){return L(x.HIDE_WELCOME_FLOW)}},D=n(91),U=n.n(D),F=n(217),G=n.n(F),B=n(295),H=n.n(B),V="_jwt",z="_jwt_token";function W(){U.a.signOut()}function Y(){return U.a.isAuthenticated()?H()(G.a.get(V)||G.a.get(z)):{}}var q=n(5),K=n(802),J=n(70),X="production"!==k.REACT_APP_ENV?{debug:!0}:{};K.a(Object(N.a)({dsn:k.REACT_APP_SENTRY_DSN,environment:k.REACT_APP_ENV,maxBreadcrumbs:50,ignoreErrors:["top.GLOBALS","Extension context invalidated."],blacklistUrls:[/extensions\//i,/^chrome:\/\//i,/dev.udacity.com/i]},X));var Q={fetchClassroomUserMetadata:M.fetchClassroomUserMetadata},$=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={isLoading:!0},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;C()(["development","test"],k.REACT_APP_ENV)<0&&new Promise(function(e,t){return U.a.isAuthenticated()?e():(U.a.authenticate({env:"production",returnUrl:window.location.href,authType:"/sign-in"}),t())}).then(function(){var t=function(){if(U.a.isAuthenticated()){var e=Y();return e.key||e.uid}}();t&&(!function(e){J.b({id:e})}(t),e.props.fetchClassroomUserMetadata(t),e.setState({isLoading:!1}))}).catch(function(){return new Error("Auth Token is invalid or expired.")})}},{key:"render",value:function(){return this.state.isLoading?r.a.createElement(q.h,null):r.a.createElement(r.a.Fragment,null,this.props.children)}}]),t}(r.a.PureComponent),Z=Object(A.g)(Object(m.b)(null,Q)($)),ee=n(26),te=n(51),ne=n.n(te),ae=n(4),re=n.n(ae),oe=n(100),se=n.n(oe),ie=n(81),ce=n.n(ie),ue=n(22),le=n.n(ue),de=n(30),me=n.n(de),pe=n(220),fe=n.n(pe),_e=function(e){return e},he={first:"channel",last:"",id:"@channel",type:void 0,is_active:!1,photo_url:""},ve=["11887758793","fake-blacklisted-uid-for-tests"],Ee=(_e("My Classmates"),function(e){return!me()(e)&&fe()(e,"community:thread")}),ge=function(e){return!me()(e)&&(e.includes("community:conversation")||e.includes("community:personal-mentor"))},be=function(e){return"/rooms/".concat(e,"?contextType=room")},Oe=function(e){return"/conversations/".concat(e,"?contextType=room")},Se=function(e){return e.includes("/conversations/")},Ie=function(e){return e.includes("/not-found")},ye=function(e,t){return e.split("?")[0]+"?contextType=profile&profileId=".concat(t)},Te=function(e,t){var n=e.join("-"),a="/conversations/new/".concat(n);return t&&(a+="?roomId=".concat(t)),a},je=n(38),Ae=n.n(je),Re=n(21),Ce=n.n(Re),Ne=n(14),ke=n(230),Le=n.n(ke),Pe=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.mentionsCount,t=e&&e>99?"99+":e;return r.a.createElement("div",{title:_e("Notification"),className:Le.a.notificationOuter},e?r.a.createElement("span",{title:_e("mentions"),className:Le.a.count},r.a.createElement(q.m,{size:"xs",spacing:"none"},t)):r.a.createElement("span",{title:_e("Unread messages"),className:Le.a.notificationInner}))}}]),t}(r.a.PureComponent),we=n(104),xe=n.n(we),Me=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).isActive=function(e,t){return!!t&&t.pathname.split("/")[2]===n.props.path.split("?")[0].split("/")[2]},n.onArchiveClick=function(e){e.preventDefault();var t=n.props,a=t.onArchiveClick,r=t.roomId;Ae()(a)&&r&&a(r)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onArchiveClick,n=e.isLocked,a=e.path,o=e.hasUnreadMessages,s=e.mentionsCount,i=e.className,c=e.content,u=e.onNavLinkClick,l=Ae()(t),d=n?"locked":"unlocked",m=!n&&o;return r.a.createElement(p.c,{to:n?"#":a,className:Ce()(xe.a.roomListItem,xe.a[d],i),activeClassName:xe.a.selected,isActive:this.isActive,onClick:u,"data-has-unreads":!(!o&&!s)},r.a.createElement("div",{className:xe.a.layout},r.a.createElement("div",{className:xe.a.content},c,n&&r.a.createElement(q.m,{color:"silver",size:"xs",spacing:"none","data-ref":"locked-text"},_e("This channel is locked."))),r.a.createElement("div",{className:xe.a.roomStatus},n&&r.a.createElement("div",{className:xe.a.icon},r.a.createElement(Ne.A,{"aria-describedby":"locked"})),m&&r.a.createElement(Pe,{mentionsCount:s}),l&&r.a.createElement(q.o,{direction:"bottom",content:"Hide conversation",trigger:r.a.createElement("button",{className:xe.a.archiveButton,onClick:this.onArchiveClick,"data-tst":"archive-btn"},r.a.createElement(Ne.r,{color:"white",size:"sm","aria-describedby":"archive"})),inverse:!0}))))}}]),t}(r.a.Component);Me.defaultProps={content:r.a.createElement("div",null),isLocked:!1,path:void 0,hasUnreadMessages:!1,hasVisited:!0};var De=function(e){return r.a.createElement(f.LayoutConsumer,null,function(t){var n=t.isMobile,a=t.toggleSidebar;return r.a.createElement(Me,Object(N.a)({},e,{onNavLinkClick:function(){return n&&a()}}))})},Ue=new(function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"set",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;if(a.hasOwnProperty("localStorage")){var r=this.makeNamespacedKey(e,n);a.localStorage.setItem(r,JSON.stringify(t))}}},{key:"get",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!n.hasOwnProperty("localStorage"))return{};var a=this.makeNamespacedKey(e,t),r=n.localStorage.getItem(a);return r?JSON.parse(r):void 0}},{key:"makeNamespacedKey",value:function(e,t){return t?"".concat(t,"/").concat(e):e}}]),e}()),Fe=n(112),Ge=n.n(Fe),Be=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={isOpen:n.props.defaultToOpen||!1},n.onClick=function(){n.setState(function(e){return{isOpen:!e.isOpen}},n.saveAccordionStateToLocalStorage)},n.saveAccordionStateToLocalStorage=function(){var e=n.props.accordionKey;e&&Ue.set("".concat(e,"IsOpen"),n.state.isOpen)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.accordionKey;if(e){var t=Ue.get("".concat(e,"IsOpen")),n=!!me()(t)||t;this.setState({isOpen:n})}}},{key:"render",value:function(){var e,t=this.props,n=t.title,a=t.children,o=t.className,s=this.state.isOpen,i=s?Ge.a.open:Ge.a.closed;return r.a.createElement("div",{className:Ce()(Ge.a.accordion,o,{open:s,closed:!s})},r.a.createElement("button",{onClick:this.onClick,className:Ge.a.link},r.a.createElement("span",null,n),r.a.createElement("div",{className:Ce()(Ge.a.caret,(e={},Object(ee.a)(e,Ge.a.unrotated,!s),Object(ee.a)(e,Ge.a.rotated,s),e))},r.a.createElement(Ne.i,{size:"sm"}))),r.a.createElement("div",{className:i},a))}}]),t}(r.a.PureComponent);Be.defaultProps={defaultToOpen:!1};var He=Be,Ve=n(418),ze=n.n(Ve),We=function(e){var t=e.position||"bottom";return r.a.createElement("div",{className:ze.a.wrapper},"bottom"===t&&r.a.createElement(Ne.a,{color:"blue",size:"sm"}),"top"===t&&r.a.createElement(Ne.d,{color:"blue",size:"sm"}),r.a.createElement(q.e,{size:"h6",color:"blue"},"Unread Messages"))},Ye=n(72),qe=n.n(Ye),Ke=(n(419),n(420)),Je=n.n(Ke),Xe=n(296),Qe=n.n(Xe),$e=n(301),Ze=n.n($e),et=n(421),tt={ENTER:13},nt=/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/,at=36,rt={UUID_FORMAT:nt,UID_FORMAT:/(user:\/\/(u?\d.*|@channel|[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}))/,UID_PREFIX:"user://",FORMAT:/(\[@.*\]\(user:\/\/(u?\d.*\)|@channel|[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}))/,PARSE_FORMAT:/\[@[^\]]*\]\(user:\/\/((u?\d+)|@channel|[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})\)/g},ot={IMPOSSIBLE_MATCH:/^(?=a)b/,"@":"@",":":":"},st=25;function it(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Qe()(t))return e;var r=t.codePointAt(0);if(!r)return e;var o=String.fromCodePoint(r).toUpperCase();return"".concat(e).concat(a?"":" ").concat(o).concat(n?"":".")}var ct=function(e,t,n){return 1===e?t:n||t+"s"};function ut(e){var t=Ze()(e,"id"),n=t.length||0,a=n-1,r=function(e){return e.map(function(e){return it(re()(e,"first_name"),re()(e,"last_name"),!0)})}(t);switch(n){case 0:return"";case 1:return r[0];case 2:case 3:case 4:return _e("".concat(r.slice(0,a).join(", ")," and ").concat(r[a]));default:return _e("".concat(r.slice(0,3).join(", ")," and others"))}}var lt=function(e){if(!e)return!1;return/(http(s)?:\/\/.)(www.)?[-a-zA-Z0-9@:%._+~#=]{2,256}.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&\/\/=]*)/.test(e)},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.endsWith("Nanodegree")?e.replace("Nanodegree","").trim():e.endsWith("Nanodegree Program")?e.replace("Nanodegree Program","").trim():e.includes("Nanodegree by")?e.replace("Nanodegree by","by"):e};function mt(e){return(e.match(rt.PARSE_FORMAT)||[]).reduce(function(e,t){var n=t.split("[")[1].split("]")[0];return e.replace(t,n)},e)}function pt(e){for(var t=e,n=[];t.search(nt)>-1;){var a=t.search(nt);n.push(t.slice(a,a+at)),t=t.slice(0,a)+t.slice(a+at+1)}return Je()(n.concat(t.split("-")))}var ft=/\s+/,_t=n.n(et)()();var ht=["optimize your github profile","improve your linkedin profile"],vt=["nd050"],Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)+40;return e.slice(0,t)},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(le()(e))return"student";var n=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var i=o.value;if("bot"===i.type)return i.type;var c=i.payload.rooms;if(c&&c.includes(t))return i.type}}catch(u){a=!0,r=u}finally{try{n||null==s.return||s.return()}finally{if(a)throw r}}return"student"},bt=function(e){return e.filter(function(e){var t=e.title;return!ht.includes(t.toLowerCase())})},Ot=function(e){return e.filter(function(e){return!e.key.includes("beta")}).filter(function(e){var t=e.key;return!vt.includes(t)}).map(function(e){var t=re()(e,"projects.projects",[]);return Object(N.a)({},e,{title:dt(e.title),projects:Object(N.a)({completed_count:0},e.projects,{projects:bt(t)})})})},St=function(e,t){return e.filter(function(e){return e.is_graduated===t})},It=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t?e.filter(function(e){return re()(e,"id","")!==t}):e},yt=n(15),Tt=n(16),jt=n(60),At=n.n(jt),Rt={},Ct=Object(Tt.a)(function(e){return re()(e,"conversations.byId",Rt)},function(e){return e}),Nt=Object(Tt.a)(function(e){return re()(e,"messages.byId",Rt)},function(e){return e}),kt=Object(Tt.a)(function(e){return re()(e,"participants.byId",Rt)},function(e){return e}),Lt=Object(Tt.a)(function(e){return re()(e,"profiles.byId",Rt)},function(e){return e}),Pt=Object(Tt.a)(function(e){return re()(e,"rooms.byId",Rt)},function(e){return e}),wt=Object(Tt.a)(function(e){return re()(e,"threads.byId",Rt)},function(e){return e}),xt=function(e){return"pending"===e.status},Mt=function(e){return"fulfilled"===e.status},Dt=function(e){return!At()(e.error)&&!me()(e.error)},Ut=function(e){return Object(Tt.a)(function(t,n){if(n){var a=re()(t,[e,n]);if(me()(a))throw Error('Key "'.concat(n,'" not found on ').concat(e,"."));return a}return re()(t,e)},function(e){return e})},Ft=function(e){return e.session},Gt=Object(Tt.a)(Ft,function(e){return re()(e,"me")}),Bt=Object(Tt.a)(Ft,function(e){return re()(e,"status")}),Ht=Ut("sessionAsync"),Vt=Object(Tt.a)(Ft,function(e){return re()(e,"classroomMetadata")}),zt=Object(Tt.a)(Vt,function(e){return re()(e,"can_see_career_portal",!1)}),Wt=Object(Tt.a)(Ft,function(e){return re()(e,"showWelcomeFlow")}),Yt=Object(Tt.a)(Vt,function(e){return re()(e,"has_enterprise_enrollments",!1)}),qt=(Object(Tt.a)(function(e){return re()(e,"projects.pendingRating")},function(e){return e}),Object(Tt.a)(function(e,t){return re()(e,"projects.byRoomId[".concat(t,"]"))},function(e){return e})),Kt=Ut("projectsAsync"),Jt=Object(Tt.a)(function(e,t,n){var a=n||t;return re()(e,"projects.passedByRoomId[".concat(a,"]"))},function(e){return new Set(e)}),Xt=n(31),Qt=new Xt.c.Entity("profiles"),$t=function(e){return Object(Xt.b)(e,[Qt])},Zt=new Xt.c.Entity("participants",{profile:Qt},{processStrategy:function(e){var t=re()(e,"type","student");return Object(N.a)({},e,{type:t,profile:{id:e.id}})}}),en=new Xt.c.Object({active:[Zt],admins:[Zt],inactive:[Zt]}),tn=function(e){return Object(Xt.b)(e,en)},nn=(n(422),n(423)),an=n.n(nn),rn=function(e,t,n){var a,r=function(e){var t=e;e&&"first_name"in e&&(t=Object(N.a)({},e,{first:e.first_name,last:e.last_name}));return t}(e),o=re()(r,"id",re()(t,"id","")),s=re()(r,"passedProject",!1),i=re()(r,"first",re()(t,"first_name","")),c=re()(r,"last",re()(t,"last_name","")),u=i?it(i,c,!1):"",l=r&&r.photo_url?r.photo_url:void 0,d=re()(t,"show_location",!1),m=re()(t,"location.description",""),p="student",f={firstName:i,lastName:c,userId:o,role:p,photoUrl:l};return t&&(n&&(p=gt(t.roles,n),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!le()(e)){var n=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var i=o.value,c=re()(i,"payload.rooms")||[];if(c&&c.includes(t)&&i.payload.bio)return i.payload.bio}}catch(u){a=!0,r=u}finally{try{n||null==s.return||s.return()}finally{if(a)throw r}}}}(t.roles,n)),f=Object(N.a)({},f,{photoUrl:t.photo_url,role:p})),{avatarProps:f,bio:a,id:o,locationDescription:m,name:u,profile:t,role:p,showLocation:d,passedProject:s}},on=function(e){return"bot"!==e.type},sn=function(e){return an()(e,[function(e){return"mentor"===e.type?1:-1},function(e){return e.is_online?1:-1},function(e){var t=e.first;return(void 0===t?"":t).toLowerCase()},function(e){var t=e.last;return(void 0===t?"":t).toLowerCase()}],["desc","desc","asc","asc"])};function cn(e){return e.map(function(e){return e.id})}var un=Object(Tt.a)(function(e){return re()(e,"participantsAsync")},function(e){return re()(e,"searchParticipants")}),ln=function(e,t){return re()(e,["participants","byId",t])},dn=Object(Tt.a)(function(e,t){return re()(e,["participants","searchByRoomId",t],{})},function(e){return re()(e,["participants"],[])}),mn=function(e,t){return!!re()(e,["participants","onlineById",t])},pn={},fn=Object(Tt.a)(function(e){return re()(e,["participants","onlineById"])},function(e){return e||pn}),_n=function(e,t){if(t)return re()(e,["participants","byRoomId",t])},hn=Object(Tt.a)(kt,Lt,function(e,t){return{participants:e,profiles:t}}),vn=function(){return Object(Tt.a)(ln,hn,function(e,t){return function(e,t){return Object(Xt.a)(e,Zt,t)}(e,t)})},En=(vn(),Object(Tt.a)(Gt,function(e,t){return t},function(e,t){return function(e,t){var n=gt(e.roles,t);return"bot"===n||"staff"===n||"mentor"===n}(e,t)})),gn=Object(Tt.a)(Gt,function(e,t){return t},function(e,t){return function(e,t){return"staff"===gt(e.roles,t)}(e,t)}),bn=Object(Tt.a)(Gt,function(e){return function(e){return ve.includes(e.id)}(e)});function On(e,t){return re()(e,["participants","mentionableByRoomId",t],{})}Object(Tt.a)(On,En,bn,function(e,t,n){var a=t&&!n?[he]:[];return le()(e)||At()(e)?a:[].concat(a,Object(yt.a)(e.participants))});var Sn=Object(Tt.a)(On,Gt,function(e,t){return re()(e,"participants",[]).filter(function(e){var n=e.id;return!t||n!==t.id}).map(function(e){return{is_active:e.is_active||!1,photo_url:e.photo_url||"",type:e.type,display:e.first+e.last,id:e.id}})}),In=Object(Tt.a)(On,gn,bn,Gt,function(e,t,n,a){return[].concat(t&&!n?[he]:[],Object(yt.a)(re()(e,"participants",[]))).filter(function(e){var t=e.id;return!a||t!==a.id}).map(function(e){return{is_active:e.is_active||!1,photo_url:e.photo_url||"",type:e.type,display:e.first+e.last,id:e.id}})}),yn=Object(Tt.a)(_n,hn,function(e,t){if(e)return function(e){var t=e.active,n=void 0===t?[]:t,a=e.admins,r=void 0===a?[]:a,o=e.inactive,s=void 0===o?[]:o;return[].concat(Object(yt.a)(r.filter(on)),Object(yt.a)(n.map(function(e){return Object(N.a)({},e,{is_active:!0})})),Object(yt.a)(s.map(function(e){return Object(N.a)({},e,{is_active:!1})})))}(function(e,t){return Object(Xt.a)(e,en,t)}(e,t)||{})}),Tn=Object(Tt.a)(yn,Jt,fn,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=e;return a=function(e,t){return e.map(function(e){var n=!!t[e.id];return Object(N.a)({},e,{is_online:n})})}(a=function(e,t){return e.map(function(e){var n=t.has(e.id);return Object(N.a)({},e,{passedProject:n})})}(a,t),n),sn(a)}),jn=Object(Tt.a)(function(e,t){return Tn(e,t)},function(e,t,n){return n},function(e,t){if(!e)return[];var n=t||["mentor"],a=e.filter(function(e){return e.type&&n.includes(e.type)});return sn(a)}),An=Object(Tt.a)(function(e,t){return Tn(e,t)},function(e,t,n){return jn(e,t,n)},function(e,t){if(!e)return[];var n=new Set(t.map(function(e){return e.id})),a=e.filter(function(e){return e.id&&!n.has(e.id)});return sn(a)}),Rn=n(302),Cn=n.n(Rn),Nn=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.isOnline?"online":"offline";return r.a.createElement("span",{className:Ce()(Cn.a.circle,Cn.a[e])},_e("User is ".concat(e)))}}]),t}(r.a.PureComponent);Nn.defaultProps={isOnline:!1};var kn=Nn,Ln=n(424),Pn=n.n(Ln),wn=n(173),xn=n.n(wn);var Mn=xn()(function(e,t){return e?"data:image/png;base64,".concat(new Pn.a("".concat(function(e){if(e.toString().length>=15)return e;for(var t=e.toString();t.length<15;)t+=e;return t.slice(0,16)}(e)),t).toString()):""},function(e,t){return"".concat(e," ").concat(t)}),Dn=n(124),Un=n.n(Dn),Fn=n(425),Gn=n.n(Fn),Bn=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleProfileClick=function(e){var t=n.props,a=t.onProfileClick,r=t.userId;a&&(e.preventDefault(),a(r))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.firstName,a=t.lastName,o=t.onProfileClick,s=t.photoUrl,i=t.userId,c=t.role,u=t.size,l=t.sizeSelection,d=t.hasPreviewError,m=t.isOnline,p=t.isVisible,f=it(n,a,!1),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return"avatar-size--".concat(e)}(l),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"student";return"avatar-role--".concat(e)}(c),v=Ce()(Un.a.avatar,Un.a[_],Un.a[h],(e={},Object(ee.a)(e,Un.a.clickable,Ae()(o)),Object(ee.a)(e,Un.a.previewError,!!d),e)),E=f||"anonymous",g="url(".concat(Mn(i,u),")"),b=g;if(s){var O=s;if(!s.includes("data:image")){var S=s.substring(s.lastIndexOf("/")+1);O="".concat(k.REACT_APP_ROOT_PHOTO_URL).concat(S)}b="url(".concat(O,"), ").concat(g)}var I={backgroundImage:p?b:g};return r.a.createElement("div",{className:v,style:I,onClick:this.handleProfileClick,role:"img","aria-label":"".concat(E," profile image")},y()(m)&&r.a.createElement("span",{className:Un.a.onlineIndicator},r.a.createElement(kn,{isOnline:m})))}}]),t}(r.a.PureComponent);function Hn(e){return r.a.createElement(Gn.a,null,function(t){var n=t.isVisible;return r.a.createElement(Bn,Object.assign({isVisible:n},e))})}Bn.defaultProps={size:32};var Vn=Hn,zn=n(67),Wn=n.n(zn),Yn=n(153),qn=n.n(Yn),Kn=function(e){return Wn()(e.profiles.byId)},Jn=function(e,t){return re()(e,["profiles","byId",t])},Xn=function(e){return re()(e,["profiles","byId"])},Qn=[],$n=function(){return Object(Tt.a)(Jn,function(e){return e})},Zn=function(e,t){var n=re()(e,["profiles","byId"]);return t.map(function(e){return n[e]}).filter(function(e){return!!e})},ea=Ut("profilesAsync"),ta=function(e,t){var n=na(e,t);return re()(n,"knowledge.activity",{})},na=function(e,t){return re()(e,["profiles","additionalInfoById",t],{})},aa=Object(Tt.a)(na,function(e){var t=e.nanodegrees;if(!t)return 0;return qn()(Ot,function(e){return e.reduce(function(e,t){return e+(re()(t,"projects.completed_count")||0)},0)})(t)}),ra=Object(Tt.a)(na,function(e){var t=e.nanodegrees;if(t)return qn()(Ot,function(e){return St(e,!1)})(t)}),oa=Object(Tt.a)(na,function(e){var t=e.nanodegrees;if(t)return qn()(Ot,function(e){return St(e,!0)})(t)}),sa=Object(m.b)(function(){var e=vn(),t=$n(),n=Object(Tt.a)(mn,function(e){return e});return function(a,r){return{participant:e(a,r.userId),profile:t(a,r.userId),isOnline:n(a,r.userId)}}})(function(e){var t=rn(e.participant,e.profile,e.roomId).avatarProps;return r.a.createElement(Vn,Object.assign({},t,{isOnline:e.isOnline||!1}))}),ia=n(125),ca=n.n(ia),ua=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){switch(this.props.type){case"mentor":return r.a.createElement("span",{className:ca.a.mentor},r.a.createElement(Ne.w,{size:"sm",color:"cerulean"}),r.a.createElement("span",{className:ca.a.text},r.a.createElement(q.m,{size:"xs",spacing:"none"},_e("Mentor"))));case"staff":return r.a.createElement("span",{className:ca.a.staff},r.a.createElement(Ne.f,{size:"sm",color:"purple"}),r.a.createElement("span",{className:ca.a.text},r.a.createElement(q.m,{size:"xs",spacing:"none"},_e("Staff"))));case"mentee":return r.a.createElement("span",{className:ca.a.mentee},r.a.createElement(Ne.C,{size:"sm",color:"green"}),r.a.createElement("span",{className:ca.a.text},r.a.createElement(q.m,{size:"xs",spacing:"none"},_e("Mentee"))));default:return null}}}]),t}(r.a.PureComponent);ua.defaultProps={type:"student"};var la=ua,da=n(303),ma=n.n(da),pa=function(e){var t=e.conversation,n=t.id,a=t.profiles,o=t.meta,s=e.me,i=e.unreads,c=s.id,u=It(a,c),l=ut(u),d=re()(i,"unread_count")||0,m=u.length>0,p=re()(o,"scope_payload.mentor")===s.id,f=re()(o,"scope_payload.student")===s.id?void 0:e.onArchiveConversation;return r.a.createElement("li",{key:n},r.a.createElement(De,{content:r.a.createElement("span",{className:ma.a.conversation},m&&r.a.createElement(q.l,{type:"inline",size:"1x"},r.a.createElement(sa,{userId:u[0].id,roomId:n})),r.a.createElement(q.m,{size:"sm",spacing:"none"},l),p&&r.a.createElement(la,{type:"mentee"})),path:Oe(n),roomId:n,onArchiveClick:f,className:ma.a.conversationWrapper,hasUnreadMessages:!!d,mentionsCount:d}))},fa=function(e){var t=e.room,n=t.room_title,a=t.status,o=t.room_id,s=!!re()(e,"unreads.unread_count"),i=re()(e,"unreads.mentions_count")||0,c=dt(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return["Project: ","Project - "].reduce(function(e,t){return e.replace(t,"")},e)}(n));return r.a.createElement("li",{key:o},r.a.createElement(De,{content:r.a.createElement(q.m,{size:"sm",spacing:"none"},c),isLocked:"locked"===a,path:be(o),hasUnreadMessages:s,mentionsCount:i}))},_a=n(119),ha=n.n(_a),va=n(48),Ea=n.n(va),ga=function(e){var t=e.group,n=e.groups,a=re()(t,"meta.start_date"),o=re()(t,"title",""),s=ha()(n,{title:o}).length>1;return r.a.createElement("div",{className:Ea.a.programTitle},r.a.createElement(q.e,{size:"h6",as:"h4",spacing:"none"},dt(o)),s&&!!a&&r.a.createElement(q.m,{size:"sm",color:"silver"},"\xa0(",qe()(a,"MMM D, YYYY"),")"))},ba=n(29),Oa=n(63),Sa=n.n(Oa);function Ia(e,t){return function e(n,a){if(le()(n)||!n.offsetParent)return a;var r=n.offsetTop||0,o=n.offsetParent;return o===t?a+r:e(o,a+r)}(e,0)}function ya(e){if("text"!==e.type&&"textarea"!==e.type)return[0,0];var t=At()(e.selectionStart)?e.value.length:e.selectionStart;return[t,At()(e.selectionEnd)?t:e.selectionEnd]}var Ta,ja=function(e){var t=Object(a.useState)(!1),n=Object(ba.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(!1),i=Object(ba.a)(s,2),c=i[0],u=i[1];return{hasTopUnreads:r,hasBottomUnreads:c,handleLobbyListScroll:S()(function(){var t=function(){var t=e.current?e.current.querySelectorAll('[data-has-unreads="true"]'):[];return{firstUnread:t[0],lastUnread:Sa()(t)}}(),n=t.firstUnread,a=t.lastUnread;At()(e.current)||(o(function(e,t){if(!e||!t)return!1;var n=Ia(e,t),a=e.offsetHeight;return t.scrollTop>n+a}(n,e.current)),u(function(e,t){if(!e||!t)return!1;var n=Ia(e,t),a=t.scrollTop,r=t.offsetHeight;return n+e.offsetHeight>=a+r}(a,e.current)))},150)}},Aa=n(2),Ra=n.n(Aa),Ca=n(33),Na=n(426);!function(e){e.EnterLobby="Enter Workspace",e.LeaveLobby="Leave Workspace",e.EnterRoom="Enter Room",e.LeaveRoom="Leave Room",e.ViewProfile="View Profile",e.SendMessage="Send Message",e.CreateThread="Create Thread",e.DeleteMessage="Delete Message",e.DeleteMessageAction="Delete Message Action",e.CreateMessageAction="Create Message Action",e.DisplayCelebrationBanner="Display Celebration Banner",e.ViewMentorRatingsForm="View Mentor Ratings Form",e.SubmitMentorRatingsForm="Submit Mentor Ratings Form",e.EditMessage="Edit Message",e.ResendPendingMessage="Resend Pending Message",e.CancelPendingMessage="Cancel Pending Message",e.SendNotification="Send Notification",e.GrantNotificationPermission="Grant Notification Permission"}(Ta||(Ta={}));var ka=Object(Na.createAgent)(),La=k.REACT_APP_SEGMENT_WRITE_KEY;La&&ka.init(La,!0).catch(console.warn);var Pa=ka,wa=new(function(){function e(){var t=this;Object(i.a)(this,e),this.options={icon:"/udacity-logo.png"},this.audio=new Audio("/notification.wav"),this.push=function(e,n,a){t.create(e,Object(N.a)({},t.options,a||{},n?{body:n}:{}))},this.pushIfHidden=function(e,n,a){if(document.hidden)return t.push(e,n,a)},this.requestPermission=function(){var e=Object(Ca.a)(Ra.a.mark(function e(n){var a;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Notification.requestPermission();case 2:return"granted"===(a=e.sent)&&(Pa.track(Ta.GrantNotificationPermission),t.notify(n)),e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}return Object(c.a)(e,[{key:"notify",value:function(e,t){var n;try{n=new Notification(e,t)}catch(a){if("TypeError"===a.name)return console.warn("This browser requires a service worker to display notifications");throw a}return n.onclick=function(e){e.preventDefault();var t=window.open(k.REACT_APP_STUDENT_HUB_HOME||"","hub");t&&t.focus(),n.close()},this.audio.play(),Pa.track(Ta.SendNotification),n}},{key:"create",value:function(e,t){if(!("Notification"in window))return console.warn("This browser does not support desktop notification");var n=window.Notification;if("granted"===n.permission)return this.notify(e,t);"denied"!==n.permission&&this.requestPermission(e)}}]),e}()),xa=function(){return r.a.createElement(q.f,{size:"md",title:"speaker-off"},r.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",{id:"icon/speaker-off",stroke:"none",strokeWidth:"1",fill:"#B4B9BD",fillRule:"evenodd"},r.a.createElement("path",{d:"M14.86,10.617 L14.982307,10.624549 C15.305243,10.664541 15.597907,10.861269 15.751243,11.163021 L15.802,11.281 L15.8349523,11.3928943 C15.9394406,11.8425445 15.7196665,12.3093025 15.3047263,12.5135649 L15.197,12.559 L12,13.705 L12,17.246 L17.387,18.791 L17.4970864,18.8293557 C17.9231432,19.0061545 18.1735558,19.4560496 18.0978167,19.9120321 L18.072,20.026 L18.0334304,20.1364563 C17.8625316,20.5475254 17.4389523,20.7936698 17.0009562,20.7448256 L17,22.184 L16.9947205,22.3309232 C16.9177587,23.393674 16.0097622,24.1251454 14.954717,23.9846185 L14.81,23.96 L11.785,23.332 L11.6278414,23.2929545 C10.7520969,23.038864 10.0828493,22.2247423 10.0071446,21.3163205 L10,21.145 L9.99999995,19 L6.99999995,19 C6.48637864,19 6.06334975,18.6128207 6.00649477,18.1146431 L5.99999995,17.9978343 L6.01082867,12.9988343 C6.01193761,12.4867848 6.39775434,12.0653068 6.89437844,12.0077082 L7.01082632,12.001 L10.8239999,12.001 L14.524,10.676 C14.635,10.636 14.749,10.617 14.86,10.617 Z M17.002,7 L17.1213944,7.00745455 C17.4755725,7.05104132 17.7887333,7.28273554 17.9266882,7.62421488 L17.966,7.742 L21.966,22.742 L21.9894916,22.8566746 C22.0560645,23.3148918 21.7981651,23.7600419 21.3688196,23.9295244 L21.258,23.966 L21.1435102,23.9896764 C20.6859184,24.0568746 20.2400816,23.7982886 20.0704898,23.3688338 L20.034,23.258 L16.034,8.258 L16.0105084,8.14351057 C15.9383878,7.64779082 16.2470714,7.16592857 16.742,7.035 C16.829,7.012 16.916,7 17.002,7 Z M25.001,7 L25.1136738,7.0064621 C25.5964694,7.06201531 26,7.46985714 26,8.001 L26,8.001 L26,22 L25.9935166,22.115335 C25.9250484,22.719173 25.3253529,23.1341765 24.723,22.961 L24.723,22.961 L23.41,22.584 L23.2997289,22.5454308 C22.8374898,22.3529796 22.5829286,21.8401429 22.725,21.348 L22.725,21.348 L22.7635838,21.2375437 C22.9561582,20.7746224 23.4698571,20.5208571 23.962,20.662 L23.962,20.662 L24,20.673 L24,9.419 L20.863,10.541 L20.7509351,10.5739523 C20.2632551,10.687148 19.7577143,10.4197857 19.585,9.936 L19.585,9.936 L19.5518768,9.82373615 C19.4381173,9.3352602 19.7070714,8.82978571 20.189,8.658 L20.189,8.658 L24.663,7.059 C24.776,7.019 24.89,7 25.001,7 L25.001,7 Z M11.9999999,19.328 L12,21.145 L12.011984,21.19752 C12.0363808,21.257552 12.094201,21.325776 12.1495308,21.3576275 L12.19,21.374 L15,21.958 L14.9999999,20.187 L11.9999999,19.328 Z M9.99999995,14.001 L8.00866297,14.001 L8.00216804,17 L9.99999995,17 L9.99999995,14.001 Z",id:"Combined-Shape",fill:"#B4B9BD"}))))};var Ma=function(e){return r.a.createElement(q.a,{label:"Enable browser notifications",variant:"minimal",onClick:e.requestNotificationPermission,icon:r.a.createElement(xa,null),iconOnly:!0})};var Da=function(e){var t=function(t){e.onSetNotificationsEnabled(t),"denied"===e.permission&&"denied"===t&&e.onDenied()},n=function(){var e=Object(Ca.a)(Ra.a.mark(function e(){var n;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wa.requestPermission("Welcome to Student Hub notifications!");case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement(q.o,{content:"Enable browser notifications",trigger:r.a.createElement(Ma,{requestNotificationPermission:n}),direction:"bottom",inverse:!0})};var Ua=function(e){var t=e.onMute,n=e.onUnmute;return e.shouldNotify?r.a.createElement(q.a,{label:"Mute",variant:"minimal",onClick:t,icon:r.a.createElement(Ne.M,null),iconOnly:!0}):r.a.createElement(q.a,{lable:"Unmute",variant:"minimal",onClick:n,icon:r.a.createElement(xa,null),iconOnly:!0})};var Fa=function(e){var t=e.id,n=Ue.get("shouldNotify",t),o=!!me()(n)||n,s=Object(a.useState)(o),i=Object(ba.a)(s,2),c=i[0],u=i[1],l=c?"Mute browser notifications":"Unmute browser notifications";return r.a.createElement(q.o,{content:l,trigger:r.a.createElement(Ua,{onMute:function(){u(!1),Ue.set("shouldNotify",!1,t)},onUnmute:function(){u(!0),Ue.set("shouldNotify",!0,t)},shouldNotify:c}),direction:"bottom",inverse:!0})},Ga={getNotificationPermission:function(){return Notification.permission}},Ba={CLEAR_FIRST_ALERT:"ALERT/CLEAR_FIRST_ALERT",ADD_ALERT:"ALERT/ADD_ALERT"},Ha={clearFirstAlert:function(){return L(Ba.CLEAR_FIRST_ALERT,{})},addAlert:function(e,t){return L(Ba.ADD_ALERT,{type:e,message:t})}},Va={addAlert:Ha.addAlert};var za=Object(m.b)(void 0,Va)(function(e){var t=Object(a.useState)(Ga.getNotificationPermission()),n=Object(ba.a)(t,2),o=n[0],s=n[1];switch(o){case"denied":case"default":return r.a.createElement(Da,{permission:o,onSetNotificationsEnabled:function(e){return s(e)},onDenied:function(){return e.addAlert("error","It looks like you\u2019ve blocked Hub browser notifications. Please re-enable them in your browser's preferences.")}});case"granted":return r.a.createElement(Fa,{id:e.me.id})}return null}),Wa=n(111),Ya=(n(381),function(e){var t=e.lobby,n=e.hasEnterprise,o=Object(a.useRef)(null),s=ja(o),i=s.hasTopUnreads,c=s.hasBottomUnreads,u=s.handleLobbyListScroll;Object(a.useEffect)(function(){u()},[e.unreadsRooms,e.unreadsSummary,u]);var l=t.conversations.rooms||[],d=function(t){var n=t.style,a=t.index,o=t.key,s=l[a];return r.a.createElement("div",{key:o,style:n},r.a.createElement(pa,{key:s.id,conversation:s,me:e.me,unreads:e.unreadsRooms[s.id],onArchiveConversation:e.onArchiveConversation}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:Ea.a.nav},r.a.createElement("div",{className:Ea.a.navHeader},r.a.createElement("span",null,r.a.createElement(q.e,{color:"white",size:"h4",as:"h1",spacing:"half"},"Chat")),"Notification"in window&&r.a.createElement("span",{className:Ea.a.notificationContainer},r.a.createElement(za,{me:e.me}))),r.a.createElement("div",{className:Ea.a.roomList,onScroll:u,ref:o},e.hasThreads&&r.a.createElement("li",{key:"threads","data-tst":"allThreads"},r.a.createElement(De,{className:Ea.a.threads,content:r.a.createElement(q.m,{size:"sm"},"All Threads"),path:"/threads",hasUnreadMessages:e.unreadsSummary.has_unread_threads})),!!t.personal_mentor_conversations.length&&r.a.createElement(He,{className:Ea.a.groupingHeader,defaultToOpen:!0,accordionKey:"mentorDirectMessage","data-test":"communities",title:r.a.createElement(q.e,{size:"h6",as:"h3",spacing:"none",color:"white"},"Mentor",t.personal_mentor_conversations.length>1?"s":"")},r.a.createElement("div",{className:Ea.a.rooms},t.personal_mentor_conversations.map(function(t){return r.a.createElement(pa,{key:t.id,conversation:t,me:e.me,unreads:e.unreadsRooms[t.id],onArchiveConversation:e.onArchiveConversation})}))),!!t.community_groups.length&&r.a.createElement(He,{className:Ea.a.groupingHeader,defaultToOpen:!0,accordionKey:"communities","data-test":"communities",title:r.a.createElement(q.e,{size:"h6",as:"h3",spacing:"none",color:"white"},"Communities")},r.a.createElement("div",{className:Ea.a.rooms},t.community_groups[0].rooms.map(function(t){return r.a.createElement(fa,{key:t.room_id,room:t,unreads:e.unreadsRooms[t.room_id]})}))),t.mentored_groups.length>0&&r.a.createElement(He,{className:Ea.a.groupingHeader,defaultToOpen:!0,accordionKey:"projects","data-test":"guidedStudy",title:r.a.createElement(q.e,{size:"h6",as:"h3",spacing:"none","data-ref":"guidedStudyHeading",color:"white"},n?"Projects":"Peer Project Help")},t.mentored_groups.map(function(n,a){var o=re()(n,"title");return r.a.createElement(r.a.Fragment,{key:"".concat(o,"-").concat(a)},r.a.createElement("div",{className:Ea.a.rooms},r.a.createElement("div",{className:Ea.a.ndTitle},r.a.createElement(ga,{group:n,groups:t.mentored_groups})),n.rooms.map(function(t){return r.a.createElement(fa,{key:t.room_id,room:t,unreads:e.unreadsRooms[t.room_id]})})))})),e.totalConversations>0&&r.a.createElement(He,{className:Ea.a.groupingHeader,defaultToOpen:!0,accordionKey:"directMessages",title:r.a.createElement(q.e,{size:"h6",as:"h3",spacing:"none","data-ref":"directMessagesHeading",color:"white"},"Direct Messages")},r.a.createElement("div",{className:Ea.a.conversationsList},!!l.length&&r.a.createElement("div",{className:Ea.a.conversationsListInner},r.a.createElement(Wa.c,{scrollElement:null!==o.current?o.current:window},function(e){var t=e.height,n=e.scrollTop;return r.a.createElement(Wa.a,{disableHeight:!0},function(e){var a=e.width;return r.a.createElement(Wa.b,{autoHeight:!0,height:t,width:a,scrollTop:n,rowHeight:40,rowRenderer:d,rowCount:l.length,overscanRowCount:2})})})),r.a.createElement("div",{className:Ea.a.conversationsLink},r.a.createElement(p.b,{to:"/conversations"},r.a.createElement(q.e,{size:"h6",spacing:"none"},"View ",e.totalConversations>1?"all ":"",e.totalConversations," conversation",1===e.totalConversations?"":"s"),e.hasArchivedConversationUnreads&&r.a.createElement(Pe,null))))))),i&&r.a.createElement("div",{className:Ea.a.unreadsOverlayTop,"data-tst":"unreads-top"},r.a.createElement(We,{position:"top"})),c&&r.a.createElement("div",{className:Ea.a.unreadsOverlayBottom,"data-tst":"unreads-bottom"},r.a.createElement(We,{position:"bottom"})))}),qa=new Xt.c.Entity("rooms",{},{idAttribute:"room_id"}),Ka=function(e){return Object(Xt.b)(e,qa)},Ja=n(431),Xa=n(432),Qa=n.n(Xa),$a=new Xt.c.Entity("messages",{_participant:Zt,_profile:Qt},{idAttribute:"message_id",processStrategy:function(e){return Object(N.a)({},e,{_participant:{id:e.user_id},_profile:{id:e.user_id}})}}),Za=new Xt.c.Entity("messages",{},{idAttribute:"message_id"}),er=new Xt.c.Object({messages:[$a]}),tr=new Xt.c.Object({_participant:Zt,_profile:Qt}),nr=function(e){return Object(Xt.b)(e,er)},ar=function(e){return Object(Xt.b)(e,$a)},rr=function(e,t){return Object(Xt.a)(e,$a,t)},or=function(e,t){var n=t.has_next,a=t.next,r=t.total;return Object(N.a)({},e,{has_next:n,next:a,total:e.total+r})},sr=function(e){if(e.length){if(1===e.length)return e[0];var t=Object(Ja.a)(e),n=t[0];return t.slice(1).reduce(function(e,t){return Object(N.a)({},e,{entities:Object.keys(t.entities).reduce(function(e,n){return e[n]=Qa()(e[n],t.entities[n]),e},e.entities),result:{cursor:or(re()(n,"result.cursor",{}),re()(t,"result.cursor",{})),messages:[].concat(Object(yt.a)(e.result.messages),Object(yt.a)(t.result.messages)),room_id:n.result.room_id}})},n)}},ir=new Xt.c.Entity("conversations",{profiles:[Qt],summary:{last_message:Za}}),cr=new Xt.c.Object({rooms:[ir]}),ur=function(e){return Object(Xt.b)(e,ir)},lr=function(e){return Object(Xt.b)(e,cr)},dr=new Xt.c.Object({rooms:[qa]}),mr=new Xt.c.Object({rooms:[ir]}),pr=new Xt.c.Object({community_groups:[dr],mentored_groups:[dr],conversations:mr,personal_mentor_conversations:[ir]}),fr=function(e){return Object(Xt.b)(e,pr)},_r=function(e){return e.lobby.currentLobby},hr=function(e){return re()(e,"lobby.currentLobby.total_conversations")||0},vr=function(e){return re()(e,"lobby.currentLobby.total_threads")||0},Er=Object(Tt.a)(_r,function(e){return re()(e,"knowledge_profile.has_access",!1)}),gr=Object(Tt.a)(Pt,Ct,Lt,Nt,function(e,t,n,a){return{rooms:e,conversations:t,profiles:n,messages:a}}),br=Object(Tt.a)(_r,gr,function(e,t){if(e)return function(e,t){return Object(Xt.a)(e,pr,t)}(e,t)}),Or=Object(Tt.a)(br,function(e,t){return t},function(e,t){if(me()(e))return[];var n=[];return t&&t.includeConversations&&(n=(e.conversations.rooms||[]).reduce(function(e,t){return[].concat(Object(yt.a)(e),[t.id])},n)),n=(e.personal_mentor_conversations||[]).reduce(function(e,t){return[].concat(Object(yt.a)(e),[t.id])},n),[].concat(Object(yt.a)(e.community_groups),Object(yt.a)(e.mentored_groups)).reduce(function(e,t){var n=(re()(t,"rooms")||[]).filter(function(e){return"joined"===e.status}).map(function(e){return e.room_id});return[].concat(Object(yt.a)(e),Object(yt.a)(n))},n)}),Sr=Object(Tt.a)(_r,function(e,t){return t},function(e,t){if(!me()(e))return[].concat(Object(yt.a)(e.community_groups),Object(yt.a)(e.mentored_groups)).reduce(function(e,n){var a=n.rooms,r=n.title;return e||(a&&a.includes(t)&&r||void 0)},void 0)}),Ir=Object(Tt.a)(_r,function(e,t){return t},function(e,t){return(re()(e,"conversations.rooms")||[]).includes(t)}),yr=(Object(Tt.a)(_r,function(e,t){return t},function(e,t){return re()(e,"conversations.rooms",[]).find(function(e){return e.id===t})||void 0}),Object(Tt.a)(_r,function(e){return re()(e,"conversations.rooms",[])})),Tr=Object(Tt.a)(_r,function(e){var t=[].concat(Object(yt.a)(re()(e,"community_groups",[])),Object(yt.a)(re()(e,"mentored_groups",[]))).reduce(function(e,t){return[].concat(Object(yt.a)(e),Object(yt.a)(t.rooms))},[]),n=[].concat(Object(yt.a)(re()(e,"personal_mentor_conversations",[])),Object(yt.a)(t),Object(yt.a)(re()(e,"conversations.rooms",[])));return re()(n,"[0]")}),jr=(Ut("lobbyAsync"),function(e){return e.unreads}),Ar=Object(Tt.a)(jr,function(e){return e.summary}),Rr=Object(Tt.a)(jr,function(e){return e.rooms}),Cr=Object(Tt.a)(function(e,t){return re()(e,"unreads.rooms[".concat(t,"]"))},function(e){return e}),Nr=Object(Tt.a)(Ar,function(e){return!le()(e)&&!!(e.has_unread_threads||e.unread_mentions_count||e.unread_messages_count||e.unread_conversations_count)}),kr=Object(Tt.a)(Ar,function(e){return le()(e)?0:e.unread_conversations_count||0}),Lr=Object(Tt.a)(Ar,Rr,yr,function(e,t,n){return(e.unread_conversations_count||0)>n.reduce(function(e,n){var a=t[n];return a&&a.unread_count&&(e+=a.unread_count),e},0)}),Pr=Object(N.a)({},P("GET_CONVERSATION","CONVERSATIONS"),P("GET_CONVERSATIONS","CONVERSATIONS"),P("CREATE_STAGED_CONVERSATION","CONVERSATIONS"),P("CREATE_CONVERSATION_ROOM","CONVERSATIONS"),P("ARCHIVE_CONVERSATION","CONVERSATIONS"),P("UNARCHIVE_CONVERSATION","CONVERSATIONS"),P("CREATE_CONVERSATION_AND_SUBMIT","CONVERSATIONS"),{SET_CURRENT_CONVERSATION:"".concat("CONVERSATIONS","/SET_CURRENT_CONVERSATION"),SET_CONVERSATION_RECENCY:"".concat("CONVERSATIONS","/SET_CONVERSATION_RECENCY")}),wr={fetchConversationRoom:function(e,t,n){return L(Pr.GET_CONVERSATION_START,{conversationId:e,userIds:t,messageId:n})},resetFetchConversationRoom:function(){return L(Pr.GET_CONVERSATION_READY,void 0)},fetchConversations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;return L(Pr.GET_CONVERSATIONS_START,{page:e,count:t})},createStagedConversation:function(e){return L(Pr.CREATE_STAGED_CONVERSATION_START,{userIds:e})},resetCreateStagedConversation:function(){return L(Pr.CREATE_STAGED_CONVERSATION_READY,void 0)},setConversationRecency:function(e){return L(Pr.SET_CONVERSATION_RECENCY,{conversationId:e})},createConversationRoom:function(e,t,n){return L(Pr.CREATE_CONVERSATION_ROOM_START,{conversationId:t,userIds:e,roomId:n})},archiveConversation:function(e){return L(Pr.ARCHIVE_CONVERSATION_START,{roomId:e})},unarchiveConversation:function(e){return L(Pr.UNARCHIVE_CONVERSATION_START,{roomId:e})},resetCreateConversationRoom:function(){return L(Pr.CREATE_CONVERSATION_ROOM_READY,void 0)},createConversationAndSubmit:function(e,t,n){return L(Pr.CREATE_CONVERSATION_AND_SUBMIT_START,{userIds:e,message:t,roomId:n})}},xr=n(433),Mr=n.n(xr),Dr={archiveConversation:wr.archiveConversation},Ur=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).archiveConversation=function(e){n.props.archiveConversation(e)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.lobby,n=e.me,a=e.unreadsRooms,o=e.unreadsSummary,s=e.totalConversations,i=e.totalThreads,c=e.hasArchivedConversationUnreads,u=e.hasEnterprise;return r.a.createElement("aside",{className:Mr.a.sidebar},r.a.createElement(Ya,{lobby:t,hasThreads:i>0,totalConversations:s,me:n,unreadsRooms:a,unreadsSummary:o,onArchiveConversation:this.archiveConversation,hasArchivedConversationUnreads:c,hasEnterprise:u}))}}]),t}(r.a.PureComponent),Fr=Object(m.b)(function(e){return{lobby:br(e),totalThreads:vr(e),totalConversations:hr(e),unreadsRooms:Rr(e),unreadsSummary:Ar(e),hasArchivedConversationUnreads:Lr(e),me:Gt(e),hasEnterprise:Yt(e)}},Dr)(Ur),Gr={INIT_SOCKET:"".concat("SOCKETS","/INIT_SOCKET"),CLOSE_SOCKET:"".concat("SOCKETS","/CLOSE_SOCKET"),UPDATE_CONNECTION_STATUS:"".concat("SOCKETS","/UPDATE_CONNECTION_STATUS")},Br={initSocket:function(e){return L(Gr.INIT_SOCKET,{userId:e})},closeSocket:function(){return L(Gr.CLOSE_SOCKET,void 0)},connectionStatusChange:function(e){return L(Gr.UPDATE_CONNECTION_STATUS,{connected:e})}},Hr=Object(N.a)({},P("GET_PENDING_RATINGS","PROJECTS"),P("GET_ROOM_RATINGS","PROJECTS"),P("MUTATE_MENTOR_RATING","PROJECTS"),P("GET_PASSED_USERS","PROJECTS")),Vr={fetchPendingRatings:function(){return L(Hr.GET_PENDING_RATINGS_START,void 0)},fetchRoomRatings:function(e){return L(Hr.GET_ROOM_RATINGS_START,{roomId:e})},mutateMentorRating:function(e,t,n,a){return L(Hr.MUTATE_MENTOR_RATING_START,{mentorId:e,userId:t,roomId:n,rating:a})},resetMutateMentorRating:function(){return L(Hr.MUTATE_MENTOR_RATING_READY,void 0)},fetchPassedUsers:function(e,t){return L(Hr.GET_PASSED_USERS_START,{roomId:e,participantIds:t})}},zr=function(e,t){return re()(e,["rooms","byId",t])},Wr=Object(Tt.a)(Pt,function(e){return{rooms:e}}),Yr=Object(Tt.a)(zr,Wr,function(e,t){if(e)return function(e,t){return Object(Xt.a)(e,qa,t)}(e,t)}),qr=Object(Tt.a)(zr,function(e){return re()(e,"room_title")||""}),Kr=Object(Tt.a)(function(e,t){return re()(e,["rooms","metaByRoomId",t])},Wr,function(e,t){if(e)return e.project}),Jr=Ut("roomsAsync"),Xr=Object(N.a)({},P("GET_PROFILES","PROFILES"),P("GET_ROOMS_PROFILES","PROFILES"),P("GET_ADDITIONAL_INFO","PROFILES"),{RESOLVE_ADDITIONAL_PROFILES:"PROFILES/RESOLVE_ADDITIONAL_PROFILES"}),Qr={getProfiles:function(e,t){return L(Xr.GET_PROFILES_START,{roomId:e,userIds:t})},getRoomsProfiles:function(e){return L(Xr.GET_ROOMS_PROFILES_START,{threads:e})},resolveAdditionalProfiles:function(e,t){return L(Xr.RESOLVE_ADDITIONAL_PROFILES,{roomId:e,index:t})},getAdditionalProfileInfo:function(e){return L(Xr.GET_ADDITIONAL_INFO_START,{userId:e})}},$r=Object(N.a)({},P("GET_ROOM","ROOMS"),P("UPDATE_LAST_VISITED","ROOMS"),P("GET_ROOM_META","ROOMS"),{ENTER_ROOM:"".concat("ROOMS","/ENTER_ROOM"),LEAVE_ROOM:"".concat("ROOMS","/LEAVE_ROOM")}),Zr=function(e,t){return L($r.UPDATE_LAST_VISITED_START,{roomId:e,lastVisited:t})},eo={getRoom:function(e,t){return L($r.GET_ROOM_START,{roomId:e,messageId:t})},resetGetRoom:function(){return L($r.GET_ROOM_READY,void 0)},updateLastVisited:Zr,updateLastVisitedNow:function(e){return Zr(e,(new Date).toISOString())},getRoomMeta:function(e){return L($r.GET_ROOM_META_START,{roomId:e})}},to=Object(N.a)({},P("GET_MESSAGES","MESSAGES"),P("RECEIVE_MESSAGE","MESSAGES"),P("POST_MESSAGE","MESSAGES"),P("POST_IMAGE_MESSAGE","MESSAGES"),P("REPLY_TO_MESSAGE","MESSAGES"),P("GET_PREV_MESSAGES","MESSAGES"),P("GET_NEXT_MESSAGES","MESSAGES"),P("GET_PIVOT_MESSAGES","MESSAGES"),P("GET_LINKS_INFO","MESSAGES"),P("DELETE_MESSAGE","MESSAGES"),P("EDIT_MESSAGE","MESSAGES"),P("RECEIVE_MESSAGE_ACTION","MESSAGES"),P("CREATE_MESSAGE_ACTION","MESSAGES"),P("DELETE_MESSAGE_ACTION","MESSAGES"),P("GET_MESSAGES_BY_ACTION","MESSAGES"),P("RESEND_PENDING_MESSAGE","MESSAGES"),P("CANCEL_PENDING_MESSAGE","MESSAGES"),{REPLACE_PENDING_MESSAGE:"MESSAGES/REPLACE_PENDING_MESSAGE",MERGE_NEW_MESSAGE_BY_ID:"MESSAGES/MERGE_NEW_MESSAGE_BY_ID"}),no={getMessages:function(e){return L(to.GET_MESSAGES_START,{roomId:e})},resetGetMessages:function(e){return L(to.GET_MESSAGES_READY,{roomId:e})},getPrevMessages:function(e,t){return L(to.GET_PREV_MESSAGES_START,{roomId:e,prevMessageId:t})},getNextMessages:function(e,t){return L(to.GET_NEXT_MESSAGES_START,{roomId:e,nextMessageId:t})},getPivotMessages:function(e,t){return L(to.GET_PIVOT_MESSAGES_START,{roomId:e,nextMessageId:t})},receiveMessage:function(e,t,n,a){return L(to.RECEIVE_MESSAGE_START,{roomId:e,roomSerialId:t,message:n,parentRoomId:a})},receiveDeleteMessage:function(e,t){return L(to.DELETE_MESSAGE_FULFILLED,{message:{room_id:e,message_id:t}})},postMessage:function(e,t,n){return L(to.POST_MESSAGE_START,{roomId:t,message:e,messageId:n})},postImageMessage:function(e,t,n){return L(to.POST_IMAGE_MESSAGE_START,{file:e,roomId:t,messageId:n})},replyToMessage:function(e,t,n){return L(to.REPLY_TO_MESSAGE_START,{roomId:e,messageId:t,message:n})},getLinksInfo:function(e,t){return L(to.GET_LINKS_INFO_START,{messageId:e,content:t})},deleteMessage:function(e,t){return L(to.DELETE_MESSAGE_START,{messageId:e,roomId:t})},editMessage:function(e,t,n){return L(to.EDIT_MESSAGE_START,{roomId:e,messageId:t,message:n})},resendPendingMessage:function(e){return L(to.RESEND_PENDING_MESSAGE_START,{message:e})},cancelPendingMessage:function(e){return L(to.CANCEL_PENDING_MESSAGE_START,{message:e})},replacePendingMessage:function(e,t,n){return L(to.REPLACE_PENDING_MESSAGE,{roomId:e,pendingMessageId:t,messageId:n})},mergeNewMessageById:function(e){return L(to.MERGE_NEW_MESSAGE_BY_ID,Object(N.a)({},e))},getMessagesByAction:function(e,t){return L(to.GET_MESSAGES_BY_ACTION_START,{roomId:e,actionType:t})},createMessageAction:function(e){return L(to.CREATE_MESSAGE_ACTION_START,Object(N.a)({},e))},deleteMessageAction:function(e){return L(to.DELETE_MESSAGE_ACTION_START,{messageActionId:e})},receiveMessageAction:function(e,t){return L(to.RECEIVE_MESSAGE_ACTION_START,{roomId:e,messageAction:t})},receiveDeleteMessageAction:function(e){return L(to.DELETE_MESSAGE_ACTION_FULFILLED,e)}},ao=n(177),ro=n.n(ao),oo=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.participant,n=e.homeUrl,a=e.roomId,o=e.isOnline,s=rn(t,t.profile,a),i=s.role,c=s.name,u=s.id,l=s.profile,d=s.passedProject,m=o?"active":"inactive",f=Ce()(ro.a.participant,ro.a[m]);return r.a.createElement("div",{className:f,"data-has-profile":!!l},r.a.createElement(p.b,{to:"".concat(n,"?contextType=profile&profileId=").concat(u),className:ro.a.link},r.a.createElement(q.l,{type:"inline",size:"1x"},r.a.createElement(sa,{userId:u,roomId:a})),r.a.createElement(q.m,{size:"sm",spacing:"none"},c),r.a.createElement(la,{type:i}),r.a.createElement("span",{className:ro.a.right},d&&r.a.createElement(q.o,{content:"Has passed this project",direction:"bottom",trigger:r.a.createElement("div",null,r.a.createElement(Ne.p,{size:"sm",color:"teal",title:"Passed project checkmark"}))}))))}}]),t}(r.a.PureComponent),so=new Error("use-react-router may only be used with react-router@^5."),io=new Error("useReactRouter may only be called within a <Router /> context.");var co=function(){var e=Object(a.useContext)(E),t=e.isContextSidebarOpen,n=e.toggleContextSidebar,r=function(){if(!A.e)throw so;var e=Object(a.useContext)(A.e);if(!e)throw io;return e}(),o=r.history,s=r.location;return{openProfile:function(e){t||n(!0),o.push("".concat(s.pathname,"?contextType=profile&profileId=").concat(e))},isContextSidebarOpen:t,toggleContextSidebar:n}},uo=n(434),lo=n.n(uo);var mo=function(e){var t=e.color,n=co().toggleContextSidebar;return r.a.createElement("div",{className:lo.a.close},r.a.createElement(q.o,{content:"Close sidebar",direction:"bottom",trigger:r.a.createElement(q.a,{label:"Close",variant:"minimal",onClick:n,icon:r.a.createElement(Ne.r,{size:"sm",title:"close sidebar",color:t||"slate"}),iconOnly:!0})}))};var po=n(304),fo=n.n(po);var _o=function(e){var t=e.handleSearchClear,n=e.handleSearchInput,o=e.searchQuery;return Object(a.useEffect)(function(){return document.addEventListener("click",t,!1),function(){return document.removeEventListener("click",t,!1)}}),r.a.createElement("form",{className:fo.a.form,onSubmit:function(e){e.preventDefault()}},r.a.createElement("input",{className:fo.a.input,type:"text",value:o,onChange:n,placeholder:"Member name...",autoFocus:!0}),r.a.createElement("div",null,r.a.createElement(q.a,{onClick:t,variant:"minimal",label:"Close search input",icon:r.a.createElement(Ne.r,null),iconOnly:!0})))},ho=n(178),vo=n.n(ho);var Eo=function(e){var t=e.participants,n=void 0===t?[]:t,o=e.homeUrl,s=e.loading,i=e.roomId,c=e.handleParticipantSearch,u=e.searchQuery,l=e.showSidebarCloseOnParticipants,d=void 0!==l&&l,m=e.scrollElement,p=function(e){var t=Object(a.useState)(!1),n=Object(ba.a)(t,2),r=n[0],o=n[1];return{showSearchInput:r,handleSearchClose:function(){o(!1),e.handleClearSearch()},handleSearchOpen:function(){o(!0)}}}(e),f=p.showSearchInput,_=p.handleSearchClose,h=p.handleSearchOpen,v=d&&!f,E=function(e){var t=e.key,a=e.index,s=e.style,c=n[a],u=!!c.is_online;return r.a.createElement("div",{style:s,key:t},r.a.createElement(oo,{participant:c,key:c.id,homeUrl:o,roomId:i,isOnline:u}))};return r.a.createElement("div",{className:vo.a.sidebar},r.a.createElement("div",{className:vo.a.members},f&&r.a.createElement(_o,{searchQuery:u,handleSearchClear:_,handleSearchInput:c})||!s&&r.a.createElement("div",{"data-testid":"participant-heading",className:vo.a.participantHeader},r.a.createElement(q.a,{onClick:h,variant:"minimal",icon:r.a.createElement(Ne.K,null),label:"Channel Members"})),v&&r.a.createElement(mo,null)),!!n.length&&r.a.createElement("div",{className:vo.a.participants},r.a.createElement(Wa.c,{scrollElement:null!==m.current?m.current:window},function(e){var t=e.height,a=e.scrollTop;return r.a.createElement(Wa.a,{disableHeight:!0},function(e){var o=e.width;return r.a.createElement(Wa.b,{autoHeight:!0,height:t,width:o,scrollTop:a,rowHeight:40,rowRenderer:E,rowCount:n.length,overscanRowCount:2})})})))},go=Object(N.a)({},P("GET_PARTICIPANTS","PARTICIPANTS"),P("SEARCH_PARTICIPANTS","PARTICIPANTS"),P("SEARCH_PARTICIPANTS_TO_MENTION","PARTICIPANTS"),P("SET_PARTICIPANT_STATUS","PARTICIPANTS")),bo={getParticipants:function(e,t){return L(go.GET_PARTICIPANTS_START,{roomId:e,parentRoomId:t})},searchParticipants:function(e,t){return L(go.SEARCH_PARTICIPANTS_START,{roomId:e,search:t})},searchParticipantsToMention:function(e,t){return L(go.SEARCH_PARTICIPANTS_TO_MENTION_START,{roomId:e,search:t})},resetSearchParticipantsToMention:function(e){return L(go.SEARCH_PARTICIPANTS_TO_MENTION_READY,{roomId:e})},resetSearchParticipants:function(e){return L(go.SEARCH_PARTICIPANTS_READY,{roomId:e})},setParticipantStatus:function(e,t,n){return L(go.SET_PARTICIPANT_STATUS_START,{userId:e,roomId:t,isActive:n})}};var Oo={searchParticipants:bo.searchParticipants};var So=Object(m.b)(function(e,t){return{participantSearchResults:dn(e,t.roomId),participantSearchAsyncStatus:un(e)}},Oo)(function(e){var t=e.roomId,n=e.participants,o=e.homeUrl,s=e.loading,i=e.participantSearchResults,c=e.participantSearchAsyncStatus,u=e.showSidebarCloseOnParticipants,l=e.scrollElement,d=function(e){var t=e.searchParticipants,n=e.roomId,r=Object(a.useState)(""),o=Object(ba.a)(r,2),s=o[0],i=o[1];return{searchQuery:s,handleParticipantSearch:function(e){var a=e.target.value;i(a);var r=a.replace("@","");t(n,r)},handleClearSearch:function(){i("")}}}(e),m=d.searchQuery,p=d.handleParticipantSearch,f=d.handleClearSearch,_=m?i:n;return r.a.createElement(Eo,{roomId:t,handleParticipantSearch:p,handleClearSearch:f,participants:_,homeUrl:o,searchQuery:m,loading:s||xt(c),showSidebarCloseOnParticipants:u,scrollElement:l})}),Io=n(36),yo=n.n(Io),To=function(e){var t=yo()(e,function(e){return"false"===e.dataset.hasProfile});return t||void 0},jo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.scrollTop+t.offsetHeight+n>=e.offsetTop},Ao=n(75),Ro=n.n(Ao),Co=n(174),No=n.n(Co),ko=function(e){var t=Object(a.useRef)(void 0);return Object(a.useEffect)(function(){t.current=e}),t.current},Lo=n(113),Po=n.n(Lo),wo=n(175),xo=n.n(wo),Mo=n(305),Do=n.n(Mo),Uo=(n(690),n(691),n(692),n(693),n(694),n(695),n(696),n(697),n(698),n(699),n(700),n(701),n(702),n(703),n(704),n(705),n(706),n(707),n(708),n(709),function(e,t){return function(e){return"@"===e.charAt(0)}(e)&&!!e.slice(1)&&function(e){return rt.UID_FORMAT.test(e)}(t)}),Fo=function(e,t){var n=new Po.a.Renderer;n.link=function(e,n,a){if(Uo(a,e)){var r=Po.a.Renderer.prototype.link.call(this,"#",a,a);return function(e,t,n){var a=n.replace(rt.UID_PREFIX,"").toString();return(e||[]).includes(a)?t.replace(/^<a /,"<a data-id=".concat(a," data-tst='mention' class=").concat(xo.a.mention," ")):t}(t,r,e)}return Po.a.Renderer.prototype.link.call(this,e,e,a).replace(/^<a /,'<a target="_blank" rel="noopener" ')},n.heading=function(e,t,n,a){return Po.a.Renderer.prototype.heading.call(this,e,5,n,a)};var a=Object(N.a)({},Po.a.defaults,{highlight:function(e,t){try{return Do.a.highlight(e,Do.a.languages[t||"markup"],t)}catch(n){return e}},renderer:n,sanitize:!0,gfm:!0,breaks:!0}),r=new Po.a.Lexer(a),o=new Po.a.Parser(a),s=r.lex(e);return o.parse(s)},Go=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).nodeElementRef=void 0,n.getDOMAtMentions=function(){return n.nodeElementRef&&n.nodeElementRef.current?n.nodeElementRef.current.querySelectorAll("a[data-tst='mention']"):null},n.addProfileToDOMAtMentions=function(e){Array.from(e).forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),e&&e.dataset&&e.dataset.id&&e.dataset.id!==he.id&&n.props.onProfileClick(e.dataset.id)})})},n.nodeElementRef=r.a.createRef(),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.getDOMAtMentions();e&&this.addProfileToDOMAtMentions(e)}},{key:"render",value:function(){var e=this.props,t=e.content,n=e.mentions,a=e.isMe,o=le()(t)||At()(t)?"":t;if(!t)return null;var s=Fo(o,n),i=Ce()(xo.a.markdown,Object(ee.a)({},xo.a.me,a));return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:s},className:i,ref:this.nodeElementRef})}}]),t}(r.a.PureComponent);Go.defaultProps={isMe:!1,onProfileClick:h.a};var Bo=Go,Ho=n(435),Vo=n.n(Ho),zo=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.attachments,t=yo()(e,{label:"mobile"}),n=re()(t,"dimensions.width",512),a=yo()(e,{label:"desktop"}),o=re()(a,"dimensions.width",1024),s=yo()(e,{label:"original"}),i=re()(s,"dimensions.width",1500);if(!t||!a||!s)return null;var c="calc(100vw - ".concat(440,"px)"),u="calc(100vw - ".concat(818,"px)");return r.a.createElement("img",{className:Vo.a.responsiveImage,"data-testid":"responsive-image",srcSet:"".concat(t.url," ").concat(n,"w,\n                 ").concat(a.url," ").concat(o,"w,\n                 ").concat(s.url," ").concat(i,"w"),src:t.url,alt:"user generated content",sizes:"(min-width: ".concat(900,"px) ").concat(c,",\n                (min-width: ").concat(1100,"px) ").concat(u,",\n                calc(100vw - 60px)")})}}]),t}(a.PureComponent),Wo=n(114),Yo=n.n(Wo),qo=n(436),Ko=n.n(qo),Jo=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.attachments,t=yo()(e,{label:"original"});return t?r.a.createElement("a",{className:Ko.a.download,href:t.url,title:_e("Download or View Full Size"),target:"_blank",rel:"noopener noreferrer"},r.a.createElement(Ne.v,{size:"sm"})):null}}]),t}(a.PureComponent),Xo=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.author,a=e.authorProfile,o=e.timestamp,s=e.onProfileClick,i=e.mentions,c=e.roomId,u=e.attachments,l=rn(n,a,c),d=l.role,m=l.name,p=l.avatarProps,f=u&&u.length>0;return r.a.createElement("div",{className:Yo.a.message},r.a.createElement("div",{className:Yo.a.messageInner},r.a.createElement("div",{className:Yo.a.avatar},r.a.createElement(Vn,Object(N.a)({},p,{onProfileClick:s}))),r.a.createElement("div",{className:Yo.a.name},r.a.createElement(q.m,{size:"xs",spacing:"none"},m),r.a.createElement(la,{type:d}),r.a.createElement(q.m,{size:"xs",spacing:"none"},!!o&&r.a.createElement("time",{dateTime:o,title:String(new Date(o))},qe()(o,"h:mm A")))),r.a.createElement("div",{className:Yo.a.content},f&&r.a.createElement("div",{className:Yo.a.imageWrapper},r.a.createElement("div",{className:Yo.a.downloadButtonWrapper},r.a.createElement(Jo,{attachments:u})),r.a.createElement(zo,{attachments:u})),r.a.createElement(Bo,{content:t||"",mentions:i,isMe:!1,onProfileClick:s}))))}}]),t}(r.a.PureComponent),Qo=n(156),$o=n.n(Qo),Zo=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={isOpen:!0},n.closeBanner=function(){return n.setState({isOpen:!1})},n.jumpToRecent=function(){(0,n.props.onJumpToRecent)(),n.closeBanner()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state.isOpen,t=this.props,n=t.unreads,a=t.onJumpToRecent,o=re()(n,"unread_count",0)||re()(n,"count",0),s=Ce()($o.a.banner,Object(ee.a)({},$o.a.flexEnd,0===o)),i=_e("".concat(o," new ").concat(ct(o,"message")));return e?r.a.createElement("div",{className:$o.a.container},r.a.createElement("div",{className:s},!!o&&r.a.createElement("span",{className:$o.a.numMessages},r.a.createElement(q.m,{size:"sm",spacing:"none"},i)),r.a.createElement("span",{className:$o.a.buttons},r.a.createElement(q.a,{label:_e("JUMP TO RECENT"),variant:"minimal",onClick:a,testID:"jumpToRecent",small:!0}),r.a.createElement(q.a,{label:_e("close"),variant:"minimal",onClick:this.closeBanner,icon:r.a.createElement(Ne.r,{size:"sm",color:"blue"}),iconOnly:!0,testID:"newMessagesBannerClose"})))):null}}]),t}(r.a.PureComponent),es=r.a.createContext({});var ts=function(e){var t=e.children,n=e.userId,a=co().openProfile;return r.a.createElement(q.g,{href:"#",onClick:function(){a(n)}},t)},ns=n(89),as=n(306),rs=n.n(as),os=n(126),ss=n.n(os);rs.a.setAppElement("body");var is=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).refClose=Object(a.createRef)(),n.refCloseBottom=Object(a.createRef)(),n.handleClose=function(e){var t=n.props.onRequestClose;e.preventDefault(),t(e)},n.handleCloseBottom=function(e){e.preventDefault(),n.closeBottomFocus()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"closeFocus",value:function(){var e=this.refClose.current;e&&e.focus()}},{key:"closeBottomFocus",value:function(){var e=this.refCloseBottom.current;e&&e.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.fullScreen,a=e.overlayClassName,o=e.isCloseVisible,s=e.children,i=Object(ns.a)(e,["className","fullScreen","overlayClassName","isCloseVisible","children"]),c=Ce()(ss.a.close,ss.a.unstyledButton),u="".concat(ss.a[n?"fullscreen":"content"]," ").concat(t);return r.a.createElement(rs.a,Object.assign({className:u,overlayClassName:"".concat(ss.a.overlay," ").concat(a)},i),o?r.a.createElement("button",{className:c,onClick:this.handleClose,title:_e("Close Modal"),ref:this.refClose},r.a.createElement(Ne.r,{size:"md",color:"white",title:_e("Close Modal")})):null,r.a.createElement("div",null,s),o?r.a.createElement("button",{className:Ce()(ss.a.closeBottom,ss.a.unstyledButton),onFocus:this.handleCloseBottom,onClick:this.handleClose,ref:this.refCloseBottom},_e("Close Modal")):null)}}]),t}(r.a.Component);is.displayName="ureact-modal",is.defaultProps={isCloseVisible:!0,contentLabel:"Modal",fullScreen:!1};var cs=is,us=n(231),ls=n.n(us),ds=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:ls.a.warningHeader},r.a.createElement(Ne.Q,{size:"md",color:"red",title:_e("Delete Message")}),r.a.createElement(q.e,{size:"h3"},_e("Delete Message"))),r.a.createElement("div",{className:ls.a.modalContent},r.a.createElement(q.m,null,_e("This message will be permanently removed. Would you like to continue?")),r.a.createElement("div",{className:ls.a.actionButtons},r.a.createElement(q.a,{label:_e("Yes, delete"),variant:"destructive",onClick:this.props.confirmDeleteMessage}),r.a.createElement(q.a,{label:_e("Nevermind"),variant:"minimal",onClick:this.props.closeModal}))))}}]),t}(r.a.PureComponent),ms=n(127),ps=n.n(ms),fs=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.question,n=e.href,a=t.title,o=t.answers,s=function(e){var t=!!e&&e.length;return 1===t?"1 ".concat(_e("answer")):"".concat(t," ").concat(_e("answers"))}(o),i=function(e){var t=r.a.createElement(Ne.m,{size:"sm",title:"{__('knowledge answers')}",color:"slate"});if(!e)return t;var n=!!e&&e.some(function(e){return!!e.accepted});return e&&e.some(function(e){return!!e.verified})?t=r.a.createElement(Ne.g,{size:"sm",title:"{__('knowledge answers')}",color:"purple"}):n&&(t=r.a.createElement(Ne.o,{size:"sm",title:"{__('knowledge answers')}",color:"green"})),t}(o);return r.a.createElement("li",{className:ps.a.link},r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n},r.a.createElement("div",{className:ps.a.title},r.a.createElement(q.m,{size:"xs",color:"white"},_e("Knowledge Post"))),r.a.createElement("div",{className:ps.a.body},r.a.createElement(q.e,{size:"h5",spacing:"none"},a),r.a.createElement("div",{className:ps.a.answers},r.a.createElement("span",{className:ps.a.icon},i),r.a.createElement("span",{className:ps.a.text},r.a.createElement(q.e,{size:"h6",spacing:"none"},s))))))}}]),t}(r.a.PureComponent),_s=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.link,n=e.isMe,a=t.metadata;switch(t.type){case"knowledge":return!!a&&r.a.createElement(fs,{question:a,href:t.url,isMe:n});default:return null}}}]),t}(r.a.PureComponent),hs=n(437),vs=n.n(hs),Es=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.links,n=e.isMe;return t&&t.length?r.a.createElement("ul",{className:vs.a.links},t.map(function(e){var t=re()(e,["metadata","id"]);return r.a.createElement(_s,{key:t,link:e,isMe:n})})):null}}]),t}(r.a.PureComponent),gs=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.onCallback,a=e.icon;return r.a.createElement("li",null,r.a.createElement("button",{onMouseDown:n,title:_e(t)},a,r.a.createElement(q.e,{size:"h6",spacing:"none",color:"slate"},_e(t))))}}]),t}(r.a.PureComponent),bs=n(101),Os=(n(391),function(e){var t=e.color,n=void 0===t?"white":t,a=e.size,o=void 0===a?"md":a;return r.a.createElement(q.f,{size:o,color:n,title:"AddEmoji"},r.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",{id:"icon/emoji-add",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},r.a.createElement("path",{d:"M16,6 C16.2962004,6 16.5909642,6.01290548 16.8837119,6.03857238 C17.4338861,6.08680937 17.8407866,6.57191748 17.7925496,7.12209167 C17.7443126,7.67226586 17.2592045,8.07916635 16.7090303,8.03092937 C16.4743517,8.01035371 16.2378706,8 16,8 C11.581722,8 8,11.581722 8,16 C8,20.418278 11.581722,24 16,24 C20.418278,24 24,20.418278 24,16 C24,14.8267496 23.7479099,13.6910876 23.2674884,12.6506178 C23.0359677,12.1492032 23.2547599,11.5550417 23.7561745,11.323521 C24.2575891,11.0920003 24.8517506,11.3107925 25.0832713,11.8122071 C25.6844478,13.1142014 26,14.5357591 26,16 C26,21.5228475 21.5228475,26 16,26 C10.4771525,26 6,21.5228475 6,16 C6,10.4771525 10.4771525,6 16,6 Z M19.2313724,17.3380041 C19.5846647,16.9398064 20.2151926,16.8856558 20.6396958,17.2170552 C21.0641991,17.5484547 21.121927,18.13991 20.7686347,18.5381077 C17.8622842,21.8138713 14.4921386,21.8138713 11.2693309,18.5784765 C10.8922707,18.1999437 10.9137363,17.606356 11.3172757,17.2526615 C11.7208151,16.8989669 12.3536161,16.9191024 12.7306763,17.2976352 C15.1495373,19.7259434 17.1127249,19.7259434 19.2313724,17.3380041 Z M13,13 C13.5522847,13 14,13.4477153 14,14 C14,14.5522847 13.5522847,15 13,15 C12.4477153,15 12,14.5522847 12,14 C12,13.4477153 12.4477153,13 13,13 Z M19,13 C19.5522847,13 20,13.4477153 20,14 C20,14.5522847 19.5522847,15 19,15 C18.4477153,15 18,14.5522847 18,14 C18,13.4477153 18.4477153,13 19,13 Z M21,6 C21.5128358,6 21.9355072,6.38604019 21.9932723,6.88337887 L22,7 L22,8 L23,8 C23.5128358,8 23.9355072,8.38604019 23.9932723,8.88337887 L24,9 C24,9.51283584 23.6139598,9.93550716 23.1166211,9.99327227 L23,10 L22,10 L22,11 C22,11.5128358 21.6139598,11.9355072 21.1166211,11.9932723 L21,12 C20.4871642,12 20.0644928,11.6139598 20.0067277,11.1166211 L20,11 L20,10 L19,10 C18.4871642,10 18.0644928,9.61395981 18.0067277,9.11662113 L18,9 C18,8.48716416 18.3860402,8.06449284 18.8833789,8.00672773 L19,8 L20,8 L20,7 C20,6.52661307 20.3289337,6.13005271 20.7707092,6.02641071 L20.8833789,6.00672773 L21,6 Z",id:"Combined-Shape"}))))}),Ss=n(438),Is=n.n(Ss),ys=n(68),Ts=n.n(ys),js=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={isExpanded:!1,showEmojiPicker:!1},n.node=void 0,n.assignNode=function(e){return n.node=e},n.handleClick=function(e){n.node&&n.node.contains(e.target)||n.setState({isExpanded:!1})},n.toggleExpanded=function(){n.setState(function(e){return{isExpanded:!e.isExpanded}})},n.handleCreateMessageActionClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.props,r=a.me,o=a.message;(0,a.onCreateMessageActionClick)({user_id:r.id,message_id:o.message_id,type:e,room_serial_id:o.room_serial_id,metadata:Object(N.a)({},t,{first_name:r.first_name,last_name:r.last_name})})},n.clickEmojiAdd=function(e){e.preventDefault(),n.setState({showEmojiPicker:!0})},n.handleCloseEmojiPicker=function(e){n.setState({showEmojiPicker:!1})},n.handleSelectEmoji=function(e){var t=n.props,a=t.me,r=t.message.message_actions,o=(void 0===r?[]:r).find(function(t){return t.user_id===a.id&&"REACTION"===t.type&&t.metadata&&t.metadata.id===e.id});o?n.props.onDeleteMessageActionClick(o.id):n.handleCreateMessageActionClick("REACTION",e),n.setState({showEmojiPicker:!1})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("click",this.handleClick,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.me,a=t.rootUrl,o=t.threadUrl,s=t.message,i=t.isThread,c=t.ownMessage,u=t.onDeleteMessageClick,l=t.onDeleteMessageActionClick,d=t.onSetToEdit,m=t.enableThreads,f=t.attachments,_=t.role,h=this.state.isExpanded,v=i?"Reply to thread":"Start a thread",E=yo()(f,{label:"original"}),g=this.context.shouldShowAbove&&this.context.shouldShowAbove(s.message_id),b=Ce()(Ts.a.moreOptions,Object(ee.a)({},Ts.a.above,g)),O="staff"===_,S=s.message_actions,I=void 0===S?[]:S,y=I.find(function(e){return"STAR"===e.type&&n.id===e.user_id}),T=y?"Unstar message":"Star message",j=I.find(function(e){return"PIN"===e.type}),A=j?"Unpin message":"Pin message",R=!j||j.user_id===n.id;R||(A="Pinned by other user");var C=window.location.href.split("?")[0],N="".concat(C,"?messageId=").concat(s.message_id),L=ge(s.room_id),P=!i&&!L,w="staff"===gt(n.roles,s.room_id)&&!i&&!L&&r.a.createElement("li",{className:Ts.a.menuItem},r.a.createElement(q.o,{content:A,direction:"top",trigger:r.a.createElement("button",{onClick:function(){return j?l(j.id):e.handleCreateMessageActionClick("PIN")},disabled:!R},r.a.createElement(Ne.G,{size:"sm",color:j?"yellow":"silver",title:_e(A)}))})),x=P&&r.a.createElement("li",{className:Ts.a.menuItem},r.a.createElement(q.o,{content:T,direction:"top",trigger:r.a.createElement("button",{onClick:function(){return y?l(y.id):e.handleCreateMessageActionClick("STAR")}},r.a.createElement(Ne.N,{size:"sm",color:y?"orange":"silver",title:_e(T)}))}));return"/"===a?r.a.createElement("div",{ref:this.assignNode},r.a.createElement("ul",{className:Ts.a.messageMenu},r.a.createElement("li",{className:Ts.a.menuItem},r.a.createElement(q.o,{content:"Jump",direction:"top",trigger:r.a.createElement("button",{onClick:function(){return window.open(N,"_blank")}},r.a.createElement(Ne.z,{size:"sm",color:"slate",title:_e("Jump")}))})),y&&x,j&&w)):r.a.createElement("div",{ref:this.assignNode},r.a.createElement("ul",{className:Ts.a.messageMenu},!i&&r.a.createElement(q.o,{content:"Add reaction",direction:"top",trigger:r.a.createElement("li",{className:Ts.a.menuItem},r.a.createElement(q.i,{open:this.state.showEmojiPicker,onClose:this.handleCloseEmojiPicker,trigger:r.a.createElement("button",{id:"reaction-picker",onClick:function(t){e.clickEmojiAdd(t)}},r.a.createElement(Os,{color:"silver",size:"sm"}))},r.a.createElement("div",{className:Ts.a.reactionEmojiPicker,onMouseDown:function(e){return e.preventDefault()}},r.a.createElement(bs.b,{native:!0,onSelect:function(t){e.handleSelectEmoji(t);var n=document.activeElement;n&&n.blur()},sheetSize:32,showPreview:!1,showSkinTones:!1}))))}),!!E&&r.a.createElement("li",{"data-ref":"expand-btn",className:Ts.a.menuItem},r.a.createElement(q.o,{content:_e("Download or View Full Size"),direction:"top",trigger:r.a.createElement("a",{href:E.url,title:_e("Download or View Full Size"),target:"_blank",rel:"noopener noreferrer"},r.a.createElement(Ne.v,{size:"sm",color:"silver",title:"Reply"}))})),m&&r.a.createElement("li",{"data-ref":"reply-btn",className:Ts.a.menuItem},r.a.createElement(q.o,{content:v,direction:"top",trigger:r.a.createElement(p.b,{to:o,title:_e(v)},r.a.createElement(Ne.n,{size:"sm",color:"silver",title:"Reply"}))})),x,w,r.a.createElement("li",{className:Ts.a.menuItem},r.a.createElement(q.o,{content:"More options",direction:"top",trigger:r.a.createElement("button",{onClick:this.toggleExpanded},r.a.createElement(Ne.E,{size:"sm",color:"silver",title:_e("More Options")}))}))),h&&r.a.createElement("div",{className:b},r.a.createElement("ul",{className:Ts.a.moreOptionsList},c&&r.a.createElement(gs,{title:"Edit",onCallback:d,icon:r.a.createElement(Ne.u,{size:"sm",color:"cerulean",title:_e("Edit Message")})}),(O||c)&&r.a.createElement(gs,{title:"Delete",onCallback:u,icon:r.a.createElement(Ne.O,{size:"sm",color:"red",title:_e("Delete Message")})}),r.a.createElement(Is.a,{component:"a","data-clipboard-text":"".concat(k.REACT_APP_STUDENT_HUB_HOME).concat(a,"?messageId=").concat(s.message_id)},r.a.createElement(gs,{title:"Copy Link",onCallback:function(e){return e.preventDefault()},icon:r.a.createElement(Ne.z,{size:"sm",color:"cerulean",title:_e("Copy Link")})})))))}}]),t}(r.a.PureComponent);js.contextType=es,js.defaultProps={enableThreads:!0};var As=js,Rs={onDeleteMessageActionClick:no.deleteMessageAction,onCreateMessageActionClick:no.createMessageAction},Cs=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(As,this.props)}}]),t}(r.a.PureComponent),Ns=Object(m.b)(function(e){return{me:Gt(e)}},Rs)(Cs),ks=n(439),Ls=n.n(ks),Ps=n(307),ws=n.n(Ps);var xs=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.profileList,n=e.me,a=e.parentRoomId,o=e.sizeSelection,s=function(e,t){var n=e.find(function(e){return(e&&e.id)===t.id}),a=n?[n]:[];return Ls()(e,function(e,n){var a=n&&n.id;return e.length<4&&a!==t.id?[].concat(Object(yt.a)(e),[n]):e},a)}(t,n);return r.a.createElement("ul",{className:ws.a.avatarGrouping},s.map(function(e){if(!e)return null;var t=rn(void 0,e,a),n=t.avatarProps,s=t.id;return r.a.createElement("li",{key:s,className:ws.a.avatarItem},r.a.createElement(Vn,Object.assign({},n,{size:24,sizeSelection:o})))}))}}]),t}(r.a.PureComponent);xs.defaultProps={sizeSelection:"sm"};var Ms=xs,Ds=n(440),Us=n.n(Ds),Fs=n(179),Gs=n.n(Fs),Bs=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.profileList,n=e.replyCount,a=e.mostRecentTimestamp,o=e.threadUrl,s=e.me,i=e.showNotificationsBadge,c=e.mentionsCount,u=e.parentRoomId;return r.a.createElement("div",{className:Gs.a.threadLink},r.a.createElement(p.b,{to:o},i&&r.a.createElement("span",{className:Gs.a.badge},r.a.createElement(Pe,{mentionsCount:c})),r.a.createElement(Ms,{profileList:t,me:s,parentRoomId:u}),r.a.createElement(q.m,{size:"xs"},r.a.createElement("span",{className:Gs.a.link},"".concat(n," ").concat(n>1?"Replies":"Reply")),r.a.createElement("span",{className:Gs.a.timestamp},"  ","Latest reply"," ",r.a.createElement("time",null,Us()(a,Date.now()))," ","ago"))))}}]),t}(r.a.PureComponent),Hs=n(76),Vs=n.n(Hs),zs=new Xt.c.Entity("threads",{_threadAuthorParticipant:Zt,_threadAuthorProfile:Qt,_threadParticipants:[Zt]},{idAttribute:"thread_id",processStrategy:function(e){var t=re()(e,"topic.thread.participants",[]),n=re()(e,"topic.user_id",void 0);return Object(N.a)({},e,{_threadAuthorParticipant:{id:n},_threadAuthorProfile:{id:n},_threadParticipants:t})}}),Ws={threads:[zs]},Ys=function(e){return Object(Xt.b)(e,zs)},qs=function(e){var t=e.notifications,n=void 0===t?{}:t,a=e.unread_mentions,r=void 0===a?{}:a,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.map(function(e){var a=t[e.thread_id]||{},r=n[e.thread_id]||[],o={unread_count:a.count||0,mentions_count:r.length,last_visited:a.last_visited,oldest_message_id:a.oldest||null,mentions:r.map(function(e){return e.message_id})};return Object(N.a)({},e,o.unread_count>0?{unreads:o}:{})})}(e.threads,n,r);return Object(Xt.b)(Object(N.a)({},Vs()(Object(N.a)({},e),["notifications","unread_mentions"]),{threads:o}),Ws)},Ks=function(e,t){return re()(e,["threads","byId",t],void 0)},Js=Object(Tt.a)(wt,kt,Lt,function(e,t,n){return{threads:e,participants:t,profiles:n}}),Xs=Object(Tt.a)(function(e){return re()(e,["threads","currentThreads"])},Js,function(e,t){if(e)return function(e,t){return Object(Xt.a)(e,Ws,t)}(e,t)}),Qs=Object(Tt.a)(function(e){return re()(e,"threads.stagedThread",void 0)},function(e){return e}),$s=function(){return Object(Tt.a)(Ks,Js,function(e,t){if(e)return function(e,t){return Object(Xt.a)(e,zs,t)}(e,t)})},Zs=$s(),ei=Ut("threadsAsync"),ti=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.thread,n=e.profileList,a=e.threadUrl,o=e.me,s=e.threadRoom,i=e.unreads,c=t.last_message_at,u=t.message_count,l=!!i&&!!i.unread_count,d=i?i.mentions_count:0,m=re()(s,"topic.room_id","");return r.a.createElement(Bs,{replyCount:u,profileList:n,mostRecentTimestamp:c,threadUrl:a,me:o,showNotificationsBadge:l,mentionsCount:d,parentRoomId:m})}}]),t}(r.a.Component),ni=Object(m.b)(function(){var e=Object(Tt.a)(function(e,t){return t||Qn},Xn,function(e,t){return e.map(function(e){return t[e]})}),t=$s();return function(n,a){var r=a.thread,o=a.profiles;return{threadRoom:t(n,r.thread_id),profileList:e(n,o),me:Gt(n),unreads:Cr(n,r.thread_id)}}})(ti),ai=n(224),ri=n(297),oi=n.n(ri),si=n(441),ii=n.n(si);function ci(e,t){return"pending:".concat(Object(ai.sha256)(e+t))}var ui=function(e,t){var n=e.content,a=void 0===n?"":n,r=t.content;return a===(void 0===r?"":r)},li=function(e){return e.reduce(function(e,t){if(me()(t))return e;if(!e.length)return[[[t]]];var n=Sa()(Sa()(Sa()(e)));if(!ii()(n.created_at,t.created_at))return function(e,t){return[].concat(Object(yt.a)(e),[[[t]]])}(e,t);var a=n.user_id===t.user_id,r=oi()(t.created_at,n.created_at);return a&&r<12e4?function(e,t){var n=Sa()(e),a=Sa()(Sa()(e));return[].concat(Object(yt.a)(e.slice(0,e.length-1)),[[].concat(Object(yt.a)(n.slice(0,n.length-1)),[[].concat(Object(yt.a)(a),[t])])])}(e,t):function(e,t){var n=Sa()(e);return[].concat(Object(yt.a)(e.slice(0,e.length-1)),[[].concat(Object(yt.a)(n),[[t]])])}(e,t)},[])};function di(e,t){var n=["@channel",t],a=e.mentions;return a&&a.reduce(function(e,t){return!(!e&&!n.includes(t))},!1)}var mi=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){var n=re()(t,"thread.thread_id");return n&&e.push(n),e},[])},pi=function(e,t){return re()(e,["messages","byId",t])},fi=function(e,t,n){return re()(e,["messages","byActionType",t,n])},_i=function(e){return re()(e,["messages","pendingById"])},hi=Object(Tt.a)(Nt,kt,Lt,function(e,t,n){return{messages:e,participants:t,profiles:n}}),vi=Object(Tt.a)(function(e,t){return re()(e,["messages","byRoomId",t])},_i,hi,function(e,t,n){if(e&&e.messages)return Object(N.a)({},e,{messages:e.messages.map(function(e){if(function(e){return fe()(String(e),"pending:")}(e))return function(e,t){return Object(Xt.a)(e,tr,t)}(t[e],n);var a=re()(n,["messages",e]);return rr(a,n)})})}),Ei=Object(Tt.a)(vi,function(e){if(e){var t=li(e.messages);return Object(N.a)({},e,{groupedMessages:t})}}),gi=Object(Tt.a)(function(e,t){return re()(e,["messages","pendingById",t])||void 0},function(e){return e}),bi=Object(Tt.a)(_i,function(e){return e||{}}),Oi=Object(Tt.a)(pi,hi,function(e,t){if(e)return rr(e,t)}),Si=Ut("messagesAsync"),Ii=n(180),yi=n.n(Ii),Ti=function(e){var t=e.emoji,n=e.users,a=e.handleClick;return r.a.createElement(q.o,{content:r.a.createElement("span",null,n.join(", "),r.a.createElement("mark",{className:yi.a.tooltipMark}," ","reacted with ".concat(t.colons))),trigger:r.a.createElement("div",{className:yi.a.emojiButton,onClick:a},r.a.createElement("div",{className:yi.a.emoji,dangerouslySetInnerHTML:{__html:Object(bs.a)({html:!0,emoji:t,size:18})}}),r.a.createElement("div",{className:yi.a.emojiCount},n.length))})},ji={deleteMessageAction:no.deleteMessageAction,createMessageAction:no.createMessageAction},Ai=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){var e=n.props,t=e.emoji,a=e.me,r=e.message,o=e.createMessageAction,s=e.createMessageActionStatus,i=e.deleteMessageAction,c=e.deleteMessageActionStatus,u=e.reactions;if(!xt(s)&&!xt(c)){var l=u.find(function(e){return e.user_id===a.id});if(l)i(l.id);else o({user_id:a.id,message_id:r.message_id,type:"REACTION",room_serial_id:r.room_serial_id,metadata:Object(N.a)({},t,{first_name:a.first_name,last_name:a.last_name})})}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.emoji,n=e.reactionUsers;return r.a.createElement(Ti,{emoji:t,users:n,handleClick:this.handleClick})}}]),t}(r.a.Component),Ri=Object(m.b)(function(e,t){var n=t.reactions;return{reactionUsers:(void 0===n?[]:n).map(function(t){var n=ln(e,t.user_id);return t.metadata&&t.metadata.first_name||n&&n.first||"User"}),me:Gt(e),createMessageActionStatus:Si(e,"createMessageAction"),deleteMessageActionStatus:Si(e,"deleteMessageAction")}},ji)(Ai),Ci={cancelPendingMessage:no.cancelPendingMessage,resendPendingMessage:no.resendPendingMessage},Ni=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).retryClick=function(e){var t=n.props,a=t.message,r=t.resendPendingMessage;e.preventDefault(),r(a)},n.cancelClick=function(e){var t=n.props,a=t.message,r=t.cancelPendingMessage;e.preventDefault(),r(a)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(q.m,{size:"sm"},r.a.createElement(q.l,{type:"inline",size:"half"},r.a.createElement(Ne.Q,{size:"sm",color:"red"})),_e("Not delivered"),".\xa0",r.a.createElement(q.g,{href:"#",onClick:this.retryClick,"data-ref":"retry"},_e("Try Again")),"\xa0or\xa0",r.a.createElement(q.g,{href:"#",onClick:this.cancelClick,"data-ref":"cancel"},_e("Delete Message")))}}]),t}(r.a.Component),ki=Object(m.b)(void 0,Ci)(Ni),Li=n(92),Pi=n.n(Li);var wi=qn()(function(e){var t=e.width,n=e.height,a=e.maxWidth,r=e.maxHeight,o=t/n,s=Math.min(n,r);return{width:Math.round(s*o),height:s,maxWidth:a,maxHeight:r}},function(e){var t=e.width,n=e.height,a=e.maxWidth,r=e.maxHeight,o=t/n,s=Math.min(a,t);return{width:s,height:Math.round(s/o),maxWidth:a,maxHeight:r}});var xi=n(181),Mi=n.n(xi),Di=function(e){var t=e.attachments,n=e.maxHeight,o=void 0===n?1/0:n,s=yo()(t,{label:"mobile"})||yo()(t,{label:"original"}),i=Object(a.useRef)(null),c=function(e,t,n){var r=Object(a.useState)(512),o=Object(ba.a)(r,2),s=o[0],i=o[1],c=re()(t,"dimensions.width",512),u=re()(t,"dimensions.height",384),l=S()(function(){if(e.current){var t=e.current.getBoundingClientRect();i(t.width)}},100),d=function(){window.removeEventListener("resize",l)};Object(a.useEffect)(function(){return l(),window.addEventListener("resize",l),function(){d()}});var m=wi({width:c,height:u,maxWidth:s,maxHeight:n});return{width:m.width,height:m.height,clearResizeListener:d}}(i,s,o),u=c.width,l=c.height,d=function(e){var t=Object(a.useState)(!1),n=Object(ba.a)(t,2),r=n[0],o=n[1];return{isLoaded:r,handleLoad:function(){o(!0),Ae()(e)&&e()}}}(c.clearResizeListener),m=d.isLoaded,p=d.handleLoad,f=Ce()(Mi.a.staticImage,Object(ee.a)({},Mi.a.loaded,m)),_=Ce()(Mi.a.placeholder,Object(ee.a)({},Mi.a.loaded,m)),h=m?{}:{width:"".concat(u,"px"),height:"".concat(l,"px")};return r.a.createElement("div",{ref:i},r.a.createElement("div",{className:_,style:h},r.a.createElement(q.h,{busy:!m},r.a.createElement("img",{"data-testid":"image",className:f,src:s.url,alt:"user generated content",onLoad:p}))))},Ui=function(e){var t=e.attachments,n=e.maxImageHeight;return t&&t.length?r.a.createElement(Di,{attachments:t,maxHeight:n}):null},Fi=xn()(function(e){return""===e.replace(_t,"").replace(ft,"")}),Gi=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).preventScrollProp=function(e){e.stopPropagation()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.onProfileClick,a=t.onSetToEdit,o=t.onAssignNode,s=t.onOpenModal,i=t.message,c=t.isMe,u=t.showMenu,l=t.threadUrl,d=t.rootUrl,m=t.role,p=i.links,f=i.content,_=i.mentions,h=i.attachments,v=Ee(i.room_id),E=ge(i.room_id),g=f&&Fi(f),b=i.thread?i.thread.participants:[],O=re()(i,"failed",!1),S=i.thread&&!!i.thread.message_count,I=!v&&!E,y=Ce()(Pi.a.bottom,Object(ee.a)({},Pi.a.failedPendingActions,O)),T=Ce()(Pi.a.wrapper,(e={},Object(ee.a)(e,Pi.a.failedPendingMessage,O),Object(ee.a)(e,Pi.a.emojiMessage,g),e)),j=i.message_actions,A=(void 0===j?[]:j).filter(function(e){return"REACTION"===e.type}).reduce(function(e,t){var n=e[t.metadata.id]||[];return e[t.metadata.id]=[].concat(Object(yt.a)(n),[t]),e},{}),R=Object.keys(A).map(function(e){var t=A[e][0].metadata;return r.a.createElement(Ri,{key:e,emoji:t,reactions:A[e],message:i})});return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:T,onScroll:this.preventScrollProp},r.a.createElement("div",{className:Pi.a.messageContent},r.a.createElement(Bo,{content:f,mentions:_,isMe:c,onProfileClick:n}),!!p&&r.a.createElement(Es,{links:p,isMe:c}),!!h&&r.a.createElement(Ui,{attachments:h,maxImageHeight:parseInt(Pi.a.maxImageHeight,10)})),u&&!O&&r.a.createElement("div",{className:Pi.a.menuContainer,ref:o},r.a.createElement(Ns,{isThread:v,message:i,onDeleteMessageClick:s,onSetToEdit:a,ownMessage:c,rootUrl:d,threadUrl:l,role:m,enableThreads:I,attachments:h}))),r.a.createElement("div",{className:Pi.a.reactionList},R),S&&!O&&r.a.createElement("div",{className:y},r.a.createElement(ni,{thread:i.thread,profiles:b,threadUrl:l})),O&&r.a.createElement("div",{className:y},r.a.createElement(ki,{message:i})))}}]),t}(r.a.Component);Gi.defaultProps={onRetryClick:h.a,onCancelClick:h.a};var Bi=Gi,Hi=n(442),Vi=n.n(Hi),zi=n(242),Wi=n(443),Yi=n.n(Wi),qi=n(232),Ki=n.n(qi),Ji=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.suggestion,t=e.id,n=e.display,a=e.photo_url,o=e.type,s={firstName:n,lastName:"",photoUrl:a,size:24,role:o,userId:t},i=e.id===he.id,c=i?"@"+n:n;return r.a.createElement("div",{className:Ki.a.mentionSuggestion},r.a.createElement("span",{className:Ki.a.avatar},i?r.a.createElement("span",{className:Ki.a.channel},r.a.createElement(Ne.M,{size:"sm"})):r.a.createElement(Hn,s)),r.a.createElement(q.m,{size:"sm",spacing:"none"},c),r.a.createElement(la,{type:o}))}}]),t}(r.a.PureComponent),Xi=n(243),Qi=function(e){var t=Object(a.useState)(),n=Object(ba.a)(t,2),r=n[0],o=n[1],s="left",i="right",c="rtl"===getComputedStyle(document.body).direction;return Object(a.useEffect)(function(){o("start"===e?c?i:s:"end"===e?c?s:i:e)},[e,c,i,s]),r},$i=function(e){var t=e.children,n=e.onClose,s=e.direction,i=void 0===s?"bottom":s,c=e.open,u=void 0!==c&&c,l=e.trigger,d=e.referenceElement,m=Object(a.useRef)();!function(e,t){var n=["mousedown","touchstart"],r=Object(a.useRef)(t);Object(a.useEffect)(function(){r.current=t}),Object(a.useEffect)(function(){var t=function(t){e.current&&r.current&&!e.current.contains(t.target)&&r.current(t)};return n.map(function(e){return document.addEventListener(e,t)}),function(){n.map(function(e){return document.removeEventListener(e,t)})}},[n,e])}(m,n),function(e){var t=function(t){return 27===t.keyCode&&e()};Object(a.useEffect)(function(){return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)}})}(n);var p=Ce()("vds-popover"),f=Ce()("vds-tail","vds-tail--inverse"),_=r.a.createElement(Xi.c,null,function(e){var t=e.ref;return r.a.createElement("span",{"aria-describedby":"vds-popover","aria-expanded":u,"aria-haspopup":!0,ref:t},l)}),h=r.a.createElement(Xi.b,{placement:Qi(i),referenceElement:d},function(e){var n=e.ref,a=e.placement,o=e.style,s=e.arrowProps;return r.a.createElement("span",{ref:m},r.a.createElement("span",{className:p,"data-placement":a,id:"vds-popover",ref:n,role:"dialog",style:o},r.a.createElement("span",{className:f,ref:s.ref,style:s.style}),t))});return r.a.createElement(Xi.a,null,_,u&&Object(o.createPortal)(h,document.body))},Zi=n(128),ec=n.n(Zi);var tc,nc=function(e){var t,n=e.showKey,a=Ce()(ec.a.markdownKey,(t={},Object(ee.a)(t,ec.a.fadeIn,n),Object(ee.a)(t,ec.a.fadeOut,!n),t));return r.a.createElement("div",{className:ec.a.markdownKeyContainer},r.a.createElement("ul",{className:a},r.a.createElement("li",null,"**",r.a.createElement("b",null,"bold"),"**"),r.a.createElement("li",null,"_",r.a.createElement("i",null,"italics"),"_"),r.a.createElement("li",null,"~strike~"),r.a.createElement("li",null,">quote"),r.a.createElement("li",null,r.a.createElement("span",{className:ec.a.code},"`code`")),r.a.createElement("li",null,r.a.createElement("span",{className:ec.a.code},"```code block```"))))},ac=function(){return r.a.createElement(q.f,{size:"md",color:"white",title:"Send"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},r.a.createElement("path",{fill:"#FFFFFF",d:"M8,17 L8,23.4198002 L23.6640227,16 L8,8.58019979 L8,15 L17,15 C17.5522847,15 18,15.4477153 18,16 C18,16.5522847 17.5522847,17 17,17 L8,17 Z M6,7 C6,6.26588597 6.76463972,5.78199797 7.42808634,6.09626216 L26.4280863,15.0962622 C27.1906379,15.4574708 27.1906379,16.5425292 26.4280863,16.9037378 L7.42808634,25.9037378 C6.76463972,26.218002 6,25.734114 6,25 L6,7 Z"})))};function rc(e){var t=bs.c.emojis[e.toLowerCase()]||{};return t.hasOwnProperty(1)&&(t=t[1]),t.native}!function(e){e.gif="image/gif",e.jpeg="image/jpeg",e.png="image/png"}(tc||(tc={}));var oc=function(e){return e.stopPropagation()},sc=function(e){switch(!0){case e<350:return 2;case e<500:return 5;default:return 25}};var ic="pendingMessage",cc="pendingMentions";function uc(e){return{message:Ue.get(ic,e)||"",mentions:Ue.get(cc,e)||{}}}var lc=Ro()(function(e,t,n){Ue.set(ic,e,n),Ue.set(cc,t,n)},250),dc=n(446),mc=n.n(dc),pc=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.suggestion,t=e.native,n=e.colons;return r.a.createElement("div",{className:mc.a.mentionSuggestion},r.a.createElement(q.m,{size:"sm",spacing:"none"},"".concat(t," ").concat(n)))}}]),t}(r.a.PureComponent),fc=n(69),_c=n.n(fc),hc=n(447),vc=n.n(hc),Ec={background:"#F5FCFE",borderRadius:4,padding:"4px 0px"},gc=/($a)/,bc=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={userInput:n.props.initialUserInput||"",mentions:n.props.initialMentions||{},isSocketConnected:!0,attachments:n.props.initialAttachments||[],showEmojiPicker:!1},n.formRef=void 0,n.inputRef=void 0,n.fileRef=void 0,n.mentionsCallback=void 0,n.isSocketConnectedTimeout=void 0,n.confirmMentions=Ro()(function(e){var t=n.state.mentions;Object.keys(t).forEach(function(a){!e.includes("[@".concat(t[a],"](").concat(rt.UID_PREFIX).concat(a,")"))&&n.setState({mentions:Vs()(t,[a])})})},250,{leading:!0,trailing:!0}),n.queryParticipants=Ro()(function(e,t){var a=n.props,r=a.onSearch,o=a.participants;r&&r(e),n.mentionsCallback=t,n.updateMentionsSuggestions(o)},250,{leading:!0,trailing:!0}),n.updateMentionsSuggestions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(n.mentionsCallback){var t=sc(window.innerHeight),a=Yi()(e,t)[0]||[];n.mentionsCallback(a)}},n.onReload=function(){return window.location.reload()},n.onChange=function(e){n.confirmMentions(e.target.value),n.setState({userInput:e.target.value},function(){var e=n.convertColonSyntaxEmoji();lc(e,n.state.mentions,n.props.roomId)})},n.onKeyDown=function(e){e.shiftKey||e.keyCode!==tt.ENTER||n.onSubmit(e)},n.onSubmit=function(e){var t=n.state,a=t.userInput,r=t.mentions,o=n.props,s=o.isSocketConnected,i=o.onSubmit;a&&(e.preventDefault(),s&&(i(a.trim(),Object.keys(r)),n.setState({userInput:"",mentions:{}}),lc("",{},n.props.roomId)))},n.addMention=function(e,t){var a=n.props.onSelectMention;n.setState(function(n){return{mentions:Object(N.a)({},n.mentions,Object(ee.a)({},e,t))}}),n.mentionsCallback=void 0,a&&a()},n.displayTransform=function(e,t){return"@".concat(t)},n.renderMentionSuggestion=function(e){return r.a.createElement(Ji,{suggestion:e})},n.renderEmojiSuggestion=function(e){return r.a.createElement(pc,{suggestion:e})},n.focusInput=function(){n.inputRef.current&&n.inputRef.current.focus()},n.clickFileAdd=function(e){e.preventDefault(),n.fileRef.current&&n.fileRef.current.click()},n.onAddFile=function(e){var t=n.props.onAddFile,a=e.target.files[0];Ae()(t)&&t(a),e.target.value=null},n.clickEmojiAdd=function(e){e.preventDefault(),n.setState({showEmojiPicker:!0})},n.handleSelectEmoji=function(e){for(var t=n.state,a=t.userInput,r=t.mentions,o=n.inputRef.current?n.inputRef.current.value:a,s=n.inputRef.current?ya(n.inputRef.current):[o.length,o.length],i=Object(ba.a)(s,2),c=i[0],u=i[1],l=Object.keys(r),d=c,m=u,p=function(){var e=_[f],t="@".concat(r[e]),n="[@".concat(r[e],"](").concat(rt.UID_PREFIX).concat(e,")"),a=o.indexOf(t),s=[{cursor:c,insert:d},{cursor:u,insert:m}].map(function(e){if(e.cursor>a+t.length)return e.insert+(n.length-t.length);if(e.cursor>a){var r=e.cursor-a;return e.insert+(n.length-r)}return e.insert}),i=Object(ba.a)(s,2);d=i[0],m=i[1]},f=0,_=l;f<_.length;f++)p();var h=a.slice(0,d)+e.native+a.slice(m),v=c+e.native.length;n.setState({userInput:h},function(){n.inputRef.current&&n.inputRef.current.setSelectionRange(v,v)}),n.handleCloseEmojiPicker(),n.focusInput()},n.handleCloseEmojiPicker=function(){n.setState({showEmojiPicker:!1})},n.emojiMentionSearch=function(e,t){t((e.length>=2?bs.c.search(e):[]).filter(function(e){return!!e.native}).map(function(e){return{id:e.id,display:e.native,colons:e.colons,native:e.native}}).slice(0,sc(window.innerHeight)))},n.convertColonSyntaxEmoji=function(){var e=n.state.userInput,t=e.replace(/:([\w\-+]+):/g,function(e,t){return rc(t)||e});if(e===t)return e;for(var a,r=n.inputRef.current?n.inputRef.current.value:e,o=n.inputRef.current?ya(n.inputRef.current):[r.length,r.length],s=Object(ba.a)(o,2),i=s[0],c=s[1],u=i,l=c,d=/:([\w\-+]+):/g,m=function(){var e=a[0],t=rc(a[1]);if(!t)return"continue";var n=[{cursor:i,updated:u},{cursor:c,updated:l}].map(function(n){if(n.cursor>a.index+e.length)return n.updated-(e.length-t.length);if(n.cursor>a.index){var r=n.cursor-a.index;return n.updated-(r-t.length)}return n.updated}),r=Object(ba.a)(n,2);u=r[0],l=r[1]};a=d.exec(r);)m();return n.setState({userInput:t},function(){n.inputRef.current&&n.inputRef.current.setSelectionRange(u,l)}),t},n.formRef=Object(a.createRef)(),n.inputRef=Object(a.createRef)(),n.fileRef=Object(a.createRef)(),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.initialUserInput,n=e.roomId;if(e.requireManualFocus||this.focusInput(),this.checkSocketConnection(),!t){var a=uc(n),r=a.message,o=a.mentions;this.setState({userInput:r,mentions:o})}}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.participants,a=t.roomId,r=t.isSocketConnected,o=t.requireManualFocus;if(e.participants!==n&&this.updateMentionsSuggestions(n),e.roomId!==a){lc.flush();var s=uc(this.props.roomId),i=s.message,c=s.mentions;this.setState({userInput:i,mentions:c}),o||this.focusInput()}e.isSocketConnected!==r&&this.checkSocketConnection()}},{key:"componentWillUnmount",value:function(){lc.flush(),this.isSocketConnectedTimeout&&clearTimeout(this.isSocketConnectedTimeout)}},{key:"checkSocketConnection",value:function(){this.props.isSocketConnected?(this.isSocketConnectedTimeout&&clearTimeout(this.isSocketConnectedTimeout),this.setState({isSocketConnected:!0})):this.setSocketConnectionTimeout()}},{key:"setSocketConnectionTimeout",value:function(){var e=this;this.isSocketConnectedTimeout&&clearTimeout(this.isSocketConnectedTimeout),this.isSocketConnectedTimeout=setTimeout(function(){e.props.isSocketConnected||e.setState({isSocketConnected:!1})},3e3)}},{key:"render",value:function(){var e,t=this.props,n=t.me,a=t.roomId,o=t.actionButtons,s=t.allowMentions,i=t.displayMarkdownKey,c=this.state,u=c.userInput,l=c.isSocketConnected,d=Ce()(_c.a.chatInput,Object(ee.a)({},_c.a.disconnected,!l)),m=this.formRef.current?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=e.getBoundingClientRect(),a={input:{overflow:"auto",maxHeight:150}},r={suggestions:{list:{bottom:"".concat(t.innerHeight-n.top-20,"px"),left:"".concat(n.x,"px"),width:"".concat(n.width,"px")}}};if(!e)return a;var o=n.top<t.innerHeight-n.bottom;return Object(N.a)({},a,!o&&r)}(this.formRef.current):{};return n&&(e={firstName:n.first_name,lastName:n.last_name,photoUrl:n.photo_url,userId:n.id,role:gt(n.roles,a)}),r.a.createElement("form",{onSubmit:this.onSubmit,ref:this.formRef},r.a.createElement("label",{htmlFor:"userInput",className:_c.a.inputLabel},"Start chatting!"),!l&&r.a.createElement(q.m,{size:"sm",spacing:"half",color:"silver"},"No internet connection, attempting to reconnect...","  ",r.a.createElement(q.g,{href:"",onClick:this.onReload},"Reload")),r.a.createElement("div",{className:_c.a.chatInputWrapperGrid},r.a.createElement("div",{className:_c.a.mobileFileButtonWrapper},r.a.createElement(q.a,{label:_e("Add file"),variant:"secondary",icon:r.a.createElement(Ne.e,null),onClick:this.clickFileAdd,iconOnly:!0})),r.a.createElement("div",{className:d,onScroll:oc},r.a.createElement("div",{className:_c.a.avatarContainer},!!n&&r.a.createElement(q.o,{direction:"top",content:"You",trigger:r.a.createElement(ts,{userId:n.id},r.a.createElement(Vn,e))})),r.a.createElement("div",null,r.a.createElement(zi.b,{inputRef:this.inputRef,id:"userInput",value:u,onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:_e("Start chatting!"),suggestionsPortalHost:document.body,classNames:vc.a,style:m},r.a.createElement(zi.a,{trigger:s?ot["@"]:ot.IMPOSSIBLE_MATCH,data:this.queryParticipants,renderSuggestion:this.renderMentionSuggestion,appendSpaceOnAdd:!0,displayTransform:this.displayTransform,markup:"[@__display__](user://__id__)",onAdd:this.addMention,style:Ec}),r.a.createElement(zi.a,{trigger:ot[":"],data:this.emojiMentionSearch,renderSuggestion:this.renderEmojiSuggestion,appendSpaceOnAdd:!0,regex:gc,markup:"__display__"}))),!o&&r.a.createElement("div",{className:_c.a.controlsContainer},r.a.createElement("span",{className:_c.a.mobileSendButton},r.a.createElement(q.a,{label:"Send",variant:"primary",onClick:this.onSubmit,icon:r.a.createElement(ac,null),iconOnly:!0})),r.a.createElement("input",{type:"file",className:_c.a.fileInput,ref:this.fileRef,"data-testid":"file-input",onChange:this.onAddFile,accept:ce()(tc).join(", ")}),r.a.createElement("span",{className:_c.a.desktopFileButtonWrapper},r.a.createElement($i,{open:this.state.showEmojiPicker,onClose:this.handleCloseEmojiPicker,direction:"top",referenceElement:void 0,trigger:r.a.createElement(q.o,{direction:"top",content:"Add emoji",trigger:r.a.createElement("button",{onClick:this.clickEmojiAdd,className:_c.a.desktopFileButton,"data-testid":"emoji-add-button"},r.a.createElement(Os,null))})},r.a.createElement(bs.b,{autoFocus:!0,native:!0,color:"#017A9B",onSelect:this.handleSelectEmoji,sheetSize:32,showPreview:!1,showSkinTones:!1}))),r.a.createElement("span",{className:_c.a.desktopFileButtonWrapper},r.a.createElement(q.o,{direction:"top",content:"Upload file",trigger:r.a.createElement("button",{onClick:this.clickFileAdd,className:_c.a.desktopFileButton,"data-testid":"file-upload-button"},r.a.createElement(Ne.e,{size:"md"}))}))))),i&&r.a.createElement(nc,{showKey:u.length>2}),!!o&&o)}}]),t}(r.a.Component);bc.defaultProps={participants:[],allowMentions:!0,displayMarkdownKey:!0};var Oc=bc,Sc=n(309),Ic=n.n(Sc),yc=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onSubmit,n=e.onSearch,a=e.onSelectMention,o=e.onSetToReadOnly,s=e.participants,i=e.roomId,c=e.message,u=e.isSocketConnected,l=e.mentions;return r.a.createElement("div",{className:Ic.a.editInput},r.a.createElement(Oc,{onSubmit:t,onSearch:n,onSelectMention:a,participants:s,roomId:i,initialUserInput:c.content,initialMentions:l,isSocketConnected:u,displayMarkdownKey:!1,actionButtons:r.a.createElement("div",{className:Ic.a.actionButtons},r.a.createElement(q.a,{label:_e("Save"),variant:"primary",type:"submit",small:!0}),r.a.createElement(q.a,{label:_e("Cancel"),variant:"secondary",onClick:o,small:!0}))}))}}]),t}(r.a.Component),Tc=function(e){return re()(e,"sockets.connected")||!1};var jc={editMessage:no.editMessage,getParticipants:bo.getParticipants,searchParticipants:bo.searchParticipants,resetSearchParticipants:bo.resetSearchParticipants},Ac=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={mentions:{}},n.onSubmit=function(e,t){var a=n.props,r=a.editMessage,o=a.message,s=a.onSetToReadOnly,i=o.message_id_str;r(o.room_id,i,{content:e,mentions:t,version:o.version}),s()},n.searchParticipants=function(e){var t=n.props,a=t.parentRoomId,r=t.roomId;(0,t.searchParticipants)(a||r,e)},n.onSelectMention=function(){var e=n.props,t=e.parentRoomId,a=e.roomId;(0,e.resetSearchParticipants)(t||a)};var a=e.message,r=a.content,o=a.mentions,s=function(e){for(var t,n={},a=/\[@([^\]]+)\]\(user:\/\/([\w-]+)\)/g;t=a.exec(e);){var r=t,o=Object(ba.a)(r,3),s=o[1];n[o[2]]=s}return n}(r||"");return n.state={mentions:Vi()(s,o)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state.mentions,t=this.props,n=t.searchedParticipants,a=t.onSetToReadOnly,o=t.message,s=t.roomId,i=t.isSocketConnected;return r.a.createElement(yc,{participants:n,message:o,onSubmit:this.onSubmit,onSearch:this.searchParticipants,onSelectMention:this.onSelectMention,onSetToReadOnly:a,roomId:s,isSocketConnected:i,mentions:e})}}]),t}(r.a.Component),Rc=Object(m.b)(function(e,t){var n=t.parentRoomId,a=t.roomId;return{searchedParticipants:Sn(e,n||a),isSocketConnected:Tc(e)}},jc)(Ac),Cc=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={editable:!1},n.setToEdit=function(){n.setState({editable:!0})},n.setToReadOnly=function(){return n.setState({editable:!1})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.isMe,a=e.role,o=e.onProfileClick,s=e.roomId,i=e.showMenu,c=e.onAssignNode,u=e.onOpenModal,l=e.parentRoomId,d=e.threadUrl,m=e.rootUrl;return this.state.editable?r.a.createElement(Rc,{message:t,onSetToReadOnly:this.setToReadOnly,parentRoomdId:l,roomId:s,messageId:t.message_id}):r.a.createElement(Bi,{message:t,showMenu:i,onSetToEdit:this.setToEdit,isMe:n,role:a,rootUrl:m,onProfileClick:o,onAssignNode:c,onOpenModal:u,threadUrl:d})}}]),t}(r.a.PureComponent),Nc=n(85),kc=n.n(Nc),Lc=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={showMenu:!1,isDeleteMessageModalOpen:!1},n.node=void 0,n.assignNode=function(e){return n.node=e},n.onHoverIn=function(){return n.setState({showMenu:!0})},n.onHoverOut=function(){return n.closeMenu()},n.closeMenu=function(){n.setState({showMenu:!1},function(){n.node=void 0})},n.onProfileClick=function(){var e=n.props;(0,e.onProfileClick)(e.message.user_id)},n.openModal=function(){n.setState({isDeleteMessageModalOpen:!0})},n.closeModal=function(){n.setState({isDeleteMessageModalOpen:!1}),n.closeMenu()},n.confirmDeleteMessage=function(){var e=n.props,t=e.message,a=t.message_id,r=t.room_id,o=e.onDeleteMessage;Ae()(o)&&o(a,r),n.closeModal()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,n=this.props,a=n.hasOlderSibling,o=n.message,s=n.me,i=n.rootUrl,c=n.onProfileClick,u=n.parentRoomId,l=n.roomId,d=n.selected,m=n.onSetRefEl,p=n.onPopupProfile,f=n.onOpen,_=n.onClose,h=this.state,v=h.showMenu,E=h.isDeleteMessageModalOpen,g=rn(o._participant,o._profile,l),b=g.role,O=g.name,S=g.avatarProps,I=function(e,t){var n=e.replace(/\/$/,""),a=e.includes("/threads"),r=t.thread?t.thread.thread_id:"";return re()(t,"thread.message_count",0)?a?function(e,t,n){return"".concat(e,"/").concat(t,"/").concat(n,"?contextType=room")}(n,t.room_id,r):function(e,t){return"".concat(e,"/").concat(t,"?contextType=room")}(n,r):function(e,t){return"".concat(e,"/new/").concat(t,"?contextType=room")}(n,t.message_id)}(i,o),y=!Se(i),T=!!s&&s.id===o.user_id,j=Ce()(kc.a.container,(e={},Object(ee.a)(e,kc.a.me,T),Object(ee.a)(e,kc.a.bot,"bot"===b),Object(ee.a)(e,kc.a.failedPending,re()(o,"failed",!1)),Object(ee.a)(e,kc.a.selected,d),Object(ee.a)(e,kc.a.hasOlderSibling,a),e)),A=function(e){f&&m&&p&&y&&!T&&(f(),m(e.target),p(o._profile))},R=function(){_&&_()};return r.a.createElement("div",{className:j,"data-user-message":"true","data-message-id":o.message_id,onMouseEnter:this.onHoverIn,onFocus:this.onHoverIn,onBlur:this.onHoverOut,onMouseLeave:this.onHoverOut},r.a.createElement("div",{className:kc.a.header},r.a.createElement("div",{className:kc.a.name},r.a.createElement(q.m,{size:"sm",spacing:"none"},r.a.createElement(ts,{userId:S.userId},O))),r.a.createElement(la,{type:b}),r.a.createElement(q.m,{size:"sm",spacing:"none",color:"silver"},r.a.createElement("time",{dateTime:o.created_at,title:String(new Date(o.created_at))},(t=o.created_at,qe()(t,"h:mm A"))))),!le()(S)&&r.a.createElement("div",{"data-tst":"trigger",className:kc.a.avatar,onMouseOver:A,onFocus:A,onMouseLeave:R,onBlur:R},r.a.createElement(ts,{userId:S.userId},r.a.createElement(Vn,Object(N.a)({},S,{userId:o.user_id})))),r.a.createElement("div",{className:kc.a.messageWrapper},r.a.createElement(Cc,{isMe:T,message:o,onAssignNode:this.assignNode,onOpenModal:this.openModal,onProfileClick:c,parentRoomId:u,role:b,roomId:l,rootUrl:i,showMenu:v,threadUrl:I})),E&&r.a.createElement(cs,{isOpen:!0,onRequestClose:this.closeModal},r.a.createElement(ds,{closeModal:this.closeModal,confirmDeleteMessage:this.confirmDeleteMessage})))}}]),t}(r.a.Component),Pc=n(448),wc=n.n(Pc);var xc=function(e){var t=e.text,n=e.className,a=Ce()(wc.a.messageDivider,n);return r.a.createElement("div",{className:a},r.a.createElement(q.e,{size:"h6"},t))},Mc=n(226),Dc=n.n(Mc),Uc=n(449),Fc=n.n(Uc),Gc=function(e){if(!e)return[];var t=e.querySelectorAll("div[data-user-message]");return Array.from(t)},Bc=function(e,t){if(t&&!At()(e))return e.querySelector('div[data-user-message][data-message-id="'.concat(t,'"]'))||void 0},Hc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"".concat(e," ").concat(_e(1===e?"New Message":"New Messages"))},Vc=function(e){var t,n=Gc(e).reverse(),a=e.scrollTop+e.offsetHeight,r=!0,o=!1,s=void 0;try{for(var i,c=n[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value,l=Ia(u,e);if(l<a&&t)return t;if(l<a)return;t=u}}catch(d){o=!0,s=d}finally{try{r||null==c.return||c.return()}finally{if(o)throw s}}},zc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t)return yo()(e,{message_id:parseInt(String(t),10)})},Wc=function(e,t){var n=!0,a=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var i=o.value,c=!0,u=!1,l=void 0;try{for(var d,m=i[Symbol.iterator]();!(c=(d=m.next()).done);c=!0){var p=d.value,f=!0,_=!1,h=void 0;try{for(var v,E=p[Symbol.iterator]();!(f=(v=E.next()).done);f=!0){if(v.value.message_id===parseInt(e,10))return p[0]}}catch(g){_=!0,h=g}finally{try{f||null==E.return||E.return()}finally{if(_)throw h}}}}catch(g){u=!0,l=g}finally{try{c||null==m.return||m.return()}finally{if(u)throw l}}}}catch(g){a=!0,r=g}finally{try{n||null==s.return||s.return()}finally{if(a)throw r}}},Yc=function(e){return e.scrollHeight-e.offsetHeight-e.scrollTop},qc=n(90),Kc=n.n(qc),Jc=function(e){var t=e.messages,n=e.unreads,a=e.children,o=re()(n,"oldest_message_id")||re()(n,"oldest"),s=re()(n,"unread_count")||re()(n,"count"),i=yo()(t,function(e){var t=e.message_id;return String(t)===String(o)}),c=s&&o&&!!i;return r.a.createElement("li",{className:Kc.a.authorBlock},!!c&&r.a.createElement(xc,{text:Hc(s),className:Kc.a.unreadDivider}),r.a.createElement("ul",null,a))},Xc=function(e){var t,n=e.messages,a=e.className,o=e.children,s=re()(No()(No()(n)),"created_at","");return r.a.createElement("li",{className:a,"data-day-block":s},r.a.createElement(xc,{text:(t=s,Dc()(t)?"Today":Fc()(t)?"Yesterday":qe()(t,"MMMM D, YYYY")),className:Kc.a.dayDivider}),r.a.createElement("ul",null,o))};var Qc=Object(A.g)(function(e){var t=e.myId,n=e.history,a=e.roomId,o=e.profile,s=e.conversationId;return r.a.createElement(q.a,{onClick:function(){var e=o&&o.id,r=[t,e];n.push(Te(r,a||s))},label:_e("Send Direct Message"),variant:"secondary",small:!0,full:!0})}),$c=n(182),Zc=n.n($c);var eu=function(e){var t=e.me,n=e.profile,a=e.roomId,o=rn(void 0,n,a),s=o.role,i=o.name,c=o.avatarProps;return r.a.createElement("div",{className:Zc.a.container},r.a.createElement("div",{className:Zc.a.bioContainer},r.a.createElement("div",{className:Zc.a.avatar},r.a.createElement(Vn,Object.assign({},c,{sizeSelection:"md",size:60}))),r.a.createElement("div",{className:Zc.a.bio},r.a.createElement(q.e,{size:"h5",spacing:"none"},i),r.a.createElement(la,{type:s}))),r.a.createElement(Qc,{myId:t.id,profile:n,roomId:a}))};var tu=function(e){var t=e.me,n=e.profile,a=e.roomId,o=e.referenceElement,s=e.onClose,i=e.onOpen,c=e.isOpen;return r.a.createElement($i,{open:c,onClose:s,direction:"top",referenceElement:o,trigger:!1},r.a.createElement("div",{"data-tst":"bio-container",onMouseOver:i,onFocus:i,onMouseLeave:s,onBlur:s},r.a.createElement(eu,{me:t,profile:n,roomId:a})))},nu=function(){var e,t=Object(a.useState)(!1),n=Object(ba.a)(t,2),r=n[0],o=n[1],s=function(){return o(!1)};Object(a.useEffect)(function(){return r&&window.addEventListener("scroll",s,!0),function(){clearTimeout(e),window.removeEventListener("scroll",s,!0)}});return{isOpen:r,handleOpen:function(){clearTimeout(e),o(!0)},handleClose:function(){e=setTimeout(function(){return o(!1)},250)}}},au=function(e){var t=e.messages.groupedMessages,n=void 0===t?[]:t,o=nu(),s=o.isOpen,i=o.handleOpen,c=o.handleClose,u=Object(a.useState)(),l=Object(ba.a)(u,2),d=l[0],m=l[1],p=Object(a.useState)(),f=Object(ba.a)(p,2),_=f[0],h=f[1],v=function(e){return h(e)},E=function(e){return m(e)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(tu,{me:e.me,roomId:e.roomId,profile:d,referenceElement:_,isOpen:s,onOpen:i,onClose:c}),n.map(function(t,n){return r.a.createElement(Xc,{key:n,messages:t,className:Kc.a.dayBlock},t.map(function(t,n){return r.a.createElement(Jc,{key:n,messages:t,unreads:e.unreads},t.map(function(t,n){var a=t.message_id;return r.a.createElement("li",{key:"".concat(a,"-").concat(n),className:Kc.a.message},r.a.createElement(Lc,{key:a,me:e.me,message:t,onDeleteMessage:e.onDeleteMessage,onProfileClick:e.onProfileClick,parentRoomId:e.parentRoomId,roomId:e.roomId,rootUrl:e.rootUrl||"/",hasOlderSibling:n>0,selected:String(t.message_id)===e.selectedMessageId,onSetRefEl:v,onPopupProfile:E,onOpen:i,onClose:c}))}))}))}))},ru=400,ou=1e3,su=150,iu=function(e,t){var n=Object(a.useState)({scrolledNearTop:!0,scrolledNearBottom:!0,scrolledFarUp:!1}),r=Object(ba.a)(n,2),o=r[0],s=r[1];return{scrollToElement:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e&&e.current;if(le()(a)||le()(t))return;var r=Ia(t,a),o=t.offsetHeight,s=a.offsetHeight,i=r+o+s+su;n&&(i=r-o-su);return a.scrollTop=i,i},scrollState:o,onScroll:function(e){var n=e.target,a=o.scrolledNearBottom,r=o.scrolledNearTop,i=o.scrolledFarUp,c=n.scrollTop,u=Yc(n),l=c<ru,d=u<ru,m=u>ou,p={};l&&!r?(p.scrolledNearTop=!0,t&&Ae()(t.onPrevPage)&&t.onPrevPage()):d&&!a&&(p.scrolledNearBottom=!0,t&&Ae()(t.onNextPage)&&t.onNextPage());!l&&r&&(p.scrolledNearTop=!1);!d&&a&&(p.scrolledNearBottom=!1);m&&!i&&(p.scrolledFarUp=!0);!m&&i&&(p.scrolledFarUp=!1);s(function(e){return Object(N.a)({},e,p)}),t&&Ae()(t.onScroll)&&t.onScroll()}}},cu=function(e){var t=Ro()(function(){var t=s.current;if(!t||!e.unreads)return;if(c.scrolledNearBottom)e.onUpdateLastVisited();else{var n=Vc(t);if(n){var a=n.dataset.messageId,r=zc(e.messages.messages,a);r&&e.onUpdateLastVisited(r.created_at)}}},1500);Object(a.useEffect)(function(){return m(),setTimeout(function(){m()}),function(){t.cancel()}},[e.roomId,e.messageId]);var n=ko(e),o=re()(e,"messages.messages.length")||0;Object(a.useEffect)(function(){!function(){var t=c.scrolledNearBottom;if(le()(n))return;var a=re()(n,"messages.messages.length")||0,r=re()(e,"messages.messages.length")||0,o=r&&a!==r,s=r-a===1,i=n.loadingPivot&&!e.loadingPivot,u=n.loadingPrev&&!e.loadingPrev,l=n.loadingNext&&!e.loadingNext,d=re()(e,"messages.cursor.has_next")||!1,f=No()(n.messages.messages),_=Sa()(n.messages.messages),h=Sa()(e.messages.messages),v=e.me&&e.me.id,E=!!h&&h.user_id===v;if(i)return p(e.pivotMessageId,!0);if(o){if(u&&f)return p(f.message_id,!0);if(l&&_)return p(_.message_id);if(s&&(!u&&!l&&t||E)&&!d)return p();if(!a)m()}}()},[o]);var s=Object(a.useRef)(null),i=iu(s,{onScroll:function(){t()},onNextPage:e.onNextPage,onPrevPage:e.onPrevPage}),c=i.scrollState,u=i.onScroll,l=i.scrollToElement,d=S()(u,500);function m(){if(e.messageId)return p(parseInt(e.messageId,10),!0);if(!le()(e.unreads)){var n=re()(e,"unreads.oldest_message_id")||re()(e,"unreads.oldest"),a=s.current;return!!a&&a.scrollHeight===a.clientHeight?t():p(n,!0,!0)}return p()}function p(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(s.current){var r=t;if(a&&t){var o=Wc(t,e.messages.groupedMessages);o&&(r=o.message_id)}var i=Bc(s.current,r);if(r&&i)l(i,n);else{var c=Gc(s.current),u=Sa()(c);l(u,n)}}}var f,_={shouldShowAbove:function(e){var t=s.current,n=Bc(t,e);return!(!t||!n)&&Ia(n,t)>t.scrollTop+t.offsetHeight-120}};e.thread&&(f={attachments:e.thread.topic.attachments,title:e.thread.topic.content,timestamp:e.thread.topic.created_at,author:e.thread._threadAuthorParticipant,authorProfile:e.thread._threadAuthorProfile,mentions:e.thread.topic.mentions});var h=c.scrolledFarUp||re()(e,"messages.cursor.has_next");return r.a.createElement(r.a.Fragment,null,h&&r.a.createElement(Zo,{onJumpToRecent:function(){return Ae()(e.onJumpToRecent)&&e.onJumpToRecent(),p()},unreads:e.unreads}),r.a.createElement("ul",{className:Kc.a.list,ref:s,role:"log","aria-live":"polite",onScroll:d},e.loadingPrev&&r.a.createElement("li",null,r.a.createElement(q.h,{busy:!0})),!!e.thread&&r.a.createElement(Xo,Object.assign({},f,{roomId:e.roomId,onProfileClick:e.onProfileClick})),r.a.createElement(es.Provider,{value:_},r.a.createElement(au,{messages:e.messages,onDeleteMessage:e.onDeleteMessage,onProfileClick:e.onProfileClick,parentRoomId:e.parentRoomId,roomId:e.roomId,rootUrl:e.rootUrl,unreads:e.unreads,selectedMessageId:e.messageId,me:e.me})),e.loadingNext&&r.a.createElement("li",null,r.a.createElement(q.h,{busy:!0}))))};cu.defaultProps={messages:{messages:[],groupedMessages:[]},hasNextPage:!1,loadingPivot:!1,loadingPrev:!1,loadingNext:!1,onDeleteMessage:h.a,onNextPage:h.a,onPrevPage:h.a,onJumpToRecent:h.a,onUpdateLastVisited:h.a,rootUrl:"/"};var uu=cu,lu=n(129),du=n.n(lu),mu=n(227),pu=n.n(mu),fu=n(450),_u=n.n(fu),hu=n(49),vu=n.n(hu),Eu=function(e,t,n,a){var o,s,i,c,u="",l="",d="",m=new Date(Date.now()),p=_u()(new Date(t),m);switch(c=function(e,t,n){var a=pu()(n,t);return"unsubmitted"===e&&a||"failed"===e}(e,t,m),e){case"unsubmitted":if(c)o=_e("Project overdue"),s=r.a.createElement(Ne.Q,{size:"sm"}),u=_e("Submit Now"),l=_e("We know life happens, but you can still catch up!"),i=Ce()(vu.a.projectStatus,vu.a.redStatus),d=n;else{var f=p<8;o=_e("Project due in ".concat(p," ").concat(ct(p,"day"))),f?(s=r.a.createElement(Ne.Q,null),i=Ce()(vu.a.projectStatus,vu.a.orangeStatus)):(s=r.a.createElement(Ne.H,null),i=Ce()(vu.a.projectStatus,vu.a.blueStatus))}break;case"submitted":o=_e("Project submitted"),s=r.a.createElement(Ne.H,null),i=Ce()(vu.a.projectStatus,vu.a.blueStatus);break;case"failed":o=_e("Project requires changes"),s=r.a.createElement(Ne.J,null),u=_e("See Feedback"),l=_e("Here's another chance to try this. You've got this!"),i=Ce()(vu.a.projectStatus,vu.a.redStatus),d=a;break;case"completed":o=_e("Project meets specifications"),s=r.a.createElement(Ne.p,null),i=Ce()(vu.a.projectStatus,vu.a.greenStatus);break;default:o=_e("Project due in ".concat(p," ").concat(ct(p,"day"))),s=r.a.createElement(Ne.H,null),i=Ce()(vu.a.projectStatus,vu.a.blueStatus)}return{title:o,icon:s,statusStyles:i,showCallToActionButton:c,btnLabel:u,ctaSubHeading:l,href:d}},gu=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.projectState,n=e.dueDate,a=e.submissionUrl,o=e.feedbackUrl,s=Eu(t,n,a,o),i=s.title,c=s.icon,u=s.statusStyles,l=s.btnLabel,d=s.ctaSubHeading,m=s.href,p=s.showCallToActionButton;return r.a.createElement("div",{className:vu.a.container},r.a.createElement("div",{className:u},r.a.createElement("span",{className:vu.a.icon},c),r.a.createElement("span",{className:vu.a.message},r.a.createElement(q.m,{spacing:"none",size:"sm"},i),p&&r.a.createElement("span",{className:vu.a.cta},r.a.createElement(q.m,{size:"xs",spacing:"1x"},d),r.a.createElement("span",{className:vu.a.ctaBtn},r.a.createElement(q.a,{href:m,label:l,variant:"default",small:!0,external:!0}))))))}}]),t}(r.a.PureComponent),bu=n(233),Ou=n.n(bu),Su=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.mentorParticipants,n=e.homeUrl,a=e.roomId,o=e.loading;return r.a.createElement("div",{className:Ou.a.leaders},r.a.createElement("span",{className:Ou.a.mentorHeading},r.a.createElement(q.e,{size:"h6",spacing:"2x"},"Your Mentors")),r.a.createElement(q.h,{busy:o,size:"sm"},r.a.createElement("ul",{className:Ou.a.mentorParticipants},t&&t.map(function(e){var t=!!e.is_online;return r.a.createElement(oo,{participant:e,key:e.id,homeUrl:n,roomId:a,isOnline:t})}))))}}]),t}(r.a.PureComponent),Iu=n(451),yu=n.n(Iu),Tu=n(452),ju=n.n(Tu),Au=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={showEntireText:!1},n.handleEllipsisButtonClick=function(){n.setState(function(e){return{showEntireText:!e.showEntireText}})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.maxCharacters,a=e.expandButtonLabel,o=e.collapseButtonLabel,s=this.state.showEntireText,i=n||100,c=t.length>i,u=s?t:yu()(t,{length:n,separator:" "});return r.a.createElement(q.m,{spacing:"none",size:"sm"},u,c&&r.a.createElement("button",{onClick:this.handleEllipsisButtonClick,className:ju.a.expandBtn},r.a.createElement(q.m,{spacing:"none",size:"sm"},s?o:a)))}}]),t}(r.a.PureComponent);Au.defaultProps={maxCharacters:100,expandButtonLabel:"Read More",collapseButtonLabel:"Read Less"};var Ru=Au,Cu=n(453),Nu=n.n(Cu),ku=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.description;return e?r.a.createElement("div",{className:Nu.a.project},r.a.createElement(q.e,{size:"h6",spacing:"none"},"Project Description"),r.a.createElement(Ru,{text:e})):null}}]),t}(r.a.PureComponent),Lu=n(310),Pu=n.n(Lu),wu=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.submissionUrl,n=e.nanodegreeTagId,a=e.projectTagId,o=e.totalQuestions,s=e.rubricUrl,i=function(e,t){return le()(e)||le()(t)?"".concat(k.REACT_APP_KNOWLEDGE_HOME):"".concat(k.REACT_APP_KNOWLEDGE_HOME,"/?nanodegree=").concat(e,"&project=").concat(t,"&page=1&sort=SCORE")}(n,a),c="(".concat(o," ").concat(ct(o,"related question"),")");return r.a.createElement("div",{className:Pu.a.links},r.a.createElement(q.e,{size:"h6",spacing:"half"},"Helpful Links"),r.a.createElement(q.l,{type:"stack",size:"half"},r.a.createElement(q.l,{type:"inline",size:"half"},r.a.createElement(q.g,{external:!0,href:i,testID:"knowledge"},"Knowledge")),!!o&&r.a.createElement("span",{className:Pu.a.questions},r.a.createElement(q.m,{spacing:"none"},c))),t&&r.a.createElement(q.l,{type:"stack",size:"half"},r.a.createElement(q.g,{external:!0,href:t,testID:"submission"},"Project Submission")),s&&r.a.createElement(q.l,{type:"stack",size:"half"},r.a.createElement(q.g,{external:!0,href:s,testID:"rubric"},"Project Rubric")))}}]),t}(r.a.PureComponent),xu=500,Mu=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).participantListRef=void 0,n.throttledOnScroll=void 0,n.onScroll=function(){var e=n.participantListRef.current;if(e){var t=e.querySelectorAll("li"),a=Array.from(t)||[],r=To(a);if(r&&jo(r,e,xu)){var o=C()(a,r);n.props.onFetchMoreProfiles(o)}}},n.participantListRef=r.a.createRef(),n.throttledOnScroll=S()(n.onScroll,1e3),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.me,n=e.participants,a=e.homeUrl,o=e.isParticipantsLoading,s=e.room,i=e.roomLeaderParticipants,c=e.isThreadRoom,u=e.project,l=e.isRoomLeaderParticipantsLoading,d=e.starredMessages,m=void 0===d?[]:d,p=e.pinnedMessages,f=void 0===p?[]:p,_=re()(s,"room_summary"),h=re()(s,"room_type",""),v=re()(s,"room_id"),E=re()(s,"topic.room_id"),g=re()(s,"id")||E||v,b=i&&i.length,O=(!!_||!!u||!!b)&&!c,S=!!_&&"project"!==h,I="project"===h&&!!u,y=re()(u,"rubric_id"),T=re()(u,"knowledge.nanodegree_tag_id"),j=re()(u,"knowledge.nanodegree_tag_id"),A=re()(u,"knowledge.total_questions"),R=re()(u,"lesson_summary"),C=re()(u,"due_at"),N=re()(u,"project_state.state"),L=re()(u,"project_state.submissions"),P=function(e){if(!le()(e))return"".concat(k.REACT_APP_REVIEWS_HOME,"/#!/rubrics/").concat(e,"/start")}(y),w=function(e,t){if("failed"===e&&!le()(t))return t[t.length-1].url}(N,L),x=function(e){if(!le()(e))return"".concat(k.REACT_APP_REVIEWS_HOME,"/#!/rubrics/").concat(e,"/view")}(y);return r.a.createElement("div",{className:du.a.sidebar,onScroll:this.throttledOnScroll},O&&r.a.createElement("div",{className:du.a.channelMeta},r.a.createElement(q.e,{size:"h4",spacing:"2x"},"Channel Information"),r.a.createElement(mo,null)),S&&r.a.createElement("div",{className:du.a.channelSummary},r.a.createElement(q.e,{size:"h6",spacing:"1x"},"Purpose"),r.a.createElement(Bo,{content:_})),I&&C&&r.a.createElement(gu,{projectState:N,dueDate:C,submissionUrl:P,feedbackUrl:w}),I&&R&&r.a.createElement(ku,{description:R}),!!b&&i&&!c&&r.a.createElement(Su,{mentorParticipants:i,homeUrl:a,roomId:g,loading:l}),I&&r.a.createElement(wu,{submissionUrl:P,rubricUrl:x,nanodegreeTagId:T,projectTagId:j,totalQuestions:A}),f.length>0&&r.a.createElement("div",{className:du.a.messageAction},r.a.createElement(He,{title:r.a.createElement(q.a,{variant:"minimal",href:"#",icon:r.a.createElement(Ne.G,{size:"sm",color:"yellow"}),label:"".concat(f.length," Pinned Items")})},r.a.createElement(uu,{onProfileClick:function(){},me:t,roomId:v,messages:{messages:f,groupedMessages:f.map(function(e){return[[e]]})}}))),m.length>0&&r.a.createElement("div",{className:du.a.messageAction},r.a.createElement(He,{title:r.a.createElement(q.a,{variant:"minimal",href:"#",icon:r.a.createElement(Ne.N,{size:"sm",color:"orange"}),label:"".concat(m.length," Starred Items")})},r.a.createElement(uu,{onProfileClick:function(){},me:t,roomId:v,messages:{messages:m,groupedMessages:m.map(function(e){return[[e]]})}}))),r.a.createElement("div",{className:du.a.participants,ref:this.participantListRef},r.a.createElement(So,{participants:n,homeUrl:a,loading:o,roomId:g,showSidebarCloseOnParticipants:!O,scrollElement:this.participantListRef})))}}]),t}(r.a.PureComponent),Du=function(e){return re()(e,"meta.scope_payload.nd_key","")},Uu=Object(Tt.a)(Ct,Lt,Nt,function(e,t,n){return{conversations:e,profiles:t,messages:n}}),Fu=Object(Tt.a)(function(e,t){return re()(e,["conversations","byId",t])},Uu,function(e,t){if(!le()(e))return function(e,t){return Object(Xt.a)(e,ir,t)}(e,t)}),Gu=Object(Tt.a)(Fu,function(e){return Du(e)}),Bu=Object(Tt.a)(function(e){return re()(e,"conversations.stagedConversation",void 0)},function(e){return e}),Hu=Object(Tt.a)(function(e){return re()(e,["conversations","currentConversations"])},Uu,function(e,t){return me()(e)?{rooms:[]}:function(e,t){return Object(Xt.a)(e,cr,t)}(e,t)}),Vu=Ut("conversationsAsync"),zu={resolveAdditionalProfiles:Qr.resolveAdditionalProfiles,getPassedUsers:Vr.fetchPassedUsers,getRoomMeta:eo.getRoomMeta,getMessagesByAction:no.getMessagesByAction},Wu=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).fetchMoreProfiles=function(e){var t=n.props,a=t.getProfilesStatus,r=t.resolveAdditionalProfiles,o=t.room,s=t.roomId,i=t.threadId,c=t.conversationId||i||s;!xt(a)&&o&&c&&r(c,e)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.getRoomMeta,n=e.getMessagesByAction,a=e.roomId,r=e.threadId,o=e.conversationId||r||a;this.getPassedParticipants(),a&&t(a),o&&(n(o,"PIN"),n(o,"STAR"))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.roomId,a=t.threadId,r=t.roomLeaderParticipants,o=t.otherParticipants,s=t.getMessagesByAction,i=t.getRoomMeta,c=e.threadId,u=e.roomId,l=e.otherParticipants,d=e.roomLeaderParticipants,m=r.length+o.length,p=l.length+d.length;n===u&&m===p||this.getPassedParticipants(),n&&n!==u&&i(n),n&&n!==u?(s(n,"PIN"),s(n,"STAR")):n&&n===u&&!a&&c&&(s(n,"PIN"),s(n,"STAR"))}},{key:"getPassedParticipants",value:function(){var e=this.props,t=e.roomId,n=e.roomLeaderParticipants,a=e.otherParticipants,r=e.getPassedUsers,o=[].concat(Object(yt.a)(n),Object(yt.a)(a));t&&o.length&&r(t,cn(o))}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.otherParticipants,a=e.homeUrl,o=e.room,s=e.getProfilesStatus,i=e.project,c=e.roomLeaderParticipants,u=e.threadId,l=e.starredMessages,d=e.pinnedMessages;return o?r.a.createElement(Mu,{participants:n,roomLeaderParticipants:c,homeUrl:a,isParticipantsLoading:xt(s)&&!n.length,starredMessages:l,pinnedMessages:d,isRoomLeaderParticipantsLoading:xt(s)&&!!c&&!c.length,me:t,onFetchMoreProfiles:this.fetchMoreProfiles,room:o,isThreadRoom:!!u,project:i}):null}}]),t}(r.a.Component),Yu=Object(m.b)(function(e,t){var n,a=t.roomId,r=t.threadId,o=t.conversationId,s=o||r||a;n=r?Zs(e,r):o?Fu(e,o):Yr(e,a);var i=[];return r||o||(i=jn(e,s)),{roomLeaderParticipants:i,otherParticipants:r||o?Tn(e,s):An(e,s),room:n,me:Gt(e),pinnedMessages:fi(e,s,"PIN"),starredMessages:fi(e,s,"STAR"),getProfilesStatus:ea(e,"getProfiles"),project:Kr(e,r||a)}},zu)(Wu),qu=n(311),Ku=n.n(qu),Ju=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.nanodegree,t=e.title,n=e.projects,a=n?n.projects.length:0,o=n?n.completed_count:0,s=_e("".concat(o,"/").concat(a," passed"));return r.a.createElement("span",{className:Ku.a.nanodegree},r.a.createElement(Ne.F,{color:"cerulean",size:"sm"}),r.a.createElement("span",{className:Ku.a.info},r.a.createElement(q.m,{spacing:"none"},t),r.a.createElement(q.m,{size:"xs",spacing:"none"},s)))}}]),t}(r.a.PureComponent),Xu=n(234),Qu=n.n(Xu),$u=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.project,t=e.title,n="completed"===e.status;return r.a.createElement("li",{className:Qu.a.project},n?r.a.createElement("span",{className:Qu.a.check},r.a.createElement(Ne.p,{size:"sm",color:"teal"})):r.a.createElement("span",{className:Qu.a.circle},r.a.createElement(Ne.q,{size:"sm"})),r.a.createElement(q.m,{size:"sm",spacing:"half"},t))}}]),t}(r.a.PureComponent),Zu=n(454),el=n.n(Zu),tl=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.projects;return r.a.createElement("ul",{className:el.a.projectList},e&&e.map(function(e){return r.a.createElement($u,{project:e,key:e.id})}))}}]),t}(r.a.PureComponent),nl=n(235),al=n.n(nl),rl=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.nanodegrees;return r.a.createElement("ul",{className:al.a.nanodegreeList},e&&e.map(function(e){var t=e.projects,n=!me()(t)&&!le()(t.projects);return r.a.createElement("li",{key:e.id,className:al.a.nanodegree},n&&r.a.createElement(He,{title:r.a.createElement(Ju,{nanodegree:e})},r.a.createElement(tl,{projects:t.projects})),!n&&r.a.createElement("span",{className:al.a.marginBottom},r.a.createElement(Ju,{nanodegree:e})))}))}}]),t}(r.a.PureComponent),ol=n(157),sl=n.n(ol),il=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderGraduatedList",value:function(){var e=this.props.nanodegrees;return r.a.createElement("ul",{className:sl.a.nanodegreeList},e.map(function(e){return r.a.createElement("li",{key:e.id,className:sl.a.graduatedListItem},r.a.createElement(Ju,{nanodegree:e}))}))}},{key:"render",value:function(){var e,t=this.props,n=t.nanodegrees,a=t.isGraduatedNanodegreeList,o=t.hasEnrolledNanodegrees,s=t.hasGraduatedNanodegrees,i=_e(a?"Graduated":"Enrolled"),c=Ce()("",(e={},Object(ee.a)(e,sl.a.borderTop,a&&o),Object(ee.a)(e,sl.a.marginBottom,!a&&s),e));return r.a.createElement("div",{className:c},r.a.createElement("div",{className:sl.a.subheading},r.a.createElement(q.m,{size:"sm",spacing:"1x"},i)),!a&&n?r.a.createElement(rl,{nanodegrees:n}):this.renderGraduatedList())}}]),t}(r.a.PureComponent),cl=n(93),ul=n.n(cl),ll=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.answersCount,n=void 0===t?0:t,a=e.additionalProfileInfoPending,o=e.passedProjects,s=!a;return r.a.createElement("div",{className:ul.a.highlights},!s&&r.a.createElement("div",{className:ul.a.gridCenter},r.a.createElement(q.h,{size:"sm"})),s&&r.a.createElement("div",{"data-testid":"content",className:ul.a.statsWrapper},o>=0&&r.a.createElement("div",{"data-testid":"passed-projects",className:ul.a.stat},r.a.createElement("div",{className:ul.a.iconWrapper},r.a.createElement(Ne.I,{size:"sm",color:"white"})),r.a.createElement(q.e,{size:"h4",spacing:"none"},o),r.a.createElement("div",{className:ul.a.label},r.a.createElement(q.e,{size:"h6",spacing:"none"},_e("Projects passed")))),n>=0&&r.a.createElement("div",{"data-testid":"knowledge-answers",className:ul.a.stat},r.a.createElement("div",{className:ul.a.iconWrapper},r.a.createElement(Ne.j,{size:"sm",color:"white"})),r.a.createElement(q.e,{size:"h4",spacing:"none"},n),r.a.createElement("div",{className:ul.a.label},r.a.createElement(q.e,{size:"h6",spacing:"none"},_e("Knowledge answers"))))))}}]),t}(r.a.PureComponent),dl=n(52),ml=n.n(dl),pl=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,n=this.props,a=n.profile,o=n.homeUrl,s=n.roomId,i=n.me,c=n.myRoles,u=void 0===c?[]:c,l=n.knowledgeActivityStats.answers_count,d=void 0===l?0:l,m=n.graduatedNanodegrees,f=n.enrolledNanodegrees,_=n.totalPassedProjects,h=n.additionalProfileInfoPending,v=n.showBackArrow,E=void 0===v||v,g=i.id===(a?a.id:""),b=rn(void 0,a,s),O=b.role,S=b.bio,I=b.name,y=b.avatarProps,T=b.showLocation,j=b.locationDescription,A=(t=o)?t.split("?")[0]:"/",R=!(!m||!m.length),C=!(!f||!f.length),N=!R&&!C&&!h,k=u.length||"staff"!==O,L=!Se(o)&&!g&&"bot"!==O&&k,P=Ce()((e={},Object(ee.a)(e,ml.a.backLink,E),Object(ee.a)(e,ml.a.hidden,!E),e));return r.a.createElement(q.h,{busy:me()(a)},r.a.createElement("div",{className:ml.a.container},r.a.createElement("section",{className:ml.a.header},r.a.createElement(p.b,{to:o,className:P,"data-tst":"back-link"},r.a.createElement(Ne.b,{size:"sm",color:"slate"})),r.a.createElement("div",{className:ml.a.user},r.a.createElement("div",{className:ml.a.avatar},r.a.createElement(Vn,Object.assign({},y,{sizeSelection:"xl",size:72}))),r.a.createElement("div",{className:ml.a.info},r.a.createElement(q.e,{size:"h5",spacing:"none"},I),r.a.createElement("div",{className:ml.a.badge},r.a.createElement(la,{type:O})),T&&!!j&&r.a.createElement("div",{className:ml.a.location,"data-ref":"location"},r.a.createElement(Ne.P,{size:"sm",title:_e("Learning From")}),r.a.createElement(q.m,{spacing:"none",size:"sm"},j||_e("No location listed"))))),r.a.createElement(mo,{color:"slate"})),r.a.createElement("section",{className:ml.a.body},!!S&&r.a.createElement("div",{"data-ref":"bio",className:ml.a.bioSegment},r.a.createElement(q.m,{size:"sm",spacing:"none"},S)),g&&r.a.createElement("div",{className:ml.a.bodySegment},r.a.createElement(p.b,{to:"".concat(A,"?contextType=editProfile"),className:ml.a.button,"data-testid":"edit-link"},r.a.createElement("span",{className:ml.a.editIcon},r.a.createElement(Ne.u,{size:"sm"})),"Edit Profile")),L&&r.a.createElement("div",{className:ml.a.bodySegment,"data-ref":"dm"},r.a.createElement(Qc,{myId:i.id,profile:a,roomId:s})),r.a.createElement("div",{className:ml.a.bodySegment},r.a.createElement("div",{className:ml.a.highlightWrapper},r.a.createElement(ll,{answersCount:d,passedProjects:_,additionalProfileInfoPending:h}))),(C||R)&&r.a.createElement("div",{"data-ref":"nanodegrees",className:ml.a.bodySegment},r.a.createElement(q.e,{size:"h6",spacing:"1x"},_e("Nanodegrees")),C&&f&&r.a.createElement(il,{nanodegrees:f,isGraduatedNanodegreeList:!1,hasEnrolledNanodegrees:C,hasGraduatedNanodegrees:R}),R&&m&&r.a.createElement(il,{nanodegrees:m,isGraduatedNanodegreeList:!0,hasEnrolledNanodegrees:C,hasGraduatedNanodegrees:R})),N&&r.a.createElement("div",{className:ml.a.bodySegment},r.a.createElement(q.m,{color:"silver",size:"sm",align:"center"},"This user has no current enrollments")))))}}]),t}(r.a.Component);pl.defaultProps={showBackArrow:!0};var fl=pl,_l={getAdditionalProfileInfo:Qr.getAdditionalProfileInfo},hl=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.additionalProfileInfo;this.trackProfileView(),le()(e)&&this.getAdditionalProfileInfo()}},{key:"componentDidUpdate",value:function(e){var t=this.props.additionalProfileInfo,n=re()(e,"profile.id"),a=re()(this.props,"profile.id");n!==a&&a&&(this.trackProfileView(),le()(t)&&this.getAdditionalProfileInfo())}},{key:"trackProfileView",value:function(){var e=this.props.profile;e&&Pa.track(Ta.ViewProfile,{userId:e.id})}},{key:"getAdditionalProfileInfo",value:function(){var e=this.props,t=e.getAdditionalProfileInfo,n=e.participantId;n&&t(n)}},{key:"render",value:function(){var e=this.props,t=e.profile,n=e.homeUrl,a=e.roomId,o=e.conversationId,s=e.me,i=e.knowledgeActivityStats,c=e.totalPassedProjects,u=e.additionalProfileInfoAsyncStatus,l=e.graduatedNanodegrees,d=e.enrolledNanodegrees,m=e.location.pathname;return t?r.a.createElement(fl,{knowledgeActivityStats:i,profile:t,homeUrl:n,roomId:a||o,me:s,myRoles:s.roles,totalPassedProjects:c,additionalProfileInfoPending:xt(u),graduatedNanodegrees:l,enrolledNanodegrees:d,showBackArrow:"/threads"!==m}):null}}]),t}(r.a.PureComponent),vl=Object(A.g)(Object(m.b)(function(){var e=$n();return function(t,n){var a=n.participantId,r=void 0===a?"":a;return{knowledgeActivityStats:ta(t,r),profile:e(t,r),me:Gt(t),additionalProfileInfoAsyncStatus:ea(t,"getAdditionalProfileInfo"),totalPassedProjects:aa(t,r),additionalProfileInfo:na(t,r),graduatedNanodegrees:oa(t,r),enrolledNanodegrees:ra(t,r)}}},_l)(hl)),El=n(487),gl=["image/jpeg","image/jpg","image/png"],bl={fileTypeError:"Please upload a JPG or PNG.",fileSizeError:"Max file size is 1MB.",dimensionError:"Please upload a 120x120 image.",genericError:"Something went wrong. Try again."},Ol=n(158),Sl=n.n(Ol),Il=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={showAvatarMenu:!1},n.node=void 0,n.assignNode=function(e){n.node=e},n.hideAvatarMenu=function(){return n.setState({showAvatarMenu:!1})},n.handleClick=function(e){n.node&&n.node.contains(e.target)||n.hideAvatarMenu()},n.toggleShowAvatarMenu=function(){n.props.onClearPhotoError(),n.setState(function(e){return{showAvatarMenu:!e.showAvatarMenu}})},n.addFile=function(e){var t=e.target.files;n.props.onAddImage(t),e.target.value=null,n.hideAvatarMenu()},n.removeFile=function(){n.props.onRemoveImage(),n.hideAvatarMenu()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("click",this.handleClick,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick,!1)}},{key:"render",value:function(){var e=this.state.showAvatarMenu;return r.a.createElement("div",{ref:this.assignNode},r.a.createElement(q.p,null,r.a.createElement("label",{htmlFor:"editPhoto"},"Profile Photo (Optional)")),r.a.createElement("button",{type:"button",id:"editPhoto",className:Sl.a.editPhoto,onClick:this.toggleShowAvatarMenu},r.a.createElement(Ne.u,{size:"sm"})),e&&r.a.createElement("div",{className:Sl.a.avatarMenu},r.a.createElement("ul",{className:Sl.a.avatarList},r.a.createElement("li",null,r.a.createElement("label",{htmlFor:"upload",className:Sl.a.uploadImage},r.a.createElement(q.e,{size:"h6",color:"slate"},"Upload New Image"))),r.a.createElement("li",null,r.a.createElement("button",{onClick:this.removeFile,className:Sl.a.removeImage},r.a.createElement(q.e,{size:"h6",color:"slate"},"Remove Image"))))),r.a.createElement(q.p,null,r.a.createElement("input",{id:"upload",type:"file",onChange:this.addFile,onBlur:this.hideAvatarMenu,name:"Upload New Image",accept:gl.join(", ")})))}}]),t}(r.a.Component),yl={getBase64:function(e){return new Promise(function(t,n){var a=new FileReader;a.onloadend=function(){t(a.result)},a.onerror=function(e){n(e)},a.readAsDataURL(e)})},getImagePreview:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t[0],e.prev=1,e.next=4,yl.getBase64(n);case 4:return a=e.sent,(r=new Image).onload=function(){if(r.width<120||r.height<120)throw Error(bl.dimensionError)},r.src=a,e.abrupt("return",a);case 11:throw e.prev=11,e.t0=e.catch(1),Error(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,11]])}));return function(t){return e.apply(this,arguments)}}(),verifyPhotoFile:function(e){var t=e[0];if(!gl.includes(t.type))throw new Error(bl.fileTypeError);if(t.size>1048576)throw new Error(bl.fileSizeError)}},Tl=yl,jl={loadExternalScript:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return new Promise(function(a,r){var o=function(){return a((t||h.a)())},s=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=e,i.onreadystatechange=o,i.onload=o,s.appendChild(i),setTimeout(function(){r(new Error("Timed out loading script: ".concat(e)))},n)})}},Al=n(486),Rl=function(e){var t=e.url,n=e.method,a=e.data,r=e.opts,o=r.params,s=r.headers,i=Object(ns.a)(r,["params","headers"]),c=Object(N.a)({method:n,timeout:1e4,headers:Object(N.a)({"Content-Type":"application/json",Accept:"application/json"},s)},i);if(o&&(-1===t.indexOf("?")&&(t+="?"),t+=ne.a.stringify(o)),t.includes("udacity.com")){var u=U.a.getJWT();u&&(c.headers.Authorization="Bearer ".concat(u))}if(a){var l="application/json"===c.headers["Content-Type"]?JSON.stringify(a):a;c.body=l}return fetch(t,c).then(function(e){if(e.ok)return e.json();!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=re()(e,"status");if((401===t||419===t)&&!kl())throw Cl(),new Nl({message:"Authentication Error"});if(me()(e)){var n=re()(e,"type"),a=re()(e,"url");throw new Nl({message:"ApiError - undefined response at ".concat(n," ").concat(a),response:e})}var r=re()(e,"data.message")||re()(e,"data.error")||re()(e,"statusText");throw new Nl({message:r,status:t,response:e})}(e)}).then(function(e){var t=re()(e,"errors",null);return t?new Nl(t):e}).catch(function(e){throw new Nl(e)})},Cl=function(){"development"!==k.REACT_APP_ENV&&(U.a.signOut(),U.a.authenticate({env:k.REACT_APP_ENV,returnUrl:window.location.href}))},Nl=function(e){function t(e){var n,a=e.message,r=e.status,o=e.response;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,a))).name=void 0,n.status=void 0,n.response=void 0,n.name="ApiError",n.status=r,n.response=o,n}return Object(d.a)(t,e),t}(Object(Al.a)(Error)),kl=function(){return!("undefined"!==typeof window&&window.document)},Ll=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n){var a,r=arguments;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>2&&void 0!==r[2]?r[2]:{},e.prev=1,e.next=4,Rl({url:t+n,method:"get",opts:a});case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Nl(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),Pl=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n,a){var r,o=arguments;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>3&&void 0!==o[3]?o[3]:{},e.prev=1,e.next=4,Rl({url:t+n,method:"post",data:a,opts:r});case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Nl(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t,n,a){return e.apply(this,arguments)}}(),wl=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n){var a,r=arguments;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>2&&void 0!==r[2]?r[2]:{},e.prev=1,e.next=4,Rl({url:t+n,method:"delete",opts:a});case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Nl(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}(),xl=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n){var a,r,o,s=arguments;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:{},e.prev=1,e.next=4,Rl({url:"".concat(t,"/graphql"),method:"post",data:n,opts:a});case 4:if(r=e.sent,!((o=r.errors)&&o.length>0)){e.next=10;break}throw new Nl({message:o[0].message,status:o[0].status});case 10:return e.abrupt("return",r);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),new Nl(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,13]])}));return function(t,n){return e.apply(this,arguments)}}(),Ml=function(e){return xl(k.REACT_APP_PROFILES_API_URL,e)},Dl={fetchProfileLocations:function(e){var t=function(e){return'query LocationsQuery {\n    locations(search: "'.concat(e,'") {\n      description: formatted_address\n      location_id: place_id\n      }\n  }')}(e);return Ml({query:t}).then(function(e){return re()(e,"data.locations",[])})},fetchLocation:function(e){var t=function(e){return'query LocationQuery {\n    location(place_id: "'.concat(e,'") {\n      address_components {\n        long_name\n        short_name\n        type\n      }\n      location_id: place_id\n    }\n  }\n  ')}(e);return Ml({query:t}).then(function(e){return re()(e,"data.location",null)})}},Ul=n(455),Fl=n.n(Ul),Gl={blacklist:["BY","CD","CI","CU","IR","IQ","KP","LR","MM","SD","SY","ZW","AL","BA","BG","HR","MK","ME","RO","RS","SI","XK"],whitelist:["AF","AX","DZ","AS","AD","AO","AI","AQ","AG","AR","AM","AW","AU","AT","AZ","BS","BH","BD","BB","BE","BZ","BJ","BM","BT","BO","BQ","BW","BV","BR","IO","BN","BF","BI","KH","CM","CA","CV","KY","CF","TD","CL","CN","CX","CC","CO","KM","CG","CK","CR","CW","CY","CZ","DK","DJ","DM","DO","EC","EG","SV","GQ","ER","EE","ET","FK","FO","FJ","FI","FR","GF","PF","TF","GA","GM","GE","DE","GH","GI","GR","GL","GD","GP","GU","GT","GG","GN","GW","GY","HT","HM","VA","HN","HK","HU","IS","IN","ID","IE","IM","IL","IT","JM","JP","JE","JO","KZ","KE","KI","KR","KW","KG","LA","LV","LB","LS","LY","LI","LT","LU","MO","MG","MW","MY","MV","ML","MT","MH","MQ","MR","MU","YT","MX","FM","MD","MC","MN","MS","MA","MZ","NA","NR","NP","NL","NC","NZ","NI","NE","NG","NU","NF","MP","NO","OM","PK","PW","PS","PA","PG","PY","PE","PH","PN","PL","PT","PR","QA","RE","RU","RW","BL","SH","KN","LC","MF","PM","VC","WS","SM","ST","SA","SN","SC","SL","SG","SX","SK","SB","SO","ZA","GS","SS","ES","LK","SR","SJ","SZ","SE","CH","TW","TJ","TZ","TH","TL","TG","TK","TO","TT","TN","TR","TM","TC","TV","UG","UA","AE","GB","US","UM","UY","UZ","VU","VE","VN","VG","VI","WF","EH","YE","ZM"]};var Bl=function(){var e={drivers:{google:{_loadService:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jl,a=e.drivers.google._getApiKey(),r=function(){return re()(t,"google.maps.places.AutocompleteService",null)},o=r();if(o)return Promise.resolve(o);if(le()(a))return Promise.reject(new Error("Missing Google Places API key"));var s="https://maps.googleapis.com/maps/api/js?key=".concat(a,"&libraries=places");return n.loadExternalScript(s,r)},_getApiKey:function(){return k.REACT_APP_GOOGLE_MAPS_API_KEY},search:function(t,n){return n=Object(N.a)({},{types:["(cities)"]},{options:n}),e.drivers.google._loadService().then(function(e){if(e)return new e;throw new Error("Google Places API failed to load")}).then(function(e){return new Promise(function(a,r){e.getPlacePredictions(Object(N.a)({input:t},n),function(e,t){switch(t){case"OK":case"ZERO_RESULTS":a(e||[]);break;default:r(new Error("Google Places API failed with status code: ".concat(t)))}})})}).then(function(t){return Promise.all(t).then(function(t){var n=t.map(function(t){return e.drivers.profiles.decode(t.place_id).then(function(e){return{prediction:t,location:e}})});return Promise.all(n).then(function(e){return e.filter(function(e){var t=e.prediction,n=e.location,a=(n?n.address_components:[]).some(function(e){return"country"===e.type&&Gl.whitelist.includes(e.short_name)});return!a&&window.location.search.includes("debug")&&console.warn("Omitting;",t.description),a}).map(function(e){var t=e.prediction,n=void 0===t?{}:t;return Object(N.a)({},n,{location_id:n.place_id})})})})})}},profiles:{decode:function(e){return Dl.fetchLocation(e)},search:function(e){return Dl.fetchProfileLocations(e)}}},autocomplete:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.drivers;return a.google.search(t,n).catch(function(e){return a.profiles.search(t)}).catch(function(e){return[]})},decode:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.drivers.profiles).decode(t)},format:function(e,t){Fl()(e)&&(e={});var n,a=e?e.address_components:[];return void 0===t&&e.description?e.description:le()(a)?null:a.map(function(e){return"country"===e.type&&"US"===e.short_name&&(n=!0),e}).map(function(e){return n?a.length>2?"country"===e.type?null:t?e[t]:e.short_name||e.long_name:e.long_name:"administrative_area_level_1"===e.type?null:e.long_name}).filter(function(e){return!le()(e)}).join(", ")}};return e}(),Hl=n(79),Vl=n.n(Hl),zl={location_id:null,description:""},Wl=function(){return _e("No options found.")},Yl=function(e){return e.description},ql=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={userLocation:n.props.me.location||zl,photoUrl:n.props.me.photo_url||null,photoBase64:null,photoError:null,isLoadingLocations:!1,locationPredictions:[],locationError:null},n.locationSectionRef=void 0,n.profileFormRef=void 0,n.locationInputTimeout=void 0,n.debouncedFetchLocations=void 0,n.clearPhotoError=function(){n.state.photoError&&n.setState({photoError:null})},n.setPhotoError=function(e){n.setState({photoError:e})},n.previewPhotoFile=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var a;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.clearPhotoError(),e.prev=1,Tl.verifyPhotoFile(t),e.next=5,Tl.getImagePreview(t);case 5:a=e.sent,n.setState({photoBase64:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n.setPhotoError(e.t0.message);case 12:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),n.removeImage=function(){return n.setState({photoBase64:"",photoUrl:null})},n.fetchLocations=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var a;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],le()(t)){e.next=11;break}return e.prev=2,e.next=5,Bl.autocomplete(t);case 5:a=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.setLocationError();case 11:n.setState({isLoadingLocations:!1,locationPredictions:a});case 12:case"end":return e.stop()}},e,null,[[2,8]])}));return function(t){return e.apply(this,arguments)}}(),n.handleLocationInputChange=function(e){if(!e)return n.setState({isLoadingLocations:!1,locationPredictions:[]}),void n.debouncedFetchLocations.cancel();n.setState({isLoadingLocations:!0}),n.clearLocationError(),n.debouncedFetchLocations(e)},n.clearLocationError=function(){n.state.locationError&&n.setState({locationError:null})},n.setLocationError=function(){return n.setState({locationError:bl.genericError})},n.setLocation=function(e){var t=e.location_id,a=e.description;return n.setState({userLocation:{location_id:t,description:a}})},n.onSubmit=function(){var e=n.state,t=e.userLocation,a=e.photoBase64;n.props.submit(t.location_id,a)},n.assignLocationSectionRef=function(e){n.locationSectionRef=e},n.assignProfileFormRef=function(e){n.profileFormRef=e},n.scrollToLocationSection=function(){n.locationSectionRef&&(n.locationInputTimeout=setTimeout(function(){return n.locationSectionRef.scrollIntoView(!0)},425))},n.scrollToTop=function(){clearTimeout(n.locationInputTimeout),n.profileFormRef&&n.profileFormRef.scrollIntoView()},n.debouncedFetchLocations=Ro()(n.fetchLocations,150),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.locationInputTimeout)}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.homeUrl,a=e.roomId,o=rn(t,void 0,a),s=o.avatarProps,i=o.name,c=this.state,u=c.userLocation,l=c.photoUrl,d=c.photoBase64,m=c.photoError,f=c.locationPredictions,_=c.isLoadingLocations,h=c.locationError,v=h?"reactSelectError":"reactSelect";return r.a.createElement("form",{className:Vl.a.profileForm,ref:this.assignProfileFormRef},r.a.createElement(q.e,{size:"h3",spacing:"3x"},"Edit Profile"),r.a.createElement("section",{className:Vl.a.photoSection},r.a.createElement("div",{className:Vl.a.label},r.a.createElement(q.e,{size:"h5",spacing:"none"},"Profile Photo"),r.a.createElement(q.m,{size:"sm"},"\xa0(Optional)")),r.a.createElement("div",{className:Vl.a.profilePhoto},r.a.createElement("div",{className:Vl.a.profilePhotoLeft},r.a.createElement(Vn,Object.assign({},s,{hasPreviewError:!!m||void 0,photoUrl:d||l||void 0,size:72,sizeSelection:"lg"})),r.a.createElement(Il,{onAddImage:this.previewPhotoFile,onClearPhotoError:this.clearPhotoError,onRemoveImage:this.removeImage})),r.a.createElement("div",{className:Vl.a.profilePhotoRight},r.a.createElement(q.e,{size:"h5",spacing:"half"},i),r.a.createElement(q.m,{size:"sm"},"JPG or PNG, 120px by 120px, max size of 1MB"))),m&&r.a.createElement("div",{className:Vl.a.error},r.a.createElement(Ne.Q,{color:"red",size:"sm"}),r.a.createElement(q.m,{size:"xs"},m))),r.a.createElement("section",{className:Vl.a.locationSection,ref:this.assignLocationSectionRef},r.a.createElement("label",{htmlFor:"editLocation",className:Vl.a.label},r.a.createElement(q.e,{size:"h5",spacing:"none"},"Studying From"),r.a.createElement(q.m,{size:"sm"},"\xa0(Optional)")),r.a.createElement(El.a,{autoBlur:!0,id:"userLocation",isLoading:_,labelKey:"description",name:"location",className:"reactSelectContainer",classNamePrefix:v,arrowRenderer:null,onChange:this.setLocation,onInputChange:this.handleLocationInputChange,options:f||[],getOptionLabel:Yl,placeholder:_e("Enter your city"),noResultsText:_e("Type to search"),value:u,valueKey:"location_id",noOptionsMessage:Wl,onFocus:this.scrollToLocationSection,onBlur:this.scrollToTop}),h&&r.a.createElement("div",{className:Vl.a.error},r.a.createElement(Ne.Q,{color:"red",size:"sm"}),r.a.createElement(q.m,{size:"xs"},h))),r.a.createElement("section",{className:Vl.a.buttons},r.a.createElement(q.a,{label:"Save Changes",variant:"primary",onClick:this.onSubmit,full:!0}),r.a.createElement(p.b,{to:"".concat(n,"?contextType=room")},"Cancel")))}}]),t}(r.a.Component),Kl={fetchProfile:M.fetchProfile,updateProfile:M.updateProfile},Jl=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).submit=function(e,t){var a=n.props,r=a.history,o=a.homeUrl,s=a.me;try{n.props.updateProfile({location_id:e,photo_base64:t}),r.push(ye(o,s.id))}catch(i){console.error("Something went wrong! Please try again.")}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchProfile()}},{key:"render",value:function(){var e=this.props,t=e.me,n=e.homeUrl,a=e.roomId;return r.a.createElement(ql,{me:t,submit:this.submit,homeUrl:n,roomId:a})}}]),t}(r.a.Component),Xl=Object(A.g)(Object(m.b)(function(e){return{me:Gt(e)}},Kl)(Jl)),Ql=["room","profile","editProfile"],$l=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderContent",value:function(e){var t=this.props.location,n=t&&t.pathname||"",a=function(e){var t,n,a,r,o=Object(A.f)(e,{path:"/rooms/:roomId/new/:messageId",exact:!0});if(o){var s=o.params;t=s.roomId,a=s.messageId}var i=Object(A.f)(e,{path:"/:roomType(rooms|threads)/:roomId/:threadId?",exact:!0});if(i){var c=i.params;t=c.roomId,n=c.threadId}var u=Object(A.f)(e,{path:"/conversations/:conversationId",exact:!0});u&&(r=u.params.conversationId);return{conversationId:r,roomId:t,threadId:n,messageId:a}}(t.pathname),o=a.conversationId,s=a.roomId,i=a.threadId;switch(e.contextType){case"profile":var c=e.profileId;return c?(n+="?contextType=room",r.a.createElement(vl,{participantId:c,homeUrl:n,roomId:s,conversationId:o})):null;case"editProfile":return r.a.createElement(Xl,{homeUrl:n,roomId:s});case"room":return r.a.createElement(Yu,{roomId:s,homeUrl:n,threadId:i,conversationId:o});default:return null}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.location,a=ne.a.parse(n.search),o=a.contextType;if(!(o&&Ql.includes(o)))return null;var s=this.renderContent(a);return s?r.a.createElement("aside",{className:t},s):null}}]),t}(r.a.PureComponent);$l.defaultProps={className:""};var Zl=Object(A.g)($l),ed=7340032;function td(e){if(e){var t=e.lastModified,n=e.name,a=e.size;return"pendingFile:".concat(Object(ai.sha256)([n,t,a].join("")))}return"pendingFile:placeholder"}function nd(e){if(!e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(Number(e/Math.pow(1024,t)).toPrecision(2)," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][t])}var ad=n(159),rd=n.n(ad);var od=function(e){var t=e.isDraggingFile,n=function(e){var t=Object(a.useState)(!1),n=Object(ba.a)(t,2),r=n[0],o=n[1];return{isDraggingOver:r,handleDragEnter:function(e){e.preventDefault(),o(!0)},handleDragLeave:function(e){e.preventDefault(),o(!1)},handleDrop:function(t){if(t.preventDefault(),o(!1),se()(window,"File")&&se()(window,"FileReader")){var n=re()(t,"dataTransfer.files.0",{type:"unsupported",size:0});e.handleDrop(n)}}}}(e),o=n.isDraggingOver,s=n.handleDragEnter,i=n.handleDragLeave,c=n.handleDrop,u=Ce()(rd.a.dropTargetPlaceholder,Object(ee.a)({},rd.a.dropTargetActive,o));return t?r.a.createElement("div",{className:rd.a.dropTargetWrapper},r.a.createElement("div",{className:rd.a.fileDropTrigger,onDragEnter:s,onDragLeave:i,onDrop:c}),r.a.createElement("div",{className:u},r.a.createElement("div",null,r.a.createElement("div",{className:rd.a.iconWrapper},r.a.createElement(Ne.t,{size:"lg",color:"cerulean"})),r.a.createElement(q.e,{size:"h5",spacing:"1x"},"Drag and drop an image"),r.a.createElement(q.m,{spacing:"none",size:"sm"},"JPG, PNG, or GIF"),r.a.createElement(q.m,{size:"sm"},"Max file size: ",nd(ed))))):null},sd=n(459),id=n.n(sd),cd=function(e){return e.getIn(["files"])},ud=Object(Tt.a)(cd,function(e){return e.getIn(["pendingFiles"])||{}}),ld=Object(Tt.a)(ud,function(e){return id()(e,function(e,t,n){var a=t.status,r=t.progress;return"pending"===a?[].concat(Object(yt.a)(e),[{fileIdentifier:n,status:a,progress:r}]):e},[])}),dd=Object(Tt.a)(cd,function(e){return re()(e,["ui","isDraggingFile"],!1)}),md={postImageMessage:no.postImageMessage},pd=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleDrop=function(e){if(Ae()(n.props.handleDrop))return n.props.handleDrop({file:e});var t=n.props,a=t.roomId,r=void 0===a?"":a,o=t.messageId;(0,t.postImageMessage)(e,r,o)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.isDraggingFile;return r.a.createElement(od,{handleDrop:this.handleDrop,isDraggingFile:e})}}]),t}(r.a.Component),fd=Object(m.b)(function(e){return{isDraggingFile:dd(e)}},md)(pd),_d=Object(N.a)({},P("GET_THREAD","THREADS"),P("GET_NEW_THREAD","THREADS"),P("GET_THREADS","THREADS"),P("GET_NEXT_THREADS","THREADS"),{ADD_NEW_THREAD_ID:"".concat("THREADS","/ADD_NEW_THREAD_ID")}),hd={getThread:function(e,t){return L(_d.GET_THREAD_START,{roomId:e,messageId:t})},resetGetThread:function(){return L(_d.GET_THREAD_READY,void 0)},getNewThread:function(e,t){return L(_d.GET_NEW_THREAD_START,{roomId:e,messageId:t})},resetGetNewThread:function(){return L(_d.GET_NEW_THREAD_READY,void 0)},addNewThreadId:function(e){return L(_d.ADD_NEW_THREAD_ID,{threadId:e})},getThreads:function(){return L(_d.GET_THREADS_START,void 0)},getNextThreads:function(e){return L(_d.GET_NEXT_THREADS_START,{cursor:e})}},vd=n(460),Ed=n.n(vd),gd=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.thread,n=e.rootUrl,a=e.roomTitle,o=e.onProfileClick,s=e.me,i=Object(N.a)({},t.topic,{_participant:t._threadAuthorParticipant,_profile:t._threadAuthorProfile});return r.a.createElement("div",{className:Ed.a.wrapper},r.a.createElement(q.e,{size:"h6",as:"h3",spacing:"2x"},a),r.a.createElement(Lc,{rootUrl:n,message:i,me:s,onProfileClick:o,roomId:t.thread_id}))}}]),t}(r.a.PureComponent),bd=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleProfileClick=function(e){var t=n.props,a=t.history,r=t.rootUrl;a.push(ye(r,e))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.thread,n=e.rootUrl,a=e.roomTitle,o=e.me;return r.a.createElement(gd,{thread:t,rootUrl:n,roomTitle:a,onProfileClick:this.handleProfileClick,me:o})}}]),t}(r.a.Component),Od=Object(A.g)(Object(m.b)(function(e,t){var n=t.roomId;return{roomTitle:qr(e,n),me:Gt(e)}})(bd)),Sd=n(461),Id=n.n(Sd);function yd(e){var t=e.toggleNavSidebar;return e.isMobile?r.a.createElement("button",{onClick:t,className:Id.a.navToggle},r.a.createElement(Ne.D,{size:"md",color:"silver",title:"Nav Menu"})):null}var Td=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(f.LayoutConsumer,null,function(e){var t=e.toggleSidebar,n=e.isMobile;return r.a.createElement(yd,{toggleNavSidebar:t,isMobile:n})})}}]),t}(r.a.Component),jd=n(462),Ad=n.n(jd),Rd=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:Ad.a.emptyThreads},r.a.createElement(q.e,{size:"h1",as:"h2"},"No threads"),r.a.createElement(q.m,null,"You\u2019re not part of any threads yet! Reply to a message to create a new thread."))}}]),t}(r.a.PureComponent),Cd=n(183),Nd=n.n(Cd),kd=250,Ld=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).threadListRef=void 0,n.debouncedScroll=void 0,n.state={scrolledNearBottom:!1},n.handleScroll=function(e){var t=e.target,a=n.state.scrolledNearBottom,r=n.props.onNextPage,o=t.scrollHeight-t.offsetHeight-t.scrollTop<kd;o&&!a&&(n.setState({scrolledNearBottom:!0}),r()),!o&&a&&n.setState({scrolledNearBottom:!1})},n.threadListRef=r.a.createRef(),n.debouncedScroll=Ro()(n.handleScroll,100),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){this.debouncedScroll.cancel()}},{key:"render",value:function(){var e=this.props,t=e.threads,n=e.rootUrl,a=e.loading,o=e.loadingNext,s=t&&t.length,i=!a&&!!s,c=!a&&!s;return r.a.createElement("div",{className:Nd.a.threadListContainer},r.a.createElement("header",{className:Nd.a.header},r.a.createElement(Td,null),r.a.createElement("span",null,r.a.createElement(q.e,{size:"h5"},"All Threads"))),a&&r.a.createElement(q.h,{busy:!0}),i&&r.a.createElement("ul",{className:Nd.a.threadList,ref:this.threadListRef,onScroll:this.handleScroll},t.map(function(e){return e?r.a.createElement("li",{key:e.thread_id,className:Nd.a.threadListItem},r.a.createElement(Od,{thread:e,rootUrl:n,roomId:e.topic.room_id})):null})),o&&r.a.createElement(q.h,{busy:!0}),c&&r.a.createElement(Rd,null))}}]),t}(r.a.PureComponent);Ld.defaultProps={onNextPage:h.a};var Pd=function(e){return r.a.createElement(f.LayoutConsumer,null,function(t){var n=t.isMobile;return r.a.createElement(Ld,Object(N.a)({},e,{isMobile:n}))})},wd={getThreads:hd.getThreads,getNextThreads:hd.getNextThreads},xd=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleNextPage=function(){var e=n.props,t=e.getNextThreads,a=e.threads,r=re()(a,"cursor")||void 0;r&&r.has_next&&r.next&&t(r.next)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.getThreads)()}},{key:"render",value:function(){var e=this.props,t=e.threads,n=e.rootUrl,a=e.getThreadsStatus,o=e.getNextThreadsStatus,s=re()(t,"threads")||[];return r.a.createElement(Pd,{loading:xt(a),loadingNext:xt(o),rootUrl:n,threads:s,onNextPage:this.handleNextPage})}}]),t}(r.a.Component),Md=Object(m.b)(function(e){return{threads:Xs(e),getThreadsStatus:ei(e,"getThreads"),getNextThreadsStatus:ei(e,"getNextThreads")}},wd)(xd),Dd={postMessage:no.postMessage,getParticipants:bo.getParticipants,searchParticipantsToMention:bo.searchParticipantsToMention,resetSearchParticipantsToMention:bo.resetSearchParticipantsToMention,postImageMessage:no.postImageMessage},Ud=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).onSubmit=function(e,t){var a=n.props,r=a.roomId,o=a.postMessage,s=a.messageId,i=a.onSubmit,c={content:e,mentions:t};return Ae()(i)?i(c):o(c,r,s)},n.searchParticipants=function(e){var t=n.props,a=t.parentRoomId,r=t.roomId;(0,t.searchParticipantsToMention)(a||r,e)},n.onSelectMention=function(){var e=n.props,t=e.parentRoomId,a=e.roomId;(0,e.resetSearchParticipantsToMention)(t||a)},n.uploadFile=function(e){var t=n.props,a=t.messageId,r=t.roomId,o=t.onSubmit;if(Ae()(o))return o({file:e});n.props.postImageMessage(e,r,a)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roomId,n=e.me,a=e.searchedParticipants,o=e.isSocketConnected,s=e.allowMentions,i=e.requireManualFocus;return r.a.createElement(Oc,{onSubmit:this.onSubmit,onSearch:this.searchParticipants,onSelectMention:this.onSelectMention,me:n,roomId:t,participants:a,isSocketConnected:o,onAddFile:this.uploadFile,allowMentions:s,requireManualFocus:i},function(e){return r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"Submit"),r.a.createElement("button",{type:"button",onClick:e},"Cancel"))})}}]),t}(r.a.Component);Ud.defaultProps={allowMentions:!0};var Fd=Object(m.b)(function(e,t){var n=t.parentRoomId,a=t.roomId;return{me:Gt(e),searchedParticipants:In(e,n||a),isSocketConnected:Tc(e)}},Dd)(function(e){return r.a.createElement(f.LayoutConsumer,null,function(t){var n=t.isMobile;return r.a.createElement(Ud,Object(N.a)({},e,{requireManualFocus:n}))})}),Gd=n(184),Bd=n.n(Gd),Hd=n(463),Vd=n.n(Hd);var zd=function(){var e=co(),t=e.isContextSidebarOpen,n=e.toggleContextSidebar;return t?null:r.a.createElement("div",{className:Vd.a.button},r.a.createElement(q.o,{content:"Show channel details",direction:"bottom",trigger:r.a.createElement(q.a,{label:"Show channel details",variant:"minimal",onClick:n,icon:r.a.createElement(Ne.y,{color:"silver"}),iconOnly:!0,small:!0})}))},Wd=n(185),Yd=n.n(Wd),qd=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.backUrl,n=e.parentRoomTitle;return r.a.createElement("header",{className:Yd.a.threadHeader},r.a.createElement("div",{className:Yd.a.titleContainer},t&&r.a.createElement(p.b,{to:t},r.a.createElement(Ne.b,{size:"sm",spacing:"none"})),r.a.createElement("span",{className:Yd.a.title},r.a.createElement(q.e,{size:"h5",spacing:"none"},_e("Thread"),"\xa0"),r.a.createElement(q.m,{color:"silver"}," in ".concat(n)))),r.a.createElement("div",{className:Yd.a.headerRight},r.a.createElement(zd,null)))}}]),t}(r.a.PureComponent),Kd=n(464),Jd=n.n(Kd),Xd=Object(N.a)({},P("UPLOAD_IMAGE","FILES"),{UPLOAD_IMAGE_PROGRESS:"".concat("FILES","/UPLOAD_IMAGE_PROGRESS"),UPLOAD_IMAGE_CANCELLED:"".concat("FILES","/UPLOAD_IMAGE_CANCELLED"),CANCEL_UPLOAD_SAGA:"".concat("FILES","/CANCEL_UPLOAD_SAGA"),FILE_DRAG_START:"".concat("FILES","/DRAG_START"),FILE_DRAG_END:"".concat("FILES","/DRAG_END")}),Qd={cancelFileUpload:function(e){return L(Xd.CANCEL_UPLOAD_SAGA,{fileIdentifierString:e})},imageUploadStart:function(e,t,n){var a=td(e);return L(Xd.UPLOAD_IMAGE_START,{file:e,fileIdentifierString:a,roomId:t,messageId:n})},imageUploadPending:function(e){return L(Xd.UPLOAD_IMAGE_PENDING,{fileIdentifierString:e})},imageUploadProgress:function(e,t){return L(Xd.UPLOAD_IMAGE_PROGRESS,{progress:t,fileIdentifierString:e})},imageUploadSuccess:function(e,t){return L(Xd.UPLOAD_IMAGE_FULFILLED,{fileIdentifierString:e,attachments:t})},imageUploadCancelled:function(e){return L(Xd.UPLOAD_IMAGE_CANCELLED,{fileIdentifierString:e})},imageUploadRejected:function(e,t){return L(Xd.UPLOAD_IMAGE_REJECTED,{fileIdentifierString:e,error:t})},fileDragStart:function(){return L(Xd.FILE_DRAG_START)},fileDragEnd:function(){return L(Xd.FILE_DRAG_END)}},$d=n(130),Zd=n.n($d);var em=function(e){var t=e.progress,n=void 0===t?0:t,a=e.handleUploadCancel;return r.a.createElement("div",{className:Zd.a.progressWrapper},r.a.createElement("div",{className:Zd.a.progressBar},r.a.createElement("div",{className:Zd.a.progressBarProgress,style:{width:"".concat(n,"%")}}),r.a.createElement("div",{className:Zd.a.progressContentGrid},r.a.createElement("div",null,_e(n<100?"Uploading file":"Processing file"),"\u2026"))),r.a.createElement("div",{className:Zd.a.cancelButtonWrapper},r.a.createElement("button",{"data-testid":"cancel-button",className:Zd.a.cancelButton,onClick:a},_e("Cancel"))))},tm={cancelFileUpload:Qd.cancelFileUpload};var nm=Object(m.b)(function(e){return{pendingFiles:ld(e)}},tm)(function(e){var t=e.pendingFiles,n=e.cancelFileUpload;function a(e,t){t.preventDefault(),n(e)}return t.length?r.a.createElement(r.a.Fragment,null,t.map(function(e){return r.a.createElement(em,{key:e.fileIdentifier,progress:e.progress,handleUploadCancel:Jd()(a,e.fileIdentifier)})})):null}),am={getNewThread:hd.getNewThread,resetGetNewThread:hd.resetGetNewThread},rm=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={message:""},n.handleProfileClick=function(e){var t=n.props,a=t.history,r=t.rootUrl;a.push("".concat(r,"?contextType=profile&profileId=").concat(e))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.getNewThread,n=e.match.params;t(n.roomId,n.messageId)}},{key:"componentDidUpdate",value:function(e){this.checkForRepliedAndRedirect(e)}},{key:"componentWillUnmount",value:function(){this.props.resetGetNewThread()}},{key:"checkForRepliedAndRedirect",value:function(e){var t=this.props,n=t.replyStatus,a=t.messageId;Mt(n)&&re()(n,"meta.messageId")===a&&this.replacePathWithNewThread()}},{key:"replacePathWithNewThread",value:function(){var e=this.props,t=e.replyStatus,n=e.messageId,a=e.history,r=e.location,o=re()(t,"meta.response.room_id"),s="".concat(r.pathname).concat(r.search).replace("/new/".concat(n),"/".concat(o));a.replace(s)}},{key:"render",value:function(){var e=this.props,t=e.roomId,n=e.rootUrl,a=e.me,o=e.messageId,s=e.message,i=e.messages,c=e.thread,u=e.roomTitle;if(!s)return null;if(!c||!c.topic)return null;var l=function(e,t,n){var a=e.replace("/".concat(t,"/new/").concat(n),"/".concat(t)).split("?")[0]+"?contextType=room";return a=a.concat("&messageId=".concat(n))}(n,t,o),d=c&&c.topic.room_id;return r.a.createElement("div",{className:Bd.a.newThread},r.a.createElement(qd,{backUrl:l,parentRoomTitle:u}),r.a.createElement(nm,null),r.a.createElement("div",{className:Bd.a.subHeader},r.a.createElement(Xo,{attachments:s.attachments,title:s.content||"",timestamp:s.created_at,author:s._participant,mentions:s.mentions,roomId:t,onProfileClick:this.handleProfileClick})),r.a.createElement("div",{className:Bd.a.messageList},r.a.createElement(uu,{onProfileClick:this.handleProfileClick,messages:i||{},messageId:String(o),roomId:String(o),me:a})),r.a.createElement("div",{className:Bd.a.chatInputWrapper},r.a.createElement(Fd,{roomId:t,messageId:o,parentRoomId:d})))}}]),t}(r.a.PureComponent),om=Object(A.g)(Object(m.b)(function(e,t){var n=t.messageId,a=t.roomId;return{me:Gt(e),message:Oi(e,n),messages:Ei(e,n),replyStatus:Si(e,"replyToMessage"),thread:Qs(e),roomTitle:qr(e,a)}},am)(rm)),sm=n(237),im=n.n(sm),cm=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.participantProfiles,n=e.me,a=e.conversation,o=e.parentRoomId,s=e.title,i=n&&n.id,c=It(t,i),u=c.length>0,l=a?a.id:void 0,d=re()(a,"meta.scope_payload.mentor"),m=d&&n&&d===n.id,p=re()(c,"[0].id","");return r.a.createElement("header",{className:im.a.header},r.a.createElement("div",{className:im.a.headerLeft},r.a.createElement(Td,null),r.a.createElement("span",{className:im.a.titleContent},u&&r.a.createElement(q.l,{type:"inline",size:"1x"},r.a.createElement(ts,{userId:p},r.a.createElement(sa,{userId:p,roomId:o||l||""}))),r.a.createElement(q.e,{size:"h5",as:"h2",align:"left",spacing:"none"},ut(c)),m&&r.a.createElement(r.a.Fragment,null,r.a.createElement(la,{type:"mentee"}),"\xa0",r.a.createElement(q.m,{color:"silver"},"in ",s)))),!!l&&r.a.createElement(zd,null))}}]),t}(r.a.PureComponent),um=n(465),lm=n.n(um),dm=n(312),mm=n.n(dm),pm=function(e){return r.a.createElement("div",{className:mm.a.wrapper},r.a.createElement("img",{className:mm.a.image,src:lm.a,alt:"direct message illustration"}),r.a.createElement(q.m,{size:"sm",color:"silver"},"This is the beginning of your chat",e.isMentee?" with your mentee":"",e.isMentor?" with your mentor":"","."," ",r.a.createElement("span",{role:"img","aria-label":"wave emoji"},"\ud83d\udc4b")," ","Say hello!"))},fm=n(186),_m=n.n(fm),hm={getConversation:wr.fetchConversationRoom,createConversationAndSubmit:wr.createConversationAndSubmit,createStagedConversation:wr.createStagedConversation,resetCreateStagedConversation:wr.resetCreateStagedConversation,resetCreateConversation:wr.resetCreateConversationRoom},vm=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={roomId:void 0},n.checkFetchConversationStatus=function(e){var t=n.props,a=t.createStagedConversation,r=t.fetchConversationStatus,o=t.stagedConversation,s=n.props.match.params.userIds,i=re()(r,"payload.result"),c=i!==re()(e.fetchConversationStatus,"payload.result");if(i&&Mt(r)&&c)return n.redirectToExistingConversation(i);!o&&Mt(r)&&a(pt(s))},n.checkCreateConversationStatus=function(e){var t=n.props.createConversationStatus;if(!Mt(e.createConversationStatus)&&Mt(t)){var a=re()(t,"payload.result");return n.redirectToExistingConversation(a)}},n.handleProfileClick=function(e){var t=n.props,a=t.history,r=t.rootUrl;a.push("".concat(r,"?contextType=profile&profileId=").concat(e))},n.submit=function(e){var t=n.props,a=t.match.params.userIds,r=t.createConversationAndSubmit,o=n.state.roomId;r(pt(a),e,o)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.match.params.userIds,n=e.history;this.props.getConversation(void 0,pt(t));var a=ne.a.parse(n.location.search);a.roomId&&this.setState({roomId:a.roomId})}},{key:"componentDidUpdate",value:function(e){this.checkFetchConversationStatus(e),this.checkCreateConversationStatus(e)}},{key:"componentWillUnmount",value:function(){this.props.resetCreateStagedConversation(),this.props.resetCreateConversation()}},{key:"redirectToExistingConversation",value:function(e){this.props.history.replace(Oe(e))}},{key:"render",value:function(){var e=this.props,t=e.match.params.userIds,n=e.me,a=e.stagedConversation,o=e.messages,s=void 0===o?{}:o,i=e.renderFileDropOverlay,c=this.state.roomId;return r.a.createElement(r.a.Fragment,null,!!i&&i(this.submit),r.a.createElement("div",{className:_m.a.newConversation},r.a.createElement(cm,{participantProfiles:a?a.profiles:[],parentRoomId:c||"",me:n}),r.a.createElement(nm,null),le()(s)?r.a.createElement("div",{className:_m.a.empty},r.a.createElement(pm,null)):r.a.createElement("div",{className:_m.a.messageList},r.a.createElement(uu,{onProfileClick:this.handleProfileClick,messages:s,roomId:t,me:n})),r.a.createElement("div",{className:_m.a.chatInputWrapper},r.a.createElement(Fd,{roomId:t,parentRoomId:a&&a.id,onSubmit:this.submit,allowMentions:!1}))))}}]),t}(r.a.PureComponent),Em=Object(A.g)(Object(m.b)(function(e){return{me:Gt(e),fetchConversationStatus:Vu(e,"fetchConversationRoom"),createConversationStatus:Vu(e,"createConversationRoom"),stagedConversation:Bu(e)}},hm)(vm)),gm=n(466),bm=n.n(gm),Om=n(313),Sm=n.n(Om),Im=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.checkForRoomsAndRedirect()}},{key:"componentDidUpdate",value:function(){this.checkForRoomsAndRedirect()}},{key:"checkForRoomsAndRedirect",value:function(){var e=this.props,t=e.lobby,n=e.history,a=e.me,r=Ue.get("last-visited",a.id);if(r)n.push(r);else{var o=function(e){var t=[].concat(Object(yt.a)(e.community_groups),Object(yt.a)(e.mentored_groups));return re()(t,[0,"rooms",0,"room_id"],void 0)}(t);o&&n.push(be(o))}}},{key:"render",value:function(){var e=this.props,t=e.isMobile,n=e.toggleSidebar;return r.a.createElement("div",{className:Sm.a.emptyLobby},r.a.createElement("img",{className:Sm.a.image,src:bm.a,alt:"missing content ghost illustration"}),r.a.createElement(q.e,{size:"h1",as:"h2"},"Welcome to Student Hub!"),r.a.createElement(q.m,null,"Select a room to get started."),t&&r.a.createElement(q.a,{label:"Check out rooms",variant:"primary",onClick:n}))}}]),t}(r.a.PureComponent);var ym=Object(A.g)(Object(m.b)(function(e){return{lobby:br(e),me:Gt(e)}})(function(e){return r.a.createElement(f.LayoutConsumer,null,function(t){var n=t.toggleSidebar,a=t.isMobile;return r.a.createElement(Im,Object(N.a)({},e,{toggleSidebar:n,isMobile:a}))})})),Tm=n(228),jm=n.n(Tm),Am=n(314),Rm=n.n(Am),Cm=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:Rm.a.errorNotFound},r.a.createElement("img",{className:Rm.a.image,src:jm.a,alt:_e("Page not found ghost")}),r.a.createElement(q.e,{size:"h1",as:"h2"},"404 Error"),r.a.createElement(q.m,null,_e("Sorry, we can't seem to find the page you are looking for.")),r.a.createElement(p.b,{to:"/"},r.a.createElement(q.a,{label:_e("Return To Student Hub"),variant:"primary"})))}}]),t}(r.a.PureComponent),Nm=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;Object(i.a)(this,e),this.faviconElement=void 0,this.defaultTitle=void 0,this.timer=void 0,this.faviconElement=t.getElementById("favicon")||null,this.defaultTitle="Chat - Udacity",this.timer=null}return Object(c.a)(e,[{key:"updateFavicon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if(this.faviconElement)switch(e){case"notification":this.faviconElement.href="/favicon-notification.ico";break;default:this.faviconElement.href="/favicon.ico"}}},{key:"blinkTitle",value:function(e){var t=this;this._clearTimer();this.timer=window.setInterval(function(){document.title=document.title===e?t.defaultTitle:e},2e3)}},{key:"_clearTimer",value:function(){null!=this.timer&&(window.clearInterval(this.timer),this.timer=null)}},{key:"clearBlink",value:function(){this._clearTimer(),document.title=this.defaultTitle}}]),e}()),km=n(131),Lm=n.n(km),Pm=n(94),wm=n.n(Pm),xm=function(e){var t,n=e.conversation.profiles,a=e.me&&e.me.id,o=It(n,a),s=o.length>0,i=rn(void 0,o[0],e.conversation.id).name,c=re()(e,"conversation.summary.last_message",{updated_at:null,last_message:"",user_id:"",content_preview:"No messages have been sent yet",attachments:null}),u=re()(c,"updated_at"),l=u?qe()(u,"ddd MMM D, YYYY"):"";if(Dc()(u)&&(l=qe()(u,"h:mma")),!c.content_preview&&c.attachments){var d=c.user_id===a?"You":i;t="".concat(d," shared an image")}var m=re()(e,"conversation.meta.scope_payload.mentor"),f=m&&m===e.me.id;return r.a.createElement("div",{className:wm.a.conversation},r.a.createElement(p.b,{to:Oe(e.conversation.id)},r.a.createElement("div",{className:wm.a.inner},s&&r.a.createElement("div",{className:wm.a.avatar},r.a.createElement(sa,{userId:o[0].id,roomId:e.conversation.id})),r.a.createElement("div",{className:wm.a.content},r.a.createElement("div",{className:wm.a.messageTop},r.a.createElement(q.m,{spacing:"none"},r.a.createElement("strong",null,i)),f&&r.a.createElement(la,{type:"mentee"}),"\xa0",r.a.createElement(q.m,{spacing:"none",size:"sm",color:"silver"},l)),r.a.createElement("div",{className:wm.a.preview},!t&&r.a.createElement(q.m,{spacing:"none",size:"sm"},c.content_preview),!!t&&r.a.createElement("span",{className:wm.a.imageContentPreview},r.a.createElement(q.m,{spacing:"none",size:"xs"},t)))),r.a.createElement("div",null,"archived"===e.conversation.status&&e.onUnarchive&&r.a.createElement(q.o,{"data-tst":"unarchive",content:"Add to sidebar",direction:"top",trigger:r.a.createElement("span",{className:wm.a.unarchive},r.a.createElement(q.a,{label:"Add to sidebar",variant:"minimal",onClick:function(t){t.preventDefault(),Ae()(e.onUnarchive)&&e.onUnarchive(e.conversation.id)},icon:r.a.createElement(Ne.h,{color:"silver"}),iconOnly:!0}))}),r.a.createElement("div",{className:wm.a.notification},!!e.unreadsCount&&r.a.createElement(Pe,{mentionsCount:e.unreadsCount}))))))},Mm=n(467),Dm=n.n(Mm),Um=function(e){var t=e.conversations.rooms;return r.a.createElement("div",null,!e.isLoading&&!t.length&&r.a.createElement(q.m,{"data-tst":"empty"},"You have no direct messages. You can start one now by going to a classmate's profile."),r.a.createElement("div",{className:Dm.a.inner},r.a.createElement(q.h,{busy:e.isLoading,size:"lg"},t.map(function(t){var n=re()(e.unreadsRooms,[t.id,"unread_count"])||0;return r.a.createElement(xm,{key:t.id,conversation:t,me:e.me,unreadsCount:n,onUnarchive:e.onUnarchive})}))))},Fm=n(187),Gm=n.n(Fm),Bm=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).nextPage=function(){n.props.nextPage()},n.previousPage=function(){n.props.previousPage()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.shouldShowNext,n=e.shouldShowPrevious,a=e.page,o=e.totalPages,s=e.isLoading;return r.a.createElement("footer",{className:Gm.a["pagination-wrapper"]},r.a.createElement("div",{className:Gm.a["previous-page-button"]},r.a.createElement(q.a,{variant:"minimal",label:_e("Back"),onClick:this.previousPage,"data-ref":"back-button",disabled:!n||s,icon:r.a.createElement(Ne.b,null),small:!0})),r.a.createElement("div",{className:Gm.a["pagination-text-wrapper"]},r.a.createElement(q.m,null,a," of ",o)),r.a.createElement("div",{className:Gm.a["next-page-button"]},r.a.createElement(q.a,{variant:"minimal",label:_e("Next"),onClick:this.nextPage,"data-ref":"next-button",disabled:!t||s,icon:r.a.createElement(Ne.c,null),iconAlign:"right",small:!0})))}}]),t}(r.a.PureComponent),Hm={fetchConversations:wr.fetchConversations,unarchiveConversation:wr.unarchiveConversation},Vm=Object(A.g)(Object(m.b)(function(e){return{conversations:Hu(e),me:Gt(e),unreadsRooms:Rr(e),fetchConversationsStatus:Vu(e,"fetchConversations")}},Hm)(function(e){var t=ne.a.parse(e.location.search).page,n=Object(a.useState)(t?Number(t):1),o=Object(ba.a)(n,2),s=o[0],i=o[1];Object(a.useEffect)(function(){e.fetchConversations(s),m(s)},[s]);var c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=Object(a.useMemo)(function(){var a=Math.ceil(re()(e,"total",0)/n);return{totalPages:a,shouldShowNext:t<a,shouldShowPrevious:t>1}},[t,e,n]);return{totalPages:r.totalPages,shouldShowNext:r.shouldShowNext,shouldShowPrevious:r.shouldShowPrevious}}(e.conversations.cursor,s),u=c.totalPages,l=c.shouldShowNext,d=c.shouldShowPrevious,m=function(t){var n=e.location.pathname;e.history.replace("".concat(n,"?page=").concat(t))},p=xt(e.fetchConversationsStatus)||!Mt(e.fetchConversationsStatus);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Um,{conversations:e.conversations,me:e.me,unreadsRooms:e.unreadsRooms,isLoading:p,onUnarchive:function(t){e.unarchiveConversation(t)}}),u>1&&r.a.createElement(Bm,{previousPage:function(){i(s<=1?1:s-1)},nextPage:function(){i(s+1)},shouldShowNext:l,shouldShowPrevious:d,page:s,totalPages:u,isLoading:!1}))})),zm=n(315),Wm=n.n(zm),Ym=function(e){return r.a.createElement("div",{className:Wm.a.conversations},r.a.createElement("div",{className:Wm.a.innerContent},r.a.createElement(q.e,{size:"h3",as:"h2",spacing:"2x"},"Your Messages"),r.a.createElement(Vm,null)))},qm=n(468),Km=n.n(qm),Jm={deleteMessage:no.deleteMessage,getPrevMessages:no.getPrevMessages,getNextMessages:no.getNextMessages,updateLastVisited:eo.updateLastVisited,updateLastVisitedNow:eo.updateLastVisitedNow,getMessages:no.getMessages,resetGetMessages:no.resetGetMessages},Xm=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={selectedMessageId:void 0},n.handleDeleteMessage=function(e,t){n.props.deleteMessage(String(e),t)},n.handleProfileClick=function(e){var t=n.props,a=t.history,r=t.rootUrl;a.push("".concat(r,"?contextType=profile&profileId=").concat(e))},n.handleNextPage=function(){var e=n.props,t=e.messages,a=e.getNextMessages;if(re()(t,"cursor.has_next")){var r=Number(re()(t,"cursor.next"));if(!r||n.isFetchingMessages())return;n.clearSelectedMessage(),a(n.getRoomId(),r)}},n.handlePrevPage=function(){var e=n.props,t=e.messages,a=e.getPrevMessages;if(re()(t,"cursor.has_prev")){var r=Number(re()(t,"cursor.prev"));if(!r||n.isFetchingMessages())return;n.clearSelectedMessage(),a(n.getRoomId(),r)}},n.isFetchingMessages=function(){return xt(n.props.getNextMessagesStatus)||xt(n.props.getPivotMessagesStatus)||xt(n.props.getPrevMessagesStatus)||xt(n.props.getMessagesStatus)},n.handleUpdateLastVisited=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=n.props,a=t.updateLastVisited,r=t.updateLastVisitedNow,o=t.unreads,s=n.getRoomId();if(s)return e?o&&o.last_visited&&pu()(e,o.last_visited)?a(s,e):void 0:r(s)},n.handleJumpToRecent=function(){var e=n.getRoomId();e&&(n.resetGetMessages(),n.props.getMessages(e),n.clearSelectedMessage())},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.checkAndSetSelectedMessage()}},{key:"componentDidUpdate",value:function(e){this.getRoomId()!==this.getRoomId(e)&&(this.checkAndSetSelectedMessage(),this.resetGetMessages())}},{key:"componentWillUnmount",value:function(){this.resetGetMessages()}},{key:"getRoomId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return re()(e.thread,"thread_id")||re()(e.room,"room_id")||re()(e.conversation,"id")||""}},{key:"resetGetMessages",value:function(){var e=this.getRoomId();e&&this.props.resetGetMessages(e)}},{key:"checkAndSetSelectedMessage",value:function(){var e=this.props.location,t=ne.a.parse(e.search);t.selectedMessageId?this.setState({selectedMessageId:t.selectedMessageId}):t.messageId&&this.setState({selectedMessageId:t.messageId})}},{key:"clearSelectedMessage",value:function(){var e=this.props.history,t=ne.a.parse(e.location.search),n=ne.a.stringify(Vs()(t,"selectedMessageId"));e.replace({pathname:e.location.pathname,search:n?"?".concat(n):void 0}),this.setState({selectedMessageId:void 0})}},{key:"render",value:function(){var e=this.props,t=e.messages,n=e.me,a=e.rootUrl,o=e.getPrevMessagesStatus,s=e.getNextMessagesStatus,i=e.getPivotMessagesStatus,c=e.parentRoomId,u=e.thread,l=e.unreads,d=this.state.selectedMessageId,m=re()(this.props,"match.params.roomId")||re()(this.props,"match.params.conversationId")||"";if((!t||!t.messages.length)&&this.isFetchingMessages())return r.a.createElement("div",{className:Km.a.loading},r.a.createElement(q.h,null));var p=re()(t,"cursor.has_next",!1),f=re()(i,"meta.nextMessageId",void 0);return r.a.createElement(uu,{hasNextPage:p,loadingNext:xt(s),loadingPrev:xt(o),loadingPivot:xt(i),pivotMessageId:f,me:n,messages:t,unreads:l,onDeleteMessage:this.handleDeleteMessage,onProfileClick:this.handleProfileClick,onPrevPage:this.handlePrevPage,onNextPage:this.handleNextPage,onUpdateLastVisited:this.handleUpdateLastVisited,parentRoomId:c,roomId:m,rootUrl:a,messageId:d,thread:u,onJumpToRecent:this.handleJumpToRecent})}}]),t}(r.a.PureComponent),Qm=Object(A.g)(Object(m.b)(function(e,t){var n=re()(t.thread,"thread_id")||re()(t.room,"room_id")||re()(t.conversation,"id")||"";return{getMessagesStatus:Si(e,"getMessages"),getPrevMessagesStatus:Si(e,"getPrevMessages"),getNextMessagesStatus:Si(e,"getNextMessages"),getPivotMessagesStatus:Si(e,"getPivotMessages"),me:Gt(e),messages:Ei(e,n)}},Jm)(Xm)),$m=n(188),Zm=n.n($m),ep=Object(N.a)({},P("GET_NANODEGREE","NANODEGREES")),tp={getNanodegree:function(e){return L(ep.GET_NANODEGREE_START,{ndKey:e})}},np=(Object(Tt.a)(function(e,t){return e.nanodegrees[t]},function(e){return re()(e,"title","")}),Object(Tt.a)(function(e){return e.nanodegrees},Gu,function(e,t){return t?re()(e,[t,"title"]):""})),ap={fetchNanodegree:tp.getNanodegree},rp=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleProfileClick=function(e){var t=n.props,a=t.history,r=t.rootUrl;a.push("".concat(r,"?contextType=profile&profileId=").concat(e))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.enterConversation()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.conversationId,a=t.conversation;e.conversationId!==n&&this.enterConversation(),!e.conversation&&a&&this.showOtherParticipantProfile()}},{key:"enterConversation",value:function(){var e=this.props,t=e.conversation,n=e.fetchNanodegree,a=e.title;t&&!a&&"personal-mentorship"===function(e){return re()(e,"meta.type")}(t)&&n(Du(t));this.showOtherParticipantProfile()}},{key:"showOtherParticipantProfile",value:function(){var e=this.props.me,t=re()(this.props,"conversation.profiles",[]),n=e&&e.id||"",a=It(t,n);a.length&&this.handleProfileClick(a[0].id)}},{key:"render",value:function(){var e=this.props,t=e.conversation,n=e.rootUrl,a=e.conversationId,o=e.me,s=e.messages,i=e.roomUnreads,c=e.getMessagesStatus,u=e.title,l=void 0===u?"":u;if(!t)return r.a.createElement("div",{className:Zm.a.loading},r.a.createElement(q.h,null));var d=s&&s.messages.length>0,m=re()(t,"meta.scope_payload.mentor"),p=re()(t,"meta.scope_payload.student"),f=m&&o&&m===o.id,_=p&&o&&p===o.id;return r.a.createElement("div",{className:Zm.a.conversation},r.a.createElement(cm,{participantProfiles:t.profiles||[],me:o,conversation:t,title:l}),r.a.createElement(nm,null),r.a.createElement("div",{className:Zm.a.messageList},d&&r.a.createElement(Qm,{rootUrl:n,conversation:t,unreads:i}),!d&&Mt(c)&&r.a.createElement(pm,{isMentee:f,isMentor:_})),r.a.createElement("div",{className:Zm.a.chatInputWrapper},r.a.createElement(Fd,{roomId:a,allowMentions:!1})))}}]),t}(r.a.Component),op=Object(A.g)(Object(m.b)(function(e,t){var n=t.conversationId;return{conversation:Fu(e,n),messages:Ei(e,n),roomUnreads:Cr(e,n),me:Gt(e),getMessagesStatus:Si(e,"getMessages"),title:np(e,n)}},ap)(rp)),sp=n(238),ip=n.n(sp),cp={getPassedUsers:Vr.fetchPassedUsers},up=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={message:""},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getPassedParticipants()}},{key:"componentDidUpdate",value:function(e){var t=this.props.participants,n=e.participants;t.length===n.length||this.getPassedParticipants()}},{key:"getPassedParticipants",value:function(){var e=this.props,t=e.roomId,n=e.participants,a=e.parentRoom,r=e.getPassedUsers,o=re()(a,"room_id",t);o&&!le()(n)&&r(o,cn(n))}},{key:"render",value:function(){var e=this.props,t=e.thread,n=e.rootUrl,a=e.roomId,o=e.parentRoomId,s=e.parentRoom,i=e.unreads;if(!t)return null;var c=function(e,t,n,a){var r="";return function(e){return e.includes("/threads/")}(e)?"".concat(e.split("/threads")[0],"/threads"):(n&&(r=e.replace("/".concat(n,"/").concat(t),"/".concat(n)).split("?")[0]+"?contextType=room",a&&(r=r.concat("&messageId=".concat(a)))),r)}(n,a,o,t.topic.message_id),u=s?s.room_title:"";return r.a.createElement("div",{className:ip.a.room},r.a.createElement(qd,{parentRoomTitle:u,backUrl:c}),r.a.createElement(nm,null),r.a.createElement("div",{className:ip.a.messageList},r.a.createElement(Qm,{rootUrl:n,thread:t,parentRoomId:o,unreads:i})),r.a.createElement("div",{className:ip.a.chatInputWrapper},r.a.createElement(Fd,{roomId:t.thread_id,parentRoomId:o})))}}]),t}(r.a.Component),lp=Object(A.g)(Object(m.b)(function(e,t){var n=t.parentRoomId,a=t.match.params.threadId;return{participants:Tn(e,a),thread:Zs(e,a),parentRoom:Yr(e,n),unreads:Cr(e,a)}},cp)(up)),dp=n(239),mp=n.n(dp),pp=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.backUrl,a=e.ndTitle,o=e.isMobile;return r.a.createElement("header",{className:mp.a.header},r.a.createElement("div",{className:mp.a.headerLeft},r.a.createElement(Td,null),n&&r.a.createElement(p.b,{to:n},"Cancel"),r.a.createElement("span",null,o&&!!a&&r.a.createElement(q.m,{size:"sm",spacing:"none",color:"silver"},dt(a)),r.a.createElement(q.e,{size:"h5",as:"h2",align:"left"},dt(t)))),r.a.createElement("div",{className:mp.a.headerRight},r.a.createElement(zd,null)))}}]),t}(r.a.PureComponent);var fp,_p=function(e){return r.a.createElement(f.LayoutConsumer,null,function(t){var n=t.isMobile;return r.a.createElement(pp,Object(N.a)({},e,{isMobile:n}))})},hp=n(189),vp=n.n(hp),Ep=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.room,n=e.rootUrl,a=e.roomUnreads,o=e.ndTitle;if(!t)return r.a.createElement("div",{className:vp.a.loading},r.a.createElement(q.h,null));var s=t.room_title;return r.a.createElement("div",{className:vp.a.room},r.a.createElement(_p,{title:s,ndTitle:o}),r.a.createElement(nm,null),r.a.createElement("div",{className:vp.a.messageList},r.a.createElement(Qm,{rootUrl:n,room:t,unreads:a})),r.a.createElement("div",{className:vp.a.chatInputWrapper},r.a.createElement(Fd,{roomId:t.room_id})))}}]),t}(r.a.Component),gp=Object(m.b)(function(e,t){var n=t.roomId;return{room:Yr(e,n),roomUnreads:Cr(e,n),ndTitle:Sr(e,n)}})(Ep);!function(e){e.SUCCESS="SUCCESS-ALERT",e.ERROR="ERROR-ALERT"}(fp||(fp={}));var bp={addAlert:Ha.addAlert,getConversation:wr.fetchConversationRoom,getRoom:eo.getRoom,getThread:hd.getThread,resetGetRoom:eo.resetGetRoom,resetGetThread:hd.resetGetThread,resetGetConversation:wr.resetFetchConversationRoom},Op=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.enterRoom(this.props.roomId)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.roomId,a=t.resetGetRoom;e.roomId!==n&&(a(),this.leaveRoom(e.roomId),this.enterRoom(n)),this.checkForErrorsAndRedirect(e)}},{key:"componentWillUnmount",value:function(){this.resetGetRoom(),this.leaveRoom(this.props.roomId)}},{key:"checkForErrorsAndRedirect",value:function(e){var t=this.props,n=t.addAlert,a=t.getConversationStatus,r=t.getRoomStatus,o=t.getThreadStatus,s=Dt(a)&&!Dt(e.getConversationStatus),i=Dt(r)&&!Dt(e.getRoomStatus),c=Dt(o)&&!Dt(e.getThreadStatus);(s||i||c)&&(n(fp.ERROR,"Room not found. Redirecting to a different room."),this.redirectToFirstRoom())}},{key:"redirectToFirstRoom",value:function(){var e,t=this.props,n=t.firstRoomId,a=t.history;n&&a.push(ge(e=n)?Oe(e):be(e))}},{key:"enterRoom",value:function(e){this.getRoomWithOptionalMessageId(),Pa.track(Ta.EnterRoom,{roomId:e})}},{key:"leaveRoom",value:function(e){Pa.track(Ta.LeaveRoom,{roomId:e})}},{key:"getRoomWithOptionalMessageId",value:function(){var e=ne.a.parse(this.props.location.search).messageId;e?(this.getRoom(parseInt(e,10)),this.replaceMessageIdParam()):this.getRoom()}},{key:"getRoom",value:function(e){var t=this.props,n=t.roomType,a=t.roomId,r=t.getConversation,o=t.getRoom,s=t.getThread;switch(n){case"conversation":r(a,void 0,e);break;case"thread":s(a,e);break;default:o(a,e)}}},{key:"resetGetRoom",value:function(){var e=this.props,t=e.roomType,n=e.resetGetRoom,a=e.resetGetConversation,r=e.resetGetThread;switch(t){case"conversation":a();break;case"thread":r();break;default:n()}}},{key:"replaceMessageIdParam",value:function(){var e=this.props,t=e.location,n=e.history,a=ne.a.parse(t.search),r=ne.a.stringify(Object(N.a)({},Vs()(a,"messageId"),{selectedMessageId:a.messageId}));n.replace({pathname:n.location.pathname,search:r?"?".concat(r):void 0})}},{key:"render",value:function(){var e=this.props,t=e.roomType,n=e.roomId,a=e.rootUrl,o=e.parentRoomId;switch(t){case"room":return r.a.createElement(r.a.Fragment,null,r.a.createElement(fd,{roomId:n}),r.a.createElement(gp,{roomId:n,rootUrl:a}));case"thread":return r.a.createElement(r.a.Fragment,null,r.a.createElement(fd,{roomId:n}),r.a.createElement(lp,{roomId:n,parentRoomId:o,rootUrl:a}));case"conversation":return r.a.createElement(r.a.Fragment,null,r.a.createElement(fd,{roomId:n}),r.a.createElement(op,{conversationId:n,rootUrl:a}))}return null}}]),t}(r.a.Component),Sp=Object(A.g)(Object(m.b)(function(e){return{firstRoomId:Tr(e),getConversationStatus:Vu(e,"fetchConversationRoom"),getThreadStatus:ei(e,"getThread"),getRoomStatus:Jr(e,"getRoom")}},bp)(Op)),Ip={initSocket:Br.initSocket,closeSocket:Br.closeSocket,fetchPendingRatings:Vr.fetchPendingRatings},yp=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).handleFavicon=function(){var e=n.props.hasAnyUnreads?"notification":"default";Nm.updateFavicon(e)},n.renderConversation=function(e){var t=e.match,n=t.params,a=t.url;return r.a.createElement(Sp,{roomId:n.conversationId,rootUrl:a,roomType:"conversation"})},n.renderEmptyLobbyScene=function(){return r.a.createElement(ym,null)},n.isMobile=function(){return n.props.isContextSidebarOpen&&T.isWindowTabletSize()},n.toggleSidebar=function(e){n.isMobile()&&n.props.toggleContextSidebar(e)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.initLobby(),this.handleFavicon()}},{key:"componentDidUpdate",value:function(e){e.hasAnyUnreads!==this.props.hasAnyUnreads&&this.handleFavicon()}},{key:"componentWillUnmount",value:function(){this.handleFavicon()}},{key:"initLobby",value:function(){var e=this.props,t=e.me,n=e.closeSocket,a=e.initSocket,r=e.fetchPendingRatings,o=e.lobby;n(),me()(o)||(a(t.id),r(),this.handleFavicon())}},{key:"renderNewConversation",value:function(e){var t=e.match;t.params,t.url;return r.a.createElement(Em,{rootUrl:"/conversations",renderFileDropOverlay:function(e){return r.a.createElement(fd,{handleDrop:e})}})}},{key:"renderRoom",value:function(e){var t=e.match,n=t.params.roomId,a=t.url;return r.a.createElement(Sp,{roomId:n,rootUrl:a,roomType:"room"})}},{key:"renderThread",value:function(e){var t=e.match,n=t.params,a=t.url,o=n.threadId,s=n.threadId?n.roomId:void 0;return r.a.createElement(Sp,{roomId:o,rootUrl:a,roomType:"thread",parentRoomId:s})}},{key:"renderNewThread",value:function(e){var t=e.match,n=t.params,a=t.url;return r.a.createElement(r.a.Fragment,null,r.a.createElement(fd,{messageId:parseInt(n.messageId,10),roomId:n.roomId}),r.a.createElement(om,{messageId:parseInt(n.messageId,10),roomId:n.roomId,rootUrl:a}))}},{key:"renderThreadsList",value:function(e){var t=e.location,n=t&&t.pathname||"";return r.a.createElement(Md,{rootUrl:n})}},{key:"renderConversationsIndex",value:function(e){var t=e.location,n=t&&t.pathname||"";return r.a.createElement(Ym,{rootUrl:n})}},{key:"render",value:function(){var e=this.props,t=e.location,n=e.isContextSidebarOpen,a=e.toggleContextSidebar,o=ne.a.parse(t.search).contextType,s=this.isMobile(),i=Ce()(Lm.a.main,Object(ee.a)({},Lm.a.contextSidebarHidden,!n||!o));return r.a.createElement("div",{className:Lm.a.lobby},r.a.createElement("div",{className:i},r.a.createElement("section",{className:Ce()(Lm.a.section,Object(ee.a)({},Lm.a.overlay,s)),onClick:this.toggleSidebar},me()(this.props.lobby)?r.a.createElement(Cm,null):r.a.createElement(A.d,null,r.a.createElement(A.b,{exact:!0,path:"/rooms/:roomId/new/:messageId",render:this.renderNewThread}),r.a.createElement(A.b,{exact:!0,path:"/:roomType(rooms|threads)/:roomId/:threadId",render:this.renderThread}),r.a.createElement(A.b,{exact:!0,path:"/:roomType(rooms|threads)/:roomId",render:this.renderRoom}),r.a.createElement(A.b,{exact:!0,path:"/conversations/new/:userIds",render:this.renderNewConversation}),r.a.createElement(A.b,{exact:!0,path:"/conversations/:conversationId",render:this.renderConversation}),r.a.createElement(A.b,{exact:!0,path:"/threads",render:this.renderThreadsList}),r.a.createElement(A.b,{exact:!0,path:"/conversations",render:this.renderConversationsIndex}),r.a.createElement(A.b,{exact:!0,path:"/",render:this.renderEmptyLobbyScene}),r.a.createElement(A.a,{to:"/not-found"}))),n&&r.a.createElement(Zl,{className:Lm.a.contextSidebar,toggleContextSidebar:a})))}}]),t}(r.a.PureComponent);var Tp=Object(m.b)(function(e){return{me:Gt(e),lobby:br(e),hasAnyUnreads:Nr(e)}},Ip)(function(e){return r.a.createElement(b,null,function(t){var n=t.isContextSidebarOpen,a=t.toggleContextSidebar;return r.a.createElement(yp,Object(N.a)({},e,{isContextSidebarOpen:n,toggleContextSidebar:a}))})}),jp=n(469),Ap=n.n(jp),Rp=function(){return["production"].includes(k.REACT_APP_ENV||"")?null:r.a.createElement("div",{className:Ap.a.banner},k.REACT_APP_ENV)},Cp=n(484),Np=(n(783),n(472)),kp=n.n(Np),Lp=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.overlay,n=e.associatedId,a=e.children,o=e.alignConfig,s=e.overlayClassName,i=e.inverted,c=Object(ns.a)(e,["overlay","associatedId","children","alignConfig","overlayClassName","inverted"]),u=Ce()(s,Object(ee.a)({},kp.a.inverted,i));return r.a.createElement(Cp.a,Object.assign({id:n,align:o,role:"tooltip",overlay:t,overlayClassName:u},c),a)}}]),t}(r.a.PureComponent);Lp.displayName="ureact-tooltip",Lp.defaultProps={overlay:r.a.createElement("div",null),alignConfig:{},trigger:["hover"]};var Pp=Lp,wp=n(240),xp=n.n(wp),Mp=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isWelcomeFlowVisible,n=e.handleWelcomeClose,a=r.a.createElement(f.NavItem,{title:"Home",href:"".concat(k.REACT_APP_CLASSROOM_URL,"/me")},r.a.createElement(Ne.x,{size:"lg"}));return r.a.createElement(f.Nav,{variant:"small"},r.a.createElement("div",{className:xp.a.navGroup},r.a.createElement(f.NavGroup,null,r.a.createElement(Rp,null),t&&r.a.createElement(Pp,{"data-testid":"welcome-tooltip",placement:"right",overlay:r.a.createElement("div",null,r.a.createElement(q.m,{size:"sm",spacing:"1x"},"Head to the Classroom and start learning."),r.a.createElement(q.a,{onClick:n,variant:"minimal",small:!0,label:_e("Got It!")})),overlayClassName:xp.a.tooltip,trigger:["click"],alignConfig:{offset:[-2,3]},defaultVisible:!0},a),!t&&a,r.a.createElement(f.NavItem,{title:"Catalog",href:"https://www.udacity.com/courses/all"},r.a.createElement(Ne.k,{size:"lg"})))),r.a.createElement("div",{className:xp.a.navGroup},r.a.createElement(f.NavGroup,null,r.a.createElement(f.NavItem,{href:"https://classroom.udacity.com/settings",title:"Settings"},r.a.createElement(Ne.L,{size:"lg"})),r.a.createElement(f.NavItem,{href:"#",title:"Logout",onClick:W},r.a.createElement(Ne.B,{size:"lg"})))))}}]),t}(r.a.PureComponent),Dp=n(316),Up=n.n(Dp),Fp=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).renderNav=function(){return r.a.createElement(A.d,null,r.a.createElement(A.b,{component:Mp}))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.headingText,n=e.subheadingText,a=e.buttonLabel,o=e.href;return r.a.createElement(f.Layout,{backgroundColor:"",documentTitle:_e("Student Hub"),nav:this.renderNav(),sidebar:null,header:null},r.a.createElement("div",{className:Up.a.error},r.a.createElement("img",{className:Up.a.image,src:jm.a,alt:"udacity floating ghost"}),r.a.createElement(q.e,{size:"h1",as:"h2"},t),r.a.createElement(q.m,null,n),r.a.createElement(q.a,{href:o,label:a,variant:"primary"})))}}]),t}(r.a.PureComponent),Gp=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=k.REACT_APP_CLASSROOM_URL||"#";return r.a.createElement(Fp,{headingText:_e("Hang Tight"),subheadingText:_e("It looks like your Nanodegree program hasn\u2019t started yet. You\u2019ll get access to Student Hub once your program begins."),buttonLabel:_e("Return to Classroom"),href:e})}}]),t}(r.a.PureComponent),Bp=n(317),Hp=n.n(Bp),Vp=n(118),zp=n(473),Wp=n.n(zp),Yp=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={groupValue:[]},n.onChange=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var a,r,o;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,r=a.value,!a.checked){e.next=7;break}return e.next=4,n.addValue(r);case 4:o=e.sent,e.next=10;break;case 7:return e.next=9,n.removeValue(r);case 9:o=e.sent;case 10:n.props.onChange(o,n.props.name);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onChangeTextInput=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var a,r,o,s,i,c;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,r=n.props.name,o=a.value,s=a.id,i=s.split("_text")[0].split("".concat(r,"-"))[1],!o){e.next=10;break}return e.next=7,n.addValue(i);case 7:c=n.updateValue(i,o),e.next=13;break;case 10:return e.next=12,n.removeValue(i);case 12:c=e.sent;case 13:n.props.onChange(c,n.props.name);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.addValue=function(e,t){return new Promise(function(a){var r=n.state.groupValue;if(r&&yo()(r,{key:e}))return a(r);var o=[].concat(Object(yt.a)(r),[{key:e,value:t||!0}]);n.setState({groupValue:o},function(){a(o)})})},n.removeValue=function(e){return new Promise(function(t){var a=n.state.groupValue;if(!a||!yo()(a,{key:e}))return t(a);var r=ha()(a,function(t){return t.key!==e});n.setState({groupValue:r},function(){t(r)})})},n.updateValue=function(e,t){var a=n.state.groupValue,r=yo()(a,{key:e}),o=C()(a,r),s=[].concat(Object(yt.a)(a.slice(0,o)),[Object(N.a)({},r,{value:t})],Object(yt.a)(a.slice(o+1)));return n.setState({groupValue:s}),s},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.validation,o=t.values,s=t.name,i=this.state.groupValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.c,{title:n,name:s},o.map(function(t,n){var a=t.text,o=t.value,c=t.textInput,u=yo()(i,{key:o}),l=!!u,d=u&&"string"===typeof u.value?u.value:"";return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(q.b,{checked:l,label:a,name:s,id:"".concat(s,"-").concat(o),value:o,onChange:e.onChange}),c&&r.a.createElement("div",{className:Wp.a.textInput},r.a.createElement(q.n,{label:a,id:"".concat(s,"-").concat(o,"_text"),value:d,onChange:e.onChangeTextInput,hiddenLabel:!0})))})),!!a&&r.a.createElement(q.d,{message:a.message}))}}]),t}(r.a.PureComponent);Yp.defaultProps={inline:!1,value:void 0};var qp=Yp,Kp=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){var t=e.target.value;n.props.onChange(t,n.props.name)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.values,a=e.value,o=e.inline,s=e.name,i=e.validation;return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.k,{title:t,name:s,inline:o,onChange:this.onChange},n.map(function(e){var t=e.text,n=e.value,o=a===n;return r.a.createElement(q.j,{id:"".concat(s,"-").concat(n),key:"".concat(s,"-").concat(n),label:t,name:s,checked:o,value:n})})),!!i&&r.a.createElement(q.d,{message:i.message}))}}]),t}(r.a.PureComponent);Kp.defaultProps={inline:!1,value:void 0};var Jp=Kp,Xp=n(132),Qp=n.n(Xp),$p=n(474),Zp=n.n($p),ef=n(475),tf=n.n(ef),nf=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={tempRating:void 0,rating:void 0},n.setRating=function(e){n.setState({rating:e}),n.props.onChange(e)},n.setTempRating=function(e){return n.setState({tempRating:e})},n.resetTempRating=function(){return n.setState({tempRating:void 0})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.value;e.value!==t&&this.setState({rating:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.max,a=void 0===n?5:n,o=t.name,s=t.title,i=t.validation,c=this.state,u=c.rating,l=c.tempRating,d=l||u?"black":"silver";return r.a.createElement("div",null,r.a.createElement(q.e,{size:"h5",spacing:"half"},s),r.a.createElement("div",{className:tf.a.rating},Zp()(a,function(t){var n=String(a-t),s=_e("".concat(n," stars")),i=function(){return e.setTempRating(n)};return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement("input",{type:"radio",id:"".concat(o,"-").concat(s),value:String(n),checked:u===n,onClick:function(){return e.setRating(n)}}),r.a.createElement("label",{htmlFor:"".concat(o,"-").concat(s),onMouseOver:i,onMouseOut:e.resetTempRating,onFocus:i,onBlur:e.resetTempRating}))})),r.a.createElement(q.m,{size:"sm",color:d},function(e){switch(e){case"5":return"Excellent";case"4":return"OK, could be better";case"3":return"Below average";case"2":return"Disappointing";case"1":return"Unacceptable";default:return"No rating yet"}}(l||u)),!!i&&r.a.createElement(q.d,{message:i.message}))}}]),t}(r.a.PureComponent);nf.defaultProps={max:5,name:"starRatings",value:"1"};var af=nf,rf=function(e){return Object.keys(e).reduce(function(t,n){return!!t&&function(e){return le()(e)||me()(e)}(e[n])},!0)},of=function(e){return Object.keys(e).reduce(function(t,n){return t[n]=sf(e[n]),t},{})},sf=function(e){var t={};return e.interacted||(t.interacted={valid:!1,message:"This is a required question."}),"true"!==e.interacted||!le()(e.rating)&&"0"!==e.rating||(t.rating={valid:!1,message:"This is a required question."}),"true"===e.interacted&&le()(e.improvement)&&(t.improvement={valid:!1,message:"This is a required question."}),"false"===e.interacted&&le()(e.notInteracted)&&(t.notInteracted={valid:!1,message:"This is a required question."}),e.improvement&&yo()(e.improvement,{key:"other_improvement",value:!0})&&(t.improvement={valid:!1,message:'Selecting "other" requires more details.'}),e.notInteracted&&yo()(e.notInteracted,{key:"other_reason",value:!0})&&(t.notInteracted={valid:!1,message:'Selecting "other" requires more details.'}),le()(t)?void 0:t},cf=function(e){return[{key:"interacted",label:"".concat(_e("Did you talk to or read any messages from")," ").concat(e,"?")},{key:"improvement",label:_e("What can be improved? Select all that apply.")},{key:"notInteracted",label:_e("Why not? Select all that apply.")},{key:"rating",label:"".concat(_e("How would you rate")," ").concat(e,"?")}]},uf=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).mentorName=it(n.props.mentor.first,n.props.mentor.last,!0),n.questions=cf(n.mentorName),n.onChange=function(e,t){var a=n.props;(0,a.onChange)(a.mentor.id,e,t)},n.bindOnChange=function(e){return n.onChange.bind(Object(Vp.a)(n),e)},n.onChangeInteracted=function(e){n.onChange("interacted",e),"true"===e?n.onChange("notInteracted",void 0):n.onChange("improvement",void 0)},n.onChangeImprovement=n.bindOnChange("improvement"),n.onChangeNotInteracted=n.bindOnChange("notInteracted"),n.onChangeRating=n.bindOnChange("rating"),n.questions.forEach(function(e){n["onChange".concat(e.key)]=n.onChange.bind(Object(Vp.a)(n),e.key)}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.mentor,n=e.values,a=e.validation,o=e.showValidation,s={question:this.questions[0],value:n[this.questions[0].key],validation:a&&a.interacted},i={question:this.questions[1],value:n[this.questions[1].key],isDisplayed:"true"===s.value,validation:a&&a.improvement},c={question:this.questions[2],value:n[this.questions[2].key],isDisplayed:"false"===s.value,validation:a&&a.notInteracted},u={question:this.questions[3],value:n[this.questions[3].key],isDisplayed:"true"===s.value,validation:a&&a.rating};return r.a.createElement("div",{className:Qp.a.rating},r.a.createElement(Vn,{firstName:t.first,lastName:t.last,photoUrl:t.photo_url,userId:t.id,role:"mentor",sizeSelection:"md"}),r.a.createElement("div",{className:Qp.a.questions},r.a.createElement("section",{className:Qp.a.section},r.a.createElement(Jp,{title:s.question.label,name:"".concat(t.id,"-").concat(s.question.key),inline:!0,onChange:this.onChangeInteracted,validation:o?s.validation:void 0,value:s.value,values:[{text:_e("Yes"),value:"true"},{text:_e("No"),value:"false"}]})),u.isDisplayed&&r.a.createElement("section",{className:Qp.a.section},r.a.createElement(af,{title:u.question.label,name:"".concat(t.id,"-").concat(u.question.key),onChange:this.onChangeRating,value:u.value,validation:o?u.validation:void 0})),i.isDisplayed&&r.a.createElement("section",{className:Qp.a.section},r.a.createElement(qp,{title:i.question.label,name:"".concat(t.id,"-").concat(i.question.key),onChange:this.onChangeImprovement,validation:o?i.validation:void 0,value:i.value,values:[{text:_e("Lesson and project support"),value:"support"},{text:_e("Responsiveness"),value:"responsiveness"},{text:_e("Friendly and clear communication"),value:"communication"},{text:_e("Other:"),value:"other_improvement",textInput:!0}]})),c.isDisplayed&&r.a.createElement("section",{className:Qp.a.section},r.a.createElement(qp,{title:c.question.label,name:"".concat(t.id,"-").concat(c.question.key),onChange:this.onChangeNotInteracted,validation:o?c.validation:void 0,value:c.value,values:[{text:_e("I never see messages from this mentor"),value:"no_messages"},{text:_e("I'm not comfortable posting"),value:"uncomfortable"},{text:_e("I'm able to progress in my Nanodegree without help"),value:"unnecessary"},{text:_e("Other:"),value:"other_reason",textInput:!0}]}))))}}]),t}(r.a.PureComponent);uf.defaultProps={values:{},validation:{},showValidation:!1};var lf=uf,df=n(318),mf=n.n(df),pf=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={ratings:{},validation:{},showValidation:!1},n.setDefaultRatingsState=function(){var e=n.props.mentors.reduce(function(e,t){return e[t.id]={},e},{});n.setState({ratings:e})},n.onSubmit=function(e){var t=n.state.ratings;e.preventDefault();var a=of(t);return rf(a)?n.props.onSubmit(t):n.setState({showValidation:!0,validation:a})},n.changeMentorRating=function(e,t,a){n.setState(function(n){var r=n.ratings;return{ratings:Object(N.a)({},r,Object(ee.a)({},e,Object(N.a)({},r[e],Object(ee.a)({},t,a)))),showValidation:!1}})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setDefaultRatingsState()}},{key:"render",value:function(){var e=this,t=this.props.mentors,n=this.state,a=n.ratings,o=n.showValidation,s=n.validation;return r.a.createElement("div",{className:mf.a.form},r.a.createElement(q.l,{type:"stack",size:"1x"},r.a.createElement(q.e,{size:"h3"},_e("Rate Your Mentors (1 min)"))),r.a.createElement(q.l,{type:"stack",size:"6x"},r.a.createElement(q.m,{spacing:"none"},_e("Ratings are shared anonymously with mentors to help them improve."))),r.a.createElement("form",{onSubmit:this.onSubmit},t.map(function(t){return r.a.createElement("div",{className:mf.a.mentorRatingInputs,key:t.id},r.a.createElement(lf,{mentor:t,onChange:e.changeMentorRating,values:a[t.id]||{},validation:s[t.id],showValidation:o}))}),r.a.createElement(q.l,{type:"stack",size:"2x"},r.a.createElement(q.a,{label:"Complete Ratings",variant:"primary",type:"submit"})),r.a.createElement(q.m,{size:"sm",spacing:"none"},_e("If you have any feedback or questions on your general Udacity experience, contact "),r.a.createElement(q.g,{href:"mailto:support@udacity.com"},"support@udacity.com"),".")))}}]),t}(r.a.PureComponent),ff=n(319),_f=n.n(ff),hf={mutateMentorRating:Vr.mutateMentorRating,resetMutateMentorRating:Vr.resetMutateMentorRating},vf=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).submit=function(e){var t=n.props,a=t.roomId,r=t.mutateMentorRating,o=t.me.id,s=Object.keys(e);s.forEach(function(t){r(t,o,a,e[t])}),n.trackSubmitRatings(s)},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.fetchRoomRatingsStatus,a=t.pendingCompletedProject;xt(e.fetchRoomRatingsStatus)&&Mt(n)&&a&&this.trackViewRatings()}},{key:"componentWillUnmount",value:function(){this.props.resetMutateMentorRating()}},{key:"trackViewRatings",value:function(){var e=this.props,t=e.roomId,n=e.pendingCompletedProject;if(n&&n.mentors){var a=n.mentors.map(function(e){return e.id});Pa.track(Ta.ViewMentorRatingsForm,{roomId:t,mentorIds:a})}}},{key:"trackSubmitRatings",value:function(e){var t=this.props.roomId;Pa.track(Ta.SubmitMentorRatingsForm,{roomId:t,mentorIds:e})}},{key:"render",value:function(){var e=this.props,t=e.pendingCompletedProject,n=e.fetchRoomRatingsStatus,a=e.mutateMentorRatingStatus,o=t&&t.mentors,s=Mt(a),i=Mt(n)&&o&&!s,c=Mt(n)&&!o&&!s;return r.a.createElement("div",null,xt(n)&&r.a.createElement("div",{className:_f.a.loading},r.a.createElement(q.h,null)),i&&o&&r.a.createElement(pf,{mentors:o,onSubmit:this.submit}),c&&r.a.createElement(q.m,null,_e("There are no pending ratings for this project. You may have already submitted ratings for these mentors.")),s&&r.a.createElement("div",{className:_f.a.complete},r.a.createElement(Ne.g,{size:"lg",color:"green"}),r.a.createElement(q.m,null,_e("Thank you for submitting your ratings. Your feedback is important!"))))}}]),t}(r.a.Component),Ef=Object(m.b)(function(e,t){return{fetchRoomRatingsStatus:Kt(e,"getRoomRatings"),mutateMentorRatingStatus:Kt(e,"mutateMentorRating"),pendingCompletedProject:qt(e,t.roomId),me:Gt(e)}},hf)(vf),gf=n(241),bf=n.n(gf),Of={fetchRoomRatings:Vr.fetchRoomRatings},Sf=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.initMentorRatings()}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.roomId;t&&t!==e.match.params.roomId&&this.initMentorRatings()}},{key:"initMentorRatings",value:function(){var e=this.props;(0,e.fetchRoomRatings)(e.match.params.roomId)}},{key:"render",value:function(){var e=this.props.match.params.roomId,t="/rooms/".concat(e);return r.a.createElement("div",{className:bf.a.ratings},r.a.createElement("div",{className:bf.a.ratingsWrapper},r.a.createElement("div",{className:bf.a.backLink},r.a.createElement(p.b,{to:t},r.a.createElement(q.l,{type:"inline",size:"1x"},r.a.createElement(Ne.b,{size:"sm"})),r.a.createElement(q.e,{size:"h6"},_e("Back to Student Hub")))),r.a.createElement(Ef,{roomId:e})))}}]),t}(r.a.PureComponent),If=Object(m.b)(void 0,Of)(Sf),yf=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=k.REACT_APP_KNOWLEDGE_HOME||"#";return r.a.createElement(Fp,{headingText:_e("Cannot connect to server at this time. Please try again later."),subheadingText:_e("If you have any questions with your projects, quizzes, labs, or concepts, check Knowledge for answers."),buttonLabel:_e("Go to Knowledge"),href:e})}}]),t}(r.a.PureComponent),Tf=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.checkLocationAndRedirect()}},{key:"checkLocationAndRedirect",value:function(){var e=this.props,t=e.history,n=e.match.params.workspaceKey,a=e.location;if(n){var r=a.pathname.replace("/".concat(n),"");t.replace("".concat(r).concat(a.search))}}},{key:"render",value:function(){return null}}]),t}(r.a.PureComponent),jf={hideWelcomeFlow:M.hideWelcomeFlow};var Af=Object(m.b)(function(e){return{hasCareerPortalAccess:zt(e),hasKnowledgeAccess:Er(e),isWelcomeFlowVisible:Wt(e)}},jf)(function(e){var t=e.hasCareerPortalAccess,n=e.hasKnowledgeAccess,a=e.isWelcomeFlowVisible,o=e.hideWelcomeFlow;return r.a.createElement(Mp,{hasCareerPortalAccess:t,hasKnowledgeAccess:n,isWelcomeFlowVisible:a,handleWelcomeClose:function(){o()}})}),Rf={bootstrap:M.bootstrap,showWelcomeFlow:M.showWelcomeFlow,hideWelcomeFlow:M.hideWelcomeFlow},Cf=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={hadFTUX:!1},n.onRouteChange=function(e){var t=n.props.me;t&&!Ie(e.pathname)&&Ue.set("last-visited",e,t.id)},n.displayNotFound=function(){return r.a.createElement(Cm,null)},n.renderSidebar=function(){var e=n.props.history,t=Object(A.f)(e.location.pathname,{path:"/mentor-ratings/:roomId",exact:!0}),a=Object(A.f)(e.location.pathname,{path:"/not-found",exact:!0});return t&&t.isExact||a&&a.isExact?null:r.a.createElement(A.d,null,r.a.createElement(A.b,{path:"/",component:Fr}))},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.location.search,n=e.showWelcomeFlow,a=e.bootstrap,r=ne.a.parse(t);se()(r,"ftux")&&(this.setState({hadFTUX:!0}),n()),a()}},{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&this.onRouteChange(this.props.location),Mt(this.props.bootstrapStatus)&&!Mt(e.bootstrapStatus)&&this.state.hadFTUX&&this.redirectToPersonalMentorConversation()}},{key:"componentWillUnmount",value:function(){this.props.hideWelcomeFlow()}},{key:"redirectToPersonalMentorConversation",value:function(){var e=this.props,t=e.lobby,n=e.history,a=re()(t,"personal_mentor_conversations[0].id");a&&n.push(Oe(a))}},{key:"render",value:function(){var e=this.props,t=e.bootstrapStatus,n=e.outageStatus,a=e.lobby,o=e.location,s=RegExp("mentor-ratings").test(o.pathname);if("major_outage"===n)return r.a.createElement(yf,null);if(!Mt(t))return null;var i=re()(a,"has_student_hub_access",!1);return Mt(t)&&!i?r.a.createElement(Gp,null):r.a.createElement("div",{className:Ce()(Hp.a.app,Object(ee.a)({},Hp.a.contextSidebarHidden,s))},r.a.createElement(f.Layout,{backgroundColor:"",documentTitle:_e("Student Hub"),nav:r.a.createElement(A.d,null,r.a.createElement(A.b,{component:Af})),sidebar:this.renderSidebar(),header:null},r.a.createElement(A.d,null,r.a.createElement(A.b,{path:"/robots.txt",onEnter:function(){return window.location.reload()}}),r.a.createElement(A.b,{exact:!0,path:"/not-found",component:this.displayNotFound}),r.a.createElement(A.b,{exact:!0,path:"/mentor-ratings/:roomId",component:If}),r.a.createElement(A.b,{path:"/:workspaceKey/(rooms|threads)",component:Tf}),r.a.createElement(A.b,{path:"/",component:Tp}))))}}]),t}(r.a.Component),Nf=Object(A.g)(Object(m.b)(function(e){return{bootstrapStatus:Ht(e,"bootstrap"),lobby:br(e),me:Gt(e),outageStatus:Bt(e)}},Rf)(Cf)),kf=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidCatch",value:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:J.c(function(e){e.setExtras(n),J.a(t)});case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.children}}]),t}(r.a.Component),Lf=n(150),Pf=n.n(Lf),wf=n(154),xf=n.n(wf);var Mf=function(e){var t=e.alert,n=e.dismissAlert,o=function(e){var t=Object(a.useState)(void 0),n=Object(ba.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(!1),i=Object(ba.a)(s,2),c=i[0],u=i[1];return Object(a.useLayoutEffect)(function(){le()(r)||Pf()(r,e)||u(!0);var t=setTimeout(function(){u(!1),o(e)},parseInt(xf.a.transitionDuration,10));return function(){return clearTimeout(t)}},[e,r]),{isTransitioning:c,renderedAlert:c?r:e}}(t),s=o.isTransitioning,i=o.renderedAlert;if(le()(i))return null;var c=re()(i,"type"),u=re()(i,"message"),l=Ce()(xf.a.alertWrapper,Object(ee.a)({},xf.a.slideOut,s));return r.a.createElement("div",{className:l},c===fp.SUCCESS?r.a.createElement(Ne.l,{size:"md",color:"green"}):r.a.createElement(Ne.s,{size:"md",color:"red"}),r.a.createElement("div",null,u),r.a.createElement("button",{"data-testid":"dismiss-button",onClick:n,className:xf.a.dismissButton},r.a.createElement(Ne.r,{size:"sm",color:"white"})))},Df=function(e){return se()(e,"getIn")?e.getIn(["alerts"]):[]},Uf=Object(Tt.a)(Df,function(e){return e[0]}),Ff={dismissAlert:Ha.clearFirstAlert},Gf=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).dismissAlert=function(e){e.preventDefault(),n.props.dismissAlert()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.alert;return r.a.createElement(Mf,{alert:e,dismissAlert:this.dismissAlert})}}]),t}(r.a.Component),Bf=Object(m.b)(function(e){return{alert:Uf(e)}},Ff)(Gf),Hf={fileDragStart:Qd.fileDragStart,fileDragEnd:Qd.fileDragEnd};var Vf=Object(m.b)(function(e){return{isDraggingFile:dd(e)}},Hf)(function(e){var t,n=e.children,a=e.fileDragStart,o=e.fileDragEnd,s=e.isDraggingFile;return r.a.createElement("div",{"data-testid":"drag-drop-container",onDragOver:function(e){e.preventDefault(),clearTimeout(t),s||a()},onDragLeave:function(){t=setTimeout(o,50)},onDrop:function(){o()}},n)}),zf=(n(784),n(152)),Wf=n(55),Yf=n(50),qf=n(13),Kf=n.n(qf),Jf=n(476),Xf=n.n(Jf),Qf=Kf.a.from([]);var $f=Object(N.a)({},P("GET_LOBBY","LOBBY"),{CHECK_ACTIVE_USERS_SEND:"".concat("LOBBY","/CHECK_ACTIVE_USERS_SEND"),CHECK_ACTIVE_USERS_RECEIVED:"".concat("LOBBY","/CHECK_ACTIVE_USERS_RECEIVED"),POLL_LOBBY_UPDATES_START:"".concat("LOBBY","/POLL_LOBBY_UPDATES_START"),POLL_LOBBY_UPDATES_CANCEL:"".concat("LOBBY","/POLL_LOBBY_UPDATES_CANCEL"),POLL_LOBBY_UPDATES_REJECTED:"".concat("LOBBY","/POLL_LOBBY_UPDATES_REJECTED")}),Zf={getLobby:function(){return L($f.GET_LOBBY_START,void 0)},startPollLobbyUpdates:function(){return L($f.POLL_LOBBY_UPDATES_START,void 0)},cancelPollLobbyUpdates:function(){return L($f.POLL_LOBBY_UPDATES_CANCEL,void 0)},checkActiveUsers:function(){return L($f.CHECK_ACTIVE_USERS_SEND,void 0)},checkActiveUsersReceived:function(e){return L($f.CHECK_ACTIVE_USERS_RECEIVED,{userIds:e})}};function e_(e,t){return t?Kf.a.merge(e,{byId:t},{deep:!0}):e}var t_=function(e,t){return e_(e,t.conversations)},n_=Kf.a.from({byId:{},currentConverations:void 0,stagedConversation:void 0});function a_(e){var t=Kf.a.from({error:null,status:"ready"});return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,a=arguments.length>1?arguments[1]:void 0,r=a.type,o=a.payload,s=a.meta;switch(r){case e.READY:return Kf.a.from(n).merge({error:null,status:"ready"});case e.PENDING:return Kf.a.from(n).merge({error:null,payload:o,meta:s,status:"pending"});case e.FULFILLED:return Kf.a.from(n).merge({error:null,payload:o,meta:s,status:"fulfilled"});case e.REJECTED:return Kf.a.from(n).merge({error:o,status:"rejected",meta:s})}return n}}function r_(e,t){if(e&&!t)throw new TypeError('"actionClass" is a required arg on normalizeAsyncStatusActions()');return{READY:e?"".concat(t,"/").concat(e,"_READY"):"DEFAULT_API_READY",PENDING:e?"".concat(t,"/").concat(e,"_PENDING"):"DEFAULT_API_PENDING",FULFILLED:e?"".concat(t,"/").concat(e,"_FULFILLED"):"DEFAULT_API_FULFILLED",REJECTED:e?"".concat(t,"/").concat(e,"_REJECTED"):"DEFAULT_API_REJECTED"}}var o_=r_("GET_CONVERSATION","CONVERSATIONS"),s_=r_("GET_CONVERSATIONS","CONVERSATIONS"),i_=r_("CREATE_CONVERSATION_ROOM","CONVERSATIONS"),c_=Object(Yf.combineReducers)({fetchConversationRoom:a_(o_),fetchConversations:a_(s_),createConversationRoom:a_(i_)}),u_=Object(N.a)({},P("FETCH_EXPERIMENT_VARIATION","EXPERIMENTS"),P("POST_EXPERIMENT_ACTIVATION","EXPERIMENTS")),l_=Kf.a.from({});var d_=Kf.a.from({ui:{isDraggingFile:!1},pendingFiles:{}});var m_=n(120),p_=n.n(m_),f_=function(e,t){var n=re()(e,"currentLobby.conversations.rooms",[]);return Kf.a.setIn(e,["currentLobby","conversations","rooms"],[t].concat(Object(yt.a)(n)))},__=function(e,t){var n=p_()(re()(e,"currentLobby.conversations.rooms")||[],t);return Kf.a.setIn(e,["currentLobby","conversations","rooms"],n)},h_=function(e){return Kf.a.updateIn(e,["currentLobby","total_conversations"],function(e){return e+1})},v_=function(e){return Kf.a.updateIn(e,["currentLobby","total_threads"],function(e){return e+1})},E_=Kf.a.from({currentLobby:void 0});var g_=r_("GET_LOBBY","LOBBY"),b_=Object(Yf.combineReducers)({getLobby:a_(g_)}),O_=n(110),S_=n.n(O_),I_=function(e,t,n){return[].concat(Object(yt.a)(e.slice(0,n)),[t],Object(yt.a)(e.slice(n+1)))},y_=function(e,t,n){return Kf.a.updateIn(e,["byRoomId",t,"messages"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.includes(n)?e:[].concat(Object(yt.a)(e),[n])})},T_=function(e,t){var n=Ee(t.room_id),a=Kf.a.setIn(e,["pendingById",t.message_id],t),r=t.room_id;return!n&&t.parent_message_id&&(r=String(t.parent_message_id)),a=Kf.a.updateIn(a,["byRoomId",r,"messages"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.includes(t.message_id)?e:[].concat(Object(yt.a)(e),[t.message_id])})},j_=function(e,t,n){return Kf.a.updateIn(e,["pendingById",t.message_id],function(e){return Object(N.a)({},e,n)})},A_=function(e,t,n,a){var r=Kf.a.updateIn(e,["pendingById"],function(e){return Kf.a.without(e,n)});return r=Kf.a.updateIn(r,["byRoomId",t,"messages"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.includes(a),r=e.indexOf(n);if(r>-1&&t){var o=p_()(e,a);return r=o.indexOf(n),I_(o,a,r)}return r>-1?I_(e,a,r):t?e:[].concat(Object(yt.a)(e),[a])})},R_=function(e,t,n){var a=Kf.a.updateIn(e,["pendingById"],function(e){return Kf.a.without(e,n)});return a=Kf.a.updateIn(a,["byRoomId",t,"messages"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return p_()(e,n)})},C_=function(e,t,n){return Kf.a.updateIn(e,["byId",t],function(e){var t=e.thread||{},a=t.message_count||0,r=t.participants||[];return Object(N.a)({},e,{has_replies:!0,thread:{thread_id:n.thread_room_id,message_count:a+1,participants:S_()([n.user_id].concat(Object(yt.a)(r))),last_message_at:n.created_at}})})},N_=function(e,t){return Kf.a.updateIn(e,["byId",t,"thread"],function(e){var t=e.message_count||0;return Object(N.a)({},e,{message_count:t>0?t-1:0})})},k_={messages:[],cursor:{total:0,has_next:!1,next:"",has_prev:!1,prev:""}},L_=Kf.a.from({byId:{},byRoomId:{},pendingByRoomId:{},byActionType:{}});var P_=r_("GET_MESSAGES","MESSAGES"),w_=r_("RECEIVE_MESSAGE","MESSAGES"),x_=r_("POST_MESSAGE","MESSAGES"),M_=r_("REPLY_TO_MESSAGE","MESSAGES"),D_=r_("GET_PREV_MESSAGES","MESSAGES"),U_=r_("GET_NEXT_MESSAGES","MESSAGES"),F_=r_("GET_PIVOT_MESSAGES","MESSAGES"),G_=r_("CREATE_MESSAGE_ACTION","MESSAGES"),B_=r_("DELETE_MESSAGE_ACTION","MESSAGES"),H_=Object(Yf.combineReducers)({getMessages:a_(P_),receiveMessage:a_(w_),postMessage:a_(x_),replyToMessage:a_(M_),getPrevMessages:a_(D_),getNextMessages:a_(U_),getPivotMessages:a_(F_),createMessageAction:a_(G_),deleteMessageAction:a_(B_)}),V_=Kf.a.from({});var z_=n(477),W_=n.n(z_);function Y_(e,t,n,a){var r=e.inactive?Object(yt.a)(e.inactive):[],o=e.active?Object(yt.a)(e.active):[],s=e.admins&&e.admins.includes(t);return n&&!s?(r=ha()(r,function(e){return e!==t}),o.includes(t)||(o=a?[t].concat(Object(yt.a)(o)):[].concat(Object(yt.a)(o),[t]))):s||(r.includes(t)||(r=[].concat(Object(yt.a)(r),[t])),o=ha()(o,function(e){return e!==t})),Object(N.a)({},e,{active:o,inactive:r})}var q_=function(e,t){var n=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){return e[t]=!0,e},{})}(t);return Kf.a.setIn(e,["onlineById"],n)},K_=Kf.a.from({byId:{},onlineById:{},byRoomId:{},searchByRoomId:{},mentionableByRoomId:{}});var J_=r_("GET_PARTICIPANTS","PARTICIPANTS"),X_=r_("SEARCH_PARTICIPANTS","PARTICIPANTS"),Q_=r_("SEARCH_PARTICIPANTS_TO_MENTION","PARTICIPANTS"),$_=Object(Yf.combineReducers)({getParticipant:a_(J_),searchParticipants:a_(X_),searchParticipantsToMention:a_(Q_)}),Z_=n(320),eh=n.n(Z_),th=Kf.a.from({byId:{},additionalInfoById:{}});var nh=r_("GET_PROFILES","PROFILES"),ah=r_("GET_ADDITIONAL_INFO","PROFILES"),rh=Object(Yf.combineReducers)({getProfiles:a_(nh),getAdditionalProfileInfo:a_(ah)}),oh=Kf.a.from({pendingRating:void 0,byRoomId:{},passedByRoomId:{}});var sh=r_("GET_PENDING_RATINGS","PROJECTS"),ih=r_("GET_ROOM_RATINGS","PROJECTS"),ch=r_("MUTATE_MENTOR_RATING","PROJECTS"),uh=Object(Yf.combineReducers)({getPendingRatings:a_(sh),getRoomRatings:a_(ih),mutateMentorRating:a_(ch)}),lh=Kf.a.from({byId:{},currentRoomId:void 0,metaByRoomId:{}});var dh=r_("GET_ROOM","ROOMS"),mh=r_("UPDATE_LAST_VISITED","ROOMS"),ph=r_("GET_ROOM_META","ROOMS"),fh=Object(Yf.combineReducers)({getRoom:a_(dh),updateLastVisited:a_(mh),getRoomMeta:a_(ph)}),_h={threads:[],cursor:{total:0,has_next:!1,next:"",has_prev:!1,prev:""}},hh=Kf.a.from({byId:{},currentThreads:{},stagedThread:void 0});var vh=r_("GET_NEW_THREAD","THREADS"),Eh=r_("GET_THREAD","THREADS"),gh=r_("GET_THREADS","THREADS"),bh=r_("GET_NEXT_THREADS","THREADS"),Oh=Object(Yf.combineReducers)({getNewThread:a_(vh),getThread:a_(Eh),getThreads:a_(gh),getNextThreads:a_(bh)}),Sh=Kf.a.from({me:{},status:"operational",classroomMetadata:{},showWelcomeFlow:!1});var Ih=r_("BOOTSTRAP","SESSION"),yh=r_("FETCH_CLASSROOM_METADATA","SESSION"),Th=Object(Yf.combineReducers)({bootstrap:a_(Ih),classroomMetadata:a_(yh)}),jh=Kf.a.from({connected:!1});var Ah=Object(N.a)({},P("GET_UNREADS","UNREADS"),P("GET_ROOMS_UNREADS","UNREADS"),{INCREMENT_ROOM_UNREADS:"".concat("UNREADS","/INCREMENT_ROOM_UNREADS")}),Rh={getUnreads:function(){return L(Ah.GET_UNREADS_START,void 0)},getRoomsUnreads:function(e){return L(Ah.GET_ROOMS_UNREADS_START,{roomIds:e})},incrementRoomUnreads:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return L(Ah.INCREMENT_ROOM_UNREADS,{roomId:e,timestamp:t,messageId:n,isMention:a})}},Ch=n(190),Nh=n.n(Ch),kh=function(e,t){var n=t.rooms,a=Object(ns.a)(t,["rooms"]);return Kf.a.setIn(e,["summary"],a).updateIn(["rooms"],function(e){return Kf.a.merge(e,n)})},Lh=function(e,t){return Kf.a.updateIn(e,["rooms"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Kf.a.merge(e,t)})},Ph=function(e,t,n){return Kf.a.setIn(e,["rooms",t],n)},wh=function(e,t){return Kf.a.setIn(e,["rooms"],Kf.a.without(e.rooms,t))},xh=function(e,t){return Kf.a.updateIn(e,["summary","unread_conversations_count"],function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)-t})},Mh=function(e,t,n){return Kf.a.updateIn(e,["summary","unread_messages_count"],function(e){return Nh()([e-t,0])}).updateIn(["summary","unread_mentions_count"],function(e){return Nh()([e-n,0])})},Dh=function(e,t,n){var a=Kf.a.updateIn(e,["summary","unread_thread_messages_count"],function(e){return Nh()([e-t,0])}).updateIn(["summary","unread_thread_mentions_count"],function(e){return Nh()([e-n,0])});return a.summary.unread_thread_messages_count?a:Kf.a.setIn(a,["summary","has_unread_threads"],!1)},Uh=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return Object(N.a)({room_id:e,unread_count:1,mentions_count:0,last_visited:n,oldest_message_id:t,mentions:[]},a?Object(N.a)({},a,{unread_count:a.unread_count+1,mentions_count:r?a.mentions_count+1:a.mentions_count}):{})},Fh=function(e){return Kf.a.updateIn(e,["summary","unread_conversations_count"],function(e){return e+1})},Gh=function(e){return Kf.a.updateIn(e,["summary","unread_messages_count"],function(e){return e+1})},Bh=Kf.a.from({rooms:{},summary:{}});var Hh=Object(Yf.combineReducers)({alerts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qf,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case Ba.ADD_ALERT:return Kf.a.from([].concat(Object(yt.a)(e),[{type:a.type,message:a.message}]));case Ba.CLEAR_FIRST_ALERT:return Kf.a.from(Xf()(e))}return e},conversations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta,o=e;switch(n){case $f.GET_LOBBY_FULFILLED:case Pr.GET_CONVERSATIONS_FULFILLED:case Pr.UNARCHIVE_CONVERSATION_FULFILLED:case Pr.CREATE_CONVERSATION_ROOM_FULFILLED:o=t_(e,a.entities);break;case Pr.GET_CONVERSATION_FULFILLED:if(At()(a.result))break;o=t_(e,a.entities)}switch(n){case Pr.GET_CONVERSATION_READY:o=Kf.a.set(o,"currentConversationId",void 0);break;case Pr.CREATE_STAGED_CONVERSATION_FULFILLED:o=Kf.a.set(o,"stagedConversation",a);break;case Pr.GET_CONVERSATIONS_FULFILLED:o=Kf.a.set(o,"currentConversations",a.result);break;case Pr.CREATE_STAGED_CONVERSATION_READY:o=Kf.a.set(o,"stagedConversation",void 0);break;case Pr.ARCHIVE_CONVERSATION_FULFILLED:var s=r.roomId;o=Kf.a.setIn(o,["byId",s,"status"],"archived")}return o},conversationsAsync:c_,experiments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta;switch(n){case u_.FETCH_EXPERIMENT_VARIATION_FULFILLED:case u_.POST_EXPERIMENT_ACTIVATION_FULFILLED:var o=r.experimentKey;return Kf.a.set(e,o,a)}return e},files:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=re()(a,"fileIdentifierString","pendingFile:placeholder");switch(n){case Xd.UPLOAD_IMAGE_CANCELLED:return Kf.a.set(e,"pendingFiles",Kf.a.without(e.pendingFiles,r));case Xd.FILE_DRAG_START:return Kf.a.setIn(e,["ui","isDraggingFile"],!0);case Xd.FILE_DRAG_END:return Kf.a.setIn(e,["ui","isDraggingFile"],!1);case Xd.UPLOAD_IMAGE_PENDING:return Kf.a.setIn(e,["pendingFiles",r,"status"],"pending");case Xd.UPLOAD_IMAGE_PROGRESS:var o=a.progress;return Kf.a.setIn(e,["pendingFiles",r,"progress"],o);case Xd.UPLOAD_IMAGE_REJECTED:var s=a.error;return Kf.a.setIn(e,["pendingFiles",r,"status"],"rejected").setIn(["pendingFiles",r,"error"],s);case Xd.UPLOAD_IMAGE_FULFILLED:var i=a.attachments,c=void 0===i?[]:i;return Kf.a.setIn(e,["pendingFiles",r,"status"],"fulfilled").setIn(["pendingFiles",r,"attachments"],c)}return e},lobby:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta;switch(n){case $f.GET_LOBBY_FULFILLED:var o=a.result;return Kf.a.set(e,"currentLobby",o);case Pr.CREATE_CONVERSATION_ROOM_FULFILLED:var s=a.result,i=h_(e);return f_(i,s);case Pr.ARCHIVE_CONVERSATION_FULFILLED:var c=r.roomId;return __(e,c);case Pr.UNARCHIVE_CONVERSATION_FULFILLED:var u=r.roomId;return f_(e,u);case Pr.SET_CONVERSATION_RECENCY:var l=a.conversationId,d=re()(e,"currentLobby.conversations.rooms")||[];if(d.includes(l)){var m=[l].concat(Object(yt.a)(p_()(d,l)));return Kf.a.setIn(e,["currentLobby","conversations","rooms"],m)}return e;case _d.ADD_NEW_THREAD_ID:return v_(e)}return e},lobbyAsync:b_,messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta,o=e;switch(n){case Pr.GET_CONVERSATIONS_FULFILLED:case to.RECEIVE_MESSAGE_FULFILLED:case to.MERGE_NEW_MESSAGE_BY_ID:case to.GET_PREV_MESSAGES_FULFILLED:case to.GET_NEXT_MESSAGES_FULFILLED:case to.GET_PIVOT_MESSAGES_FULFILLED:case to.GET_MESSAGES_FULFILLED:o=e_(e,a.entities.messages);break;case _d.GET_NEW_THREAD_FULFILLED:o=Kf.a.setIn(o,["byId",r.message.message_id],r.message)}switch(n){case to.GET_PREV_MESSAGES_FULFILLED:var s=a.result,i=s.room_id;o=Kf.a.updateIn(o,["byRoomId",i],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(N.a)({},k_,{room_id:i}),t=arguments.length>1?arguments[1]:void 0;return Object(N.a)({},e,{messages:[].concat(Object(yt.a)(t.messages),Object(yt.a)(e.messages)),cursor:Object(N.a)({},e.cursor,{has_prev:re()(t,"cursor.has_prev",!1),prev:re()(t,"cursor.prev",void 0)})})},s);break;case to.GET_NEXT_MESSAGES_FULFILLED:var c=a.result,u=c.room_id;o=Kf.a.updateIn(o,["byRoomId",u],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(N.a)({},k_,{room_id:u}),t=arguments.length>1?arguments[1]:void 0;return Object(N.a)({},e,{messages:[].concat(Object(yt.a)(e.messages),Object(yt.a)(t.messages)),cursor:Object(N.a)({},e.cursor,{has_next:re()(t,"cursor.has_next",!1),next:re()(t,"cursor.next",void 0)})})},c);break;case to.GET_PIVOT_MESSAGES_FULFILLED:case to.GET_MESSAGES_FULFILLED:var l=a.result;o=Kf.a.setIn(o,["byRoomId",l.room_id],l);break;case to.GET_MESSAGES_READY:var d=a.roomId;o=Kf.a.setIn(o,["byRoomId",d],void 0);break;case to.POST_MESSAGE_PENDING:var m=a.message;o=T_(o,m);break;case to.POST_MESSAGE_REJECTED:var p=a.message;o=j_(o,p,{failed:!0});break;case to.REPLACE_PENDING_MESSAGE:var f=a.roomId,_=a.pendingMessageId,h=a.messageId;o=A_(o,f,_,h);break;case to.CANCEL_PENDING_MESSAGE_PENDING:var v=a.message,E=v.room_id,g=v.message_id;o=R_(o,E,g);break;case to.RECEIVE_MESSAGE_FULFILLED:var b=a.result;if(!r.isNewMessage)break;var O=re()(r,"payload.roomId",void 0),S=!1===re()(o,"byRoomId[".concat(O,"].cursor.has_next"));O&&S&&(o=y_(o,O,b));var I=re()(r,"payload.message.thread_message_id");I&&o.byId[I]&&(o=C_(o,I,r.payload.message));break;case to.DELETE_MESSAGE_FULFILLED:var y,T=a.message,j=T.room_id,A=T.message_id,R=T.parent_message_id;A&&(o=Kf.a.update(o,"byId",function(e,t){return e.without(t)},A)),j&&(o.byRoomId[j]&&(y=o.byRoomId[j].messages.filter(function(e){return e!==A})),o=Kf.a.setIn(o,["byRoomId",j,"messages"],y)),R&&o.byId[R]&&(o=N_(o,R));break;case to.EDIT_MESSAGE_FULFILLED:var C=a.message_id,k=o.byId[C];if(C&&k){var L=Object(N.a)({},k,a);o=Kf.a.setIn(o,["byId",C],L)}break;case to.GET_MESSAGES_BY_ACTION_FULFILLED:var P=a.actionType,w=a.roomId,x=a.messages;o=Kf.a.setIn(o,["byActionType",w,P],x);break;case to.RECEIVE_MESSAGE_ACTION_FULFILLED:var M=a.action,D=a.message;if(a.isMe)break;var U=M.message_id,F=M.type,G=o.byId[U],B=G.message_actions,H=void 0===B?[]:B;if(H.some(function(e){return e.id===M.id}))break;if(U&&G){var V=[].concat(Object(yt.a)(H),[M]),z=Object(N.a)({},G,{message_actions:V});o=Kf.a.setIn(o,["byId",U],z);var W=Kf.a.getIn(o,["byActionType",z.room_id,F],[]);o=Kf.a.setIn(o,["byActionType",z.room_id,F],[].concat(Object(yt.a)(W),[D]))}break;case to.CREATE_MESSAGE_ACTION_FULFILLED:var Y=a.action,q=a.message,K=Y.message_id,J=Y.type,X=o.byId[K];if(K&&X){var Q=X.message_actions,$=void 0===Q?[]:Q,Z=[].concat(Object(yt.a)($),[Y]),ee=Object(N.a)({},X,{message_actions:Z});o=Kf.a.setIn(o,["byId",K],ee);var te=Kf.a.getIn(o,["byActionType",ee.room_id,J],[]),ne=(q.thread,Object(ns.a)(q,["thread"]));o=Kf.a.setIn(o,["byActionType",ee.room_id,J],[].concat(Object(yt.a)(te),[ne]))}break;case to.DELETE_MESSAGE_ACTION_FULFILLED:var ae=a.id,oe=a.message_id,se=o.byId[oe];if(oe&&se){var ie=se.message_actions,ce=void 0===ie?[]:ie,ue=ce.find(function(e){return e.id===ae});if(ue){var le=Kf.a.getIn(o,["byActionType",se.room_id,ue.type],[]).filter(function(e){return e.message_actions&&!e.message_actions.some(function(e){return e.id===ae})});o=Kf.a.setIn(o,["byActionType",se.room_id,ue.type],le)}var de=ce.filter(function(e){return e.id!==ae}),me=Object(N.a)({},se,{message_actions:de});o=Kf.a.setIn(o,["byId",oe],me)}break;case to.GET_LINKS_INFO_FULFILLED:var pe=a.message_id,fe=a.links;pe&&o.byId[pe]&&(o=Kf.a.updateIn(o,["byId",pe],function(e,t){return Object(N.a)({},e,{links:fe})}))}return o},messagesAsync:H_,nanodegrees:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case ep.GET_NANODEGREE_FULFILLED:var r=a.nanodegree;return Kf.a.set(e,r.key,r)}return e},participants:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta,o=e;switch(n){case go.GET_PARTICIPANTS_FULFILLED:o=e_(e,a.entities.participants)}switch(n){case go.GET_PARTICIPANTS_FULFILLED:var s=a.result;o=Kf.a.setIn(o,["byRoomId",s.room_id],s);break;case go.SEARCH_PARTICIPANTS_READY:var i=a.roomId;o=Kf.a.updateIn(o,["searchByRoomId"],function(e){return Kf.a.without(e,i)});break;case go.SEARCH_PARTICIPANTS_FULFILLED:var c=r.roomId;o=Kf.a.setIn(o,["searchByRoomId",c],a);break;case go.SEARCH_PARTICIPANTS_TO_MENTION_READY:var u=a.roomId;o=Kf.a.updateIn(o,["mentionableByRoomId"],function(e){return Kf.a.without(e,u)});break;case go.SEARCH_PARTICIPANTS_TO_MENTION_FULFILLED:var l=r.roomId;o=Kf.a.setIn(o,["mentionableByRoomId",l],a);break;case go.SET_PARTICIPANT_STATUS_FULFILLED:var d=a.userId,m=a.roomId,p=a.isActive,f=a.isMe,_=e.byId[d],h=e.byRoomId[m],v=h&&W_()(h.admins,d);_&&(o=Kf.a.setIn(o,["byId",d,"is_active"],p),h&&!v&&(o=Kf.a.updateIn(o,["byRoomId",m],function(e){return Y_(e,d,p,f)})));break;case to.RECEIVE_MESSAGE_FULFILLED:var E=r.payload.message,g=r.isMe,b=E&&E.thread_room_id;if(b){var O=re()(o,["byRoomId",b],void 0);O&&E&&(o=Kf.a.updateIn(o,["byRoomId",b],function(e){return Y_(O,E.user_id,!0,g)}))}break;case $f.CHECK_ACTIVE_USERS_RECEIVED:var S=a.userIds;o=q_(o,S)}return o},participantsAsync:$_,profiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:th,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta,o=e;switch(n){case Pr.GET_CONVERSATION_FULFILLED:case Pr.GET_CONVERSATIONS_FULFILLED:case $f.GET_LOBBY_FULFILLED:case Xr.GET_ROOMS_PROFILES_FULFILLED:case Xr.GET_PROFILES_FULFILLED:if(me()(a))break;var s=a.entities.profiles;o=e_(e,eh.a.mapValues(s,function(e){return eh.a.omit(e,["nanodegrees"])}));break;case x.UPDATE_ME_FULFILLED:var i=a.id;o=Kf.a.setIn(e,["byId",i],a);break;case Xr.GET_ADDITIONAL_INFO_FULFILLED:var c=r.userId;c&&(o=Kf.a.setIn(e,["additionalInfoById",c],a))}return o},profilesAsync:rh,projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta;switch(n){case Hr.GET_PENDING_RATINGS_FULFILLED:return Kf.a.setIn(e,["pendingRating"],a);case Hr.GET_ROOM_RATINGS_FULFILLED:var o=r.roomId;return Kf.a.setIn(e,["byRoomId",o],a);case Hr.MUTATE_MENTOR_RATING_FULFILLED:return Kf.a.setIn(e,["byNdId"],{});case Hr.GET_PASSED_USERS_FULFILLED:var s=r.roomId;return Kf.a.setIn(e,["passedByRoomId",s],a)}return e},projectsAsync:uh,rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=e;switch(n){case $f.GET_LOBBY_FULFILLED:case $r.GET_ROOM_FULFILLED:r=e_(e,a.entities.rooms)}switch(n){case $r.GET_ROOM_READY:r=Kf.a.set(r,"currentRoomId",void 0);break;case $r.GET_ROOM_META_FULFILLED:var o=a.roomId,s=a.project;r=Kf.a.setIn(r,["metaByRoomId",o,"project"],s)}return r},roomsAsync:fh,threads:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.meta,o=e;switch(n){case _d.GET_THREADS_FULFILLED:case _d.GET_NEXT_THREADS_FULFILLED:case _d.GET_THREAD_FULFILLED:o=e_(e,a.entities.threads);break;case to.RECEIVE_MESSAGE_FULFILLED:var s=r.payload.message,i=s.thread_room_id;i&&re()(o,["byId",i],void 0)&&(o=Kf.a.updateIn(o,["byId",i,"topic","thread"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.message_count||0,a=e.participants||[];return{thread_id:t.thread_room_id,message_count:n+1,participants:S_()([t.user_id].concat(Object(yt.a)(a))),last_message_at:t.created_at}},s))}switch(n){case _d.GET_NEW_THREAD_FULFILLED:var c=a;o=Kf.a.set(o,"stagedThread",c);break;case _d.GET_NEW_THREAD_READY:o=Kf.a.set(o,"stagedThread",void 0);break;case _d.GET_THREAD_FULFILLED:var u=a.result;o=Kf.a.updateIn(o,["currentThreads","threads"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return S_()([].concat(Object(yt.a)(e),[u]))});break;case _d.ADD_NEW_THREAD_ID:var l=a.threadId;le()(o.currentThreads)||(o=Kf.a.updateIn(o,["currentThreads","threads"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return S_()([l].concat(Object(yt.a)(e)))}));break;case _d.GET_THREADS_FULFILLED:var d=a.result;o=Kf.a.setIn(o,["currentThreads"],d);break;case _d.GET_NEXT_THREADS_FULFILLED:var m=a.result;o=Kf.a.updateIn(o,["currentThreads"],function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(N.a)({},_h);return Object(N.a)({},e,{threads:[].concat(Object(yt.a)(e.threads),Object(yt.a)(m.threads)),cursor:Object(N.a)({},e.cursor,{has_next:m.cursor.has_next,next:m.cursor.next})})})}return o},threadsAsync:Oh,session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case x.BOOTSTRAP_FULFILLED:case x.FETCH_ME_FULFILLED:return Kf.a.merge(e,a);case x.UPDATE_ME_FULFILLED:return Kf.a.set(e,"me",a);case x.FETCH_STATUS_FULFILLED:return Kf.a.set(e,"status",a);case x.FETCH_CLASSROOM_METADATA_FULFILLED:return Kf.a.set(e,"classroomMetadata",a.user);case x.SHOW_WELCOME_FLOW:return Kf.a.set(e,"showWelcomeFlow",!0);case x.HIDE_WELCOME_FLOW:return Kf.a.set(e,"showWelcomeFlow",!1)}return e},sessionAsync:Th,sockets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=e;switch(n){case Gr.UPDATE_CONNECTION_STATUS:var o=a.connected;r=Kf.a.set(r,"connected",o)}return r},unreads:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case Ah.GET_UNREADS_FULFILLED:return kh(e,a);case Ah.GET_ROOMS_UNREADS_FULFILLED:return Lh(e,a);case $r.UPDATE_LAST_VISITED_FULFILLED:var r=a.roomId,o=a.unreads,s=e,i=re()(s,["rooms",r]);if(me()(i))return s;s=o.unread_count?Ph(s,r,o):wh(s,r);var c=(i.unread_count||0)-o.unread_count,u=(i.mentions_count||0)-o.mentions_count;return s=ge(r)?xh(s,c):Ee(r)?Dh(s,c,u):Mh(s,c,u);case Ah.INCREMENT_ROOM_UNREADS:var l=a.roomId,d=a.messageId,m=a.timestamp,p=a.isMention,f=e,_=re()(f,"rooms[".concat(l,"]")),h=Uh(l,d,m,_,p);return f=Ph(f,l,h),f=ge(l)?Fh(f):Ee(l)?Kf.a.setIn(f,["summary","has_unread_threads"],!0):Gh(f)}return e}}),Vh=n(478),zh=n.n(Vh),Wh=n(3),Yh=Ra.a.mark(Xh),qh=Ra.a.mark(Qh),Kh=Ra.a.mark($h),Jh=Ra.a.mark(Zh);function Xh(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.b)(Wf.d,4e3);case 2:return e.next=4,Object(Wh.f)(Ha.clearFirstAlert());case 4:case"end":return e.stop()}},Yh)}function Qh(){var e;return Ra.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(Wh.h)(Df);case 3:if(t.sent.length){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,Object(Wh.e)(Xh);case 8:return e=t.sent,t.next=11,Object(Wh.i)(Ba.CLEAR_FIRST_ALERT);case 11:return t.next=13,Object(Wh.c)(e);case 13:t.next=0;break;case 15:case"end":return t.stop()}},qh)}function $h(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Ba.ADD_ALERT,Qh);case 2:case"end":return e.stop()}},Kh)}function Zh(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([$h()]);case 2:case"end":return e.stop()}},Jh)}var ev=function(e,t,n){var a="".concat(t,"_PENDING"),r="".concat(t,"_REJECTED");return Ra.a.mark(function t(o){return Ra.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(Wh.f)(Object(N.a)({},o,{type:n[a]}));case 3:return t.next=5,e(o);case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(0),t.next=11,Object(Wh.f)(w(n[r],t.t0));case 11:case"end":return t.stop()}},t,null,[[0,7]])})},tv=function(e,t){return{id:e.join("-"),members_count:{students:e.length},status:"joined",type:"conversation",profiles:t}},nv="{\n  has_unread_threads\n  unread_mentions_count\n  unread_messages_count\n  unread_conversations_count\n  unread_thread_messages_count\n  unread_thread_mentions_count\n  rooms\n}",av=("{\n  unreads_lobby ".concat(nv,"\n}"),"\n  id\n  type\n  members_count\n  status\n  profiles {\n    id\n    first_name\n    last_name\n    show_location\n    photo_url\n    location {\n      description\n    }\n    roles {\n      type\n      payload {\n        bio\n        rooms\n      }\n    }\n  }\n  meta {\n    ... on PersonalMentorConversationMeta {\n      type\n      scope_id\n      originator\n      scope_type\n      participants\n      scope_payload {\n        mentor\n        nd_key\n        student\n        nd_locale\n      }\n    }\n  }\n"),rv="\n  has_next\n  has_prev\n  next\n  prev\n  total\n",ov="{".concat(rv,"}"),sv="\n  rooms {\n    ".concat(av,"\n    summary {").concat("\n  message_count\n  last_message {\n    attachments\n    content\n    content_preview\n    created_at\n    mentions\n    message_id\n    message_id_str\n    room_id\n    parent_room_id\n    updated_at\n    user_id\n    has_replies\n  }\n","}\n  },\n  cursor {").concat(rv,"}\n"),iv="\n  meta {\n    ... on GuidedStudyMeta {\n      id\n      nanodegree {\n        id\n      }\n      start_date\n    }\n    ... on GuidedStudyCohortMeta {\n      id\n      nanodegree {\n        id\n        title\n      }\n      start_date\n    }\n    ... on GuidedStudySessionMeta {\n      id\n      nanodegree {\n        id\n        title\n      }\n      session_id\n      start_date\n    }\n  }\n  title\n  type\n  rooms {\n    status\n    room_id\n    room_type\n    room_title\n    room_summary\n    members_count\n  }\n",cv="{\n  lobby {\n    has_student_hub_access\n    total_threads\n    total_conversations\n    personal_mentor_conversations {\n      ".concat(av,"\n    }\n    conversations {\n      rooms { ").concat(av," }\n    }\n    community_groups: groups(input: {types: [community]}) {\n      ").concat(iv,"\n    }\n    mentored_groups: groups(input: {types: [guided_study_cohort, guided_study_nanodegree]}) {\n      ").concat(iv,"\n    }\n    knowledge_profile {\n      has_access\n    }\n  }\n}"),uv=n(479),lv=n.n(uv),dv=k.REACT_APP_NAME,mv=function(e){return xl(k.REACT_APP_HUB_BFF_API_URL,e)},pv=function(e){var t={roomId:e},n="\n    query ".concat(dv,"_GetProjectMentorRatingsDue($roomId: String) {\n      user { project_mentor_ratings_due(input: {room_id: $roomId}) {\n        ...mentorsToRate\n      }}\n    }\n    fragment mentorsToRate on MentorsToRate ").concat("{\n   project_title,\n   mentors {\n     id,\n     first,\n     last,\n     photo_url\n   },\n   room_id\n}","\n  ");return mv({query:n,variables:t})},fv={searchRoomParticipants:function(e){var t="\n      query ".concat(dv,"_GetParticipants($input: ParticipantsInput!) {\n        participants(input: $input) {\n          participants {\n            ...participant\n          },\n          cursor {\n            ...cursor\n          }\n        }\n      }\n\n      fragment participant on Participant ").concat("{\n  id\n  first\n  last\n  is_active\n  photo_url\n  type\n}","\n      fragment cursor on Cursor ").concat(ov,"\n    ");return mv({query:t,variables:{input:lv()(e,{count:20,after:0})}})},fetchPendingRatings:function(){return pv()},fetchRatingsByRoomId:function(e){return pv(e)},mutateMentorRating:function(e,t,n,a){var r={mentorId:e,userId:t,roomId:n,rating:{payload:a,version:"1.0.0"}},o="\n      mutation ".concat(dv,"_RateProjectMentor(\n        $mentorId: String!,\n        $userId: String!,\n        $roomId: String!,\n        $rating: JSON!\n      ) {\n        create_project_mentor_rating (\n          input: {\n            mentor_id: $mentorId,\n            student_id: $userId,\n            room_id: $roomId,\n            response: $rating\n          }\n        ) {\n          ...projectMentorRating\n        }\n      }\n\n      fragment projectMentorRating on ProjectMentorRating ").concat("{\n  id\n  mentor_id\n  response\n  rating\n  room_id\n  rubric_id\n  created_at\n}","\n    ");return mv({query:o,variables:r})},fetchPassedUsersByRoomId:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n){var a,r,o;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={roomId:t,participantIds:n},r="query ".concat(dv,"_GetPassedUsers($roomId: String!, $participantIds: [String]!){\n       user { participants_passed(room_id: $roomId, user_ids: $participantIds) }\n    }"),e.next=4,mv({query:r,variables:a});case 4:return o=e.sent,e.abrupt("return",re()(o,"data.user.participants_passed"));case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),syncLobby:function(){var e=Object(Ca.a)(Ra.a.mark(function e(){var t,n;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="mutation ".concat(dv,"_SyncLobbyMutation {sync_lobby}"),e.next=3,mv({query:t});case 3:return n=e.sent,e.abrupt("return",re()(n,"data.sync_lobby"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),syncPairings:function(){var e=Object(Ca.a)(Ra.a.mark(function e(){var t,n;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="mutation ".concat(dv,"_SyncPairingsMutation {sync_pairings}"),e.next=3,mv({query:t});case 3:return n=e.sent,e.abrupt("return",re()(n,"data.sync_pairings"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),fetchLobby:function(){var e=Object(Ca.a)(Ra.a.mark(function e(){var t,n;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="query ".concat(dv,"_FetchLobby ").concat(cv),e.next=3,mv({query:t});case 3:return n=e.sent,e.abrupt("return",re()(n,"data.lobby"));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),fetchUnreads:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="query ".concat(dv,"_FetchUnreadsLobby($userId: String!) {\n      unreads_lobby(user_id: $userId ) ").concat(nv,"\n    }"),a={userId:t},e.next=4,mv({query:n,variables:a});case 4:return r=e.sent,e.abrupt("return",re()(r,"data.unreads_lobby"));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fetchRoomsUnreads:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="query ".concat(dv,"_FetchRoomsUnreads($roomIds: [String!]!) {\n      unreads(input:{room_ids: $roomIds})\n    }"),a={roomIds:t},e.next=4,mv({query:n,variables:a});case 4:return r=e.sent,e.abrupt("return",re()(r,"data.unreads"));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fetchConversation:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(N.a)({},t),a="query ".concat(dv,"_GetConversation($conversationId: String, $userIds: [String!]){\n      conversation(input:{conversation_id: $conversationId, user_ids: $userIds}) {\n        ").concat(av,"\n      }\n    }"),e.next=4,mv({query:a,variables:n});case 4:return r=e.sent,e.abrupt("return",re()(r,"data.conversation"));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fetchConversations:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r,o,s,i;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.count,a=void 0===n?8:n,r=t.page,o={count:a,offset:((void 0===r?1:r)-1)*a},s="query ".concat(dv,"_GetConversations($count: Int, $offset: Int){\n      conversations(input:{count: $count, offset: $offset, archived: true}) {\n        ").concat(sv,"\n      }\n    }"),e.next=6,mv({query:s,variables:o});case 6:return i=e.sent,e.abrupt("return",re()(i,"data.conversations"));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createConversation:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(N.a)({},t),a="mutation ".concat(dv,"_CreateConversation($roomId: String, $userIds: [String!]!){\n      create_conversation(input:{room_id: $roomId, user_ids: $userIds}) { ").concat(av," }\n    }"),e.next=4,mv({query:a,variables:n});case 4:return r=e.sent,e.abrupt("return",re()(r,"data.create_conversation"));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),archiveConversation:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(N.a)({},t),a="mutation ".concat(dv,"_ArchiveConversation($roomId: String!){\n      archive_conversation(input:{room_id: $roomId}) { ").concat(av," }\n    }"),e.next=4,mv({query:a,variables:n});case 4:return r=e.sent,e.abrupt("return",re()(r,"data.archive_conversation"));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),unarchiveConversation:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(N.a)({},t),a="mutation ".concat(dv,"_UnarchiveConversation($roomId: String!){\n      unarchive_conversation(input:{room_id: $roomId}) { ").concat(av," }\n    }"),e.next=4,mv({query:a,variables:n});case 4:return r=e.sent,e.abrupt("return",re()(r,"data.unarchive_conversation"));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fetchAdditionalProfileInfo:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a,r;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={userId:t},a="\n      query ".concat(dv,"_GetAdditionalProfileInfo($userId: String!) {\n        knowledge(input: {userId: $userId}) {\n          activity {\n            answers_count\n            answers_accepted\n            up_votes_received\n          }\n        }\n        user {\n          nanodegrees(user_id: $userId) {\n            id\n            title\n            key\n            is_graduated\n            projects {\n              completed_count\n              projects {\n                status\n                title\n                id\n              }\n            }\n          }\n        }\n      }"),e.next=4,mv({query:a,variables:n});case 4:return r=e.sent,e.abrupt("return",{nanodegrees:re()(r,"data.user.nanodegrees"),knowledge:re()(r,"data.knowledge")});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),updateUnread:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t,n){var a,r,o;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={roomId:t,lastVisited:n},r="\n      mutation ".concat(dv,"_UpdateUnread($roomId: String!, $lastVisited: String!) {\n        update_unread(input: {room_id: $roomId, last_visited: $lastVisited}) { ").concat("\n  unread_count\n  mentions_count\n  last_visited\n  oldest_message_id\n  mentions\n"," }\n      }\n    "),e.next=4,mv({query:r,variables:a});case 4:return o=e.sent,e.abrupt("return",re()(o,"data.update_unread"));case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),fetchRoomMetaByRoomId:function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={roomId:t},a="\n      query ".concat(dv,"_GetProjectInfoByRoomId($roomId: String!) {\n        project(input: {room_id: $roomId}) {\n          due_at\n          description\n          id\n          key\n          lesson_summary\n          title\n          rubric_id\n          reviews_project_id\n          summary\n          project_state {\n            state\n            submissions {\n              id\n              created_at\n              status\n              result\n              url\n              is_legacy\n            }\n          }\n          knowledge {\n            nanodegree_tag_id\n            project_tag_id\n            total_questions\n          }\n        }\n      }"),e.abrupt("return",mv({query:a,variables:n}));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},_v=Ra.a.mark(bv),hv=Ra.a.mark(Ov),vv=Ra.a.mark(Sv),Ev=Ra.a.mark(Iv),gv=Ra.a.mark(yv);function bv(e){var t,n;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.h)(Gt);case 2:return t=e.sent,e.next=5,Object(Wh.b)(fv.fetchUnreads,t.id);case 5:return n=e.sent,e.next=8,Object(Wh.f)({type:Ah.GET_UNREADS_FULFILLED,payload:n});case 8:case"end":return e.stop()}},_v)}function Ov(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload.roomIds,a.next=3,Object(Wh.b)(fv.fetchRoomsUnreads,t);case 3:return n=a.sent,a.next=6,Object(Wh.f)({type:Ah.GET_ROOMS_UNREADS_FULFILLED,payload:n});case 6:return a.abrupt("return",n);case 7:case"end":return a.stop()}},hv)}function Sv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Ah.GET_UNREADS_START,ev(bv,"GET_UNREADS",Ah));case 2:case"end":return e.stop()}},vv)}function Iv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Ah.GET_ROOMS_UNREADS_START,ev(Ov,"GET_ROOMS_UNREADS",Ah));case 2:case"end":return e.stop()}},Ev)}function yv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([Sv(),Iv()]);case 2:case"end":return e.stop()}},gv)}var Tv=Ra.a.mark(Gv),jv=Ra.a.mark(Bv),Av=Ra.a.mark(Hv),Rv=Ra.a.mark(Vv),Cv=Ra.a.mark(zv),Nv=Ra.a.mark(Wv),kv=Ra.a.mark(Yv),Lv=Ra.a.mark(qv),Pv=Ra.a.mark(Kv),wv=Ra.a.mark(Jv),xv=Ra.a.mark(Xv),Mv=Ra.a.mark(Qv),Dv=Ra.a.mark($v),Uv=Ra.a.mark(Zv),Fv=Ra.a.mark(eE);function Gv(e){var t,n,a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload.conversationId,n=e.payload,a=n.messageId,r=n.userIds,c.next=4,Object(Wh.b)(fv.fetchConversation,{conversationId:t,userIds:r});case 4:if(o=c.sent,s=ur(o),!o.id){c.next=25;break}if(t=o.id,!a){c.next=13;break}return c.next=11,Object(Wh.f)(no.getPivotMessages(t,a));case 11:c.next=23;break;case 13:return c.next=15,Object(Wh.h)(Cr,t);case 15:if(!(i=c.sent)||!i.unread_count){c.next=21;break}return c.next=19,Object(Wh.f)(no.getPivotMessages(t,Number(i.oldest_message_id)));case 19:c.next=23;break;case 21:return c.next=23,Object(Wh.f)(no.getMessages(t));case 23:return c.next=25,Object(Wh.f)(bo.getParticipants(t));case 25:return c.next=27,Object(Wh.f)({type:Pr.GET_CONVERSATION_FULFILLED,payload:s});case 27:case"end":return c.stop()}},Tv)}function Bv(e){var t,n,a,r,o,s;return Ra.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=t.page,a=t.count,i.next=3,Object(Wh.b)(fv.fetchConversations,{page:n,count:a});case 3:return r=i.sent,o=lr(r),s=re()(o,"result.rooms",[]),i.next=8,Object(Wh.b)(Ov,{payload:{roomIds:s}});case 8:return i.next=10,Object(Wh.f)({type:Pr.GET_CONVERSATIONS_FULFILLED,payload:o});case 10:case"end":return i.stop()}},jv)}function Hv(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload.userIds,r.next=3,Object(Wh.h)(Zn,t);case 3:return n=r.sent,a=tv(t,n),r.next=7,Object(Wh.f)({type:Pr.CREATE_STAGED_CONVERSATION_FULFILLED,payload:a});case 7:case"end":return r.stop()}},Av)}function Vv(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.userIds,a=t.roomId,s.next=3,Object(Wh.b)(fv.createConversation,{roomId:a,userIds:n});case 3:return r=s.sent,o=ur(r),s.next=7,Object(Wh.f)({type:Pr.CREATE_CONVERSATION_ROOM_FULFILLED,payload:o});case 7:return s.abrupt("return",r);case 8:case"end":return s.stop()}},Rv)}function zv(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload.roomId,r.next=3,Object(Wh.b)(fv.archiveConversation,{roomId:t});case 3:return n=r.sent,a=ur(n),r.next=7,Object(Wh.f)({type:Pr.ARCHIVE_CONVERSATION_FULFILLED,payload:a,meta:{roomId:t}});case 7:return r.abrupt("return",n);case 8:case"end":return r.stop()}},Cv)}function Wv(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload.roomId,r.next=3,Object(Wh.b)(fv.unarchiveConversation,{roomId:t});case 3:return n=r.sent,a=ur(n),r.next=7,Object(Wh.f)({type:Pr.UNARCHIVE_CONVERSATION_FULFILLED,payload:a,meta:{roomId:t}});case 7:return r.abrupt("return",n);case 8:case"end":return r.stop()}},Nv)}function Yv(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.userIds,a=t.message,r=t.roomId,s.next=3,Object(Wh.b)(Vv,{payload:{userIds:n,roomId:r}});case 3:if(o=s.sent,!(se()(a,"file")&&a.file instanceof File)){s.next=9;break}return s.next=7,Object(Wh.f)(no.postImageMessage(a.file,o.id));case 7:s.next=11;break;case 9:return s.next=11,Object(Wh.f)(no.postMessage(a,o.id));case 11:case"end":return s.stop()}},kv)}function qv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.GET_CONVERSATION_START,ev(Gv,"GET_CONVERSATION",Pr));case 2:case"end":return e.stop()}},Lv)}function Kv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.GET_CONVERSATIONS_START,ev(Bv,"GET_CONVERSATIONS",Pr));case 2:case"end":return e.stop()}},Pv)}function Jv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.CREATE_STAGED_CONVERSATION_START,ev(Hv,"CREATE_STAGED_CONVERSATION",Pr));case 2:case"end":return e.stop()}},wv)}function Xv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.CREATE_CONVERSATION_ROOM_START,ev(Vv,"CREATE_CONVERSATION_ROOM",Pr));case 2:case"end":return e.stop()}},xv)}function Qv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.ARCHIVE_CONVERSATION_START,ev(zv,"ARCHIVE_CONVERSATION",Pr));case 2:case"end":return e.stop()}},Mv)}function $v(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.UNARCHIVE_CONVERSATION_START,ev(Wv,"UNARCHIVE_CONVERSATION",Pr));case 2:case"end":return e.stop()}},Dv)}function Zv(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Pr.CREATE_CONVERSATION_AND_SUBMIT_START,ev(Yv,"CREATE_CONVERSATION_AND_SUBMIT",Pr));case 2:case"end":return e.stop()}},Uv)}function eE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([qv(),Kv(),Jv(),Xv(),Qv(),$v(),Zv()]);case 2:case"end":return e.stop()}},Fv)}var tE=k.REACT_APP_SERVICES_OPTIMIZELY_PROJECT_ID,nE={attributes:void 0,projectId:void 0},aE={fetchExperimentVariation:function(e,t,n){var a=n||nE,r=a.attributes,o=a.projectId;return function(e,t){return Ll(k.REACT_APP_EXPERIMENTS_API_URL,e,t)}("/users/".concat(e,"/experiments/").concat(t,"/variation"),{params:{attributes:r},headers:{"X-Optimizely-Project-ID":o||tE}})},postExperimentActivation:function(e,t,n){var a=n||nE,r=a.attributes,o=a.projectId;return function(e,t,n){return Pl(k.REACT_APP_EXPERIMENTS_API_URL,e,t,n)}("/users/".concat(e,"/experiments/").concat(t,"/activation"),{attributes:r},{headers:{"X-Optimizely-Project-ID":o||tE}})}},rE=Ra.a.mark(dE),oE=Ra.a.mark(mE),sE=Ra.a.mark(pE),iE=Ra.a.mark(fE),cE=Ra.a.mark(_E),uE=Ra.a.mark(hE),lE=Ra.a.mark(vE);function dE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([]);case 2:case"end":return e.stop()}},rE)}function mE(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.userId,a=t.experimentKey,r=t.opts,s.next=3,Object(Wh.b)(aE.fetchExperimentVariation,n,a,r);case 3:return o=s.sent,s.next=6,Object(Wh.f)({type:u_.FETCH_EXPERIMENT_VARIATION_FULFILLED,payload:o,meta:{experimentKey:a}});case 6:case"end":return s.stop()}},oE)}function pE(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.userId,a=t.experimentKey,r=t.opts,s.next=3,Object(Wh.b)(aE.postExperimentActivation,n,a,r);case 3:return o=s.sent,s.next=6,Object(Wh.f)({type:u_.POST_EXPERIMENT_ACTIVATION_FULFILLED,payload:o,meta:{experimentKey:a}});case 6:case"end":return s.stop()}},sE)}function fE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(x.BOOTSTRAP_FULFILLED,dE);case 2:case"end":return e.stop()}},iE)}function _E(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(u_.FETCH_EXPERIMENT_VARIATION_START,ev(mE,"FETCH_EXPERIMENT_VARIATION",u_));case 2:case"end":return e.stop()}},cE)}function hE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(u_.POST_EXPERIMENT_ACTIVATION_START,ev(pE,"POST_EXPERIMENT_ACTIVATION",u_));case 2:case"end":return e.stop()}},uE)}function vE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([fE(),_E(),hE()]);case 2:case"end":return e.stop()}},lE)}var EE=n(480),gE=n.n(EE);function bE(e){var t=new FormData;return t.append("uploadFile",e),Object(Wf.e)(function(e){var n=new XMLHttpRequest,a=function(t){if(t.lengthComputable){var n=t.loaded/t.total*100;e({progress:n})}},r=function(t){e({err:new Error("Upload failed")}),e(Wf.a)};return n.upload.addEventListener("progress",a),n.upload.addEventListener("error",r),n.upload.addEventListener("abort",r),n.onreadystatechange=function(){var t=n.readyState,a=n.status,o=n.response;4===t&&(200===a?(e({success:!0,response:JSON.parse(o)}),e(Wf.a)):r())},n.open("POST","".concat(k.REACT_APP_UPLOADER_API_URL,"/file/upload"),!0),n.setRequestHeader("Authorization","Bearer ".concat(function(e){var t=new RegExp(e+"=([^;]+)").exec(document.cookie);return null!=t?unescape(t[1]):null}("_jwt"))),n.send(t),function(){n.upload.removeEventListener("progress",a),n.upload.removeEventListener("error",r),n.upload.removeEventListener("abort",r),n.onreadystatechange=null,n.abort()}},Wf.b.sliding(2))}var OE=Ra.a.mark(AE),SE=Ra.a.mark(RE),IE=Ra.a.mark(CE),yE=Ra.a.mark(NE),TE=Ra.a.mark(kE),jE=Ra.a.mark(LE);function AE(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t="ERROR: Image must be smaller than ".concat(nd(ed),"."),n.next=3,Object(Wh.f)(Qd.imageUploadRejected(e,Error(t)));case 3:return n.next=5,Object(Wh.f)(Ha.addAlert(fp.ERROR,t));case 5:case"end":return n.stop()}},OE)}function RE(e,t){var n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n="ERROR: ".concat(t," files are not supported."),a.next=3,Object(Wh.f)(Qd.imageUploadRejected(e,Error(n)));case 3:return a.next=5,Object(Wh.f)(Ha.addAlert(fp.ERROR,n));case 5:case"end":return a.stop()}},SE)}function CE(e){var t,n,a,r,o,s,i,c,u,l,d,m;return Ra.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(t=e.payload,n=t.file,a=t.fileIdentifierString,p.prev=1,r=n.size,o=n.type,!(r>ed)){p.next=7;break}return p.next=6,Object(Wh.b)(AE,a);case 6:return p.abrupt("return");case 7:if(o in gE()(tc)){p.next=11;break}return p.next=10,Object(Wh.b)(RE,a,o);case 10:return p.abrupt("return");case 11:return p.next=13,Object(Wh.b)(bE,n);case 13:s=p.sent;case 14:return p.next=17,Object(Wh.i)(s);case 17:if(i=p.sent,c=i.progress,u=void 0===c?0:c,l=i.err,d=i.success,m=i.response,!l){p.next=27;break}return p.next=26,Object(Wh.f)(Qd.imageUploadRejected(a,l));case 26:return p.abrupt("return");case 27:if(!d){p.next=31;break}return p.next=30,Object(Wh.f)(Qd.imageUploadSuccess(a,m.attachments));case 30:return p.abrupt("return",m);case 31:return p.next=33,Object(Wh.f)(Qd.imageUploadProgress(a,u));case 33:p.next=14;break;case 35:p.next=41;break;case 37:return p.prev=37,p.t0=p.catch(1),p.next=41,Object(Wh.f)(w(Xd.UPLOAD_IMAGE_REJECTED,p.t0));case 41:return p.prev=41,p.next=44,Object(Wh.d)();case 44:if(!p.sent){p.next=47;break}return p.next=47,Object(Wh.f)(Qd.imageUploadCancelled(a));case 47:return p.finish(41);case 48:case"end":return p.stop()}},IE,null,[[1,37,41,48]])}function NE(e){var t,n,a,r,o,s;return Ra.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=t.fileIdentifierString,a=t.file,i.next=3,Object(Wh.f)(Qd.imageUploadPending(n));case 3:return i.next=5,Object(Wh.g)({response:Object(Wh.b)(CE,{payload:{file:a,fileIdentifierString:n}}),cancel:Object(Wh.i)(Xd.CANCEL_UPLOAD_SAGA)});case 5:if(r=i.sent,o=r.response,s=r.cancel,me()(o)){i.next=12;break}return i.abrupt("return",re()(o,"attachments",[]));case 12:if(me()(s)){i.next=14;break}return i.abrupt("return",!1);case 14:case"end":return i.stop()}},yE)}function kE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Xd.UPLOAD_IMAGE_START,NE);case 2:case"end":return e.stop()}},TE)}function LE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([kE()]);case 2:case"end":return e.stop()}},jE)}var PE=Ra.a.mark(FE),wE=Ra.a.mark(GE),xE=Ra.a.mark(BE),ME=Ra.a.mark(HE),DE=Ra.a.mark(VE),UE=6e4;function FE(){var e,t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.b)(fv.fetchLobby);case 2:return e=n.sent,t=fr(e),n.next=6,Object(Wh.f)({type:$f.GET_LOBBY_FULFILLED,payload:t});case 6:case"end":return n.stop()}},PE)}function GE(){var e,t=arguments;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=t.length>0&&void 0!==t[0]?t[0]:UE;case 1:return n.prev=2,n.next=5,Object(Wh.f)(Rh.getUnreads());case 5:return n.next=7,Object(Wf.d)(e);case 7:n.next=12;break;case 9:return n.prev=9,n.t0=n.catch(2),n.abrupt("return");case 12:n.next=1;break;case 14:case"end":return n.stop()}},wE,null,[[2,9]])}function BE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(Wh.i)($f.POLL_LOBBY_UPDATES_START);case 3:return e.next=5,Object(Wh.g)({poll:Object(Wh.b)(GE),cancel:Object(Wh.i)($f.POLL_LOBBY_UPDATES_CANCEL)});case 5:e.next=0;break;case 7:case"end":return e.stop()}},xE)}function HE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)($f.GET_LOBBY_START,ev(FE,"GET_LOBBY",$f));case 2:case"end":return e.stop()}},ME)}function VE(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([HE(),BE()]);case 2:case"end":return e.stop()}},DE)}var zE=n(481),WE=n.n(zE),YE=function(e,t){return Ll(k.REACT_APP_COMMUNITY_API_URL,e,t)},qE=function(e,t,n){return Pl(k.REACT_APP_COMMUNITY_API_URL,e,t,n)},KE=function(e,t){return wl(k.REACT_APP_COMMUNITY_API_URL,e,t)},JE={fetchRoom:function(e){return YE("/rooms/".concat(encodeURIComponent(e)))},fetchNewThread:function(e,t){return YE("/threads/".concat(encodeURIComponent(e),"/").concat(t))},fetchNotifications:function(e){return YE("/unread?rooms=".concat(WE()(e.map(encodeURIComponent))))},fetchMessages:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a={count:arguments.length>3&&void 0!==arguments[3]?arguments[3]:st};return t&&(a.before=t),n&&(a.after=n),YE("/messages/".concat(encodeURIComponent(e)),{params:a})},postMessage:function(e,t){return qE("/messages/".concat(encodeURIComponent(t)),{message:e.content,mentions:e.mentions,attachments:e.attachments})},deleteMessage:function(e,t){return KE("/messages/".concat(t,"/").concat(e))},editMessage:function(e,t,n){var a=n.content,r=n.version,o={mentions:n.mentions,version:r,message:a};return qE("/messages/".concat(e,"/").concat(t),o)},createMessageAction:function(e){return qE("/message-actions",e)},deleteMessageAction:function(e){return KE("/message-actions/".concat(e))},getMessagesByActionType:function(e,t){return YE("/messages/".concat(e,"/message-actions/").concat(t))},replyToMessage:function(e,t,n){return qE("/messages/".concat(encodeURIComponent(t)),{attachments:e.attachments,message:e.content,mentions:e.mentions,reply_to:n})},fetchConnectToken:function(e){return qE("/tokens",{topics:e})},fetchProfile:function(){return YE("/profiles/me")},createProfile:function(e){return qE("/profiles/me",e)},updateProfile:function(e){return qE("/profiles/me/update",e)},fetchProfiles:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t.length)return Promise.resolve([]);var n={user_ids:S_()(t).join(",")};return YE("/profiles/room/".concat(encodeURIComponent(e)),{params:n})},fetchRoomsProfiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return qE("/profiles/rooms",{rooms:e})},fetchParticipants:function(e){return YE("/participants/".concat(encodeURIComponent(e)))},getLinksInfo:function(e,t){var n={content:t};return YE("/messages/links/".concat(encodeURIComponent(e)),{params:n})},fetchNextThreads:function(e,t){return qE("/threads/all",{rooms:e,count:10,cursor:t})}},XE=Ra.a.mark(ag),QE=Ra.a.mark(rg),$E=Ra.a.mark(og),ZE=Ra.a.mark(sg),eg=Ra.a.mark(ig),tg=Ra.a.mark(cg),ng=Ra.a.mark(ug);function ag(e){var t,n,a,r,o,s;return Ra.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=t.roomId,a=t.messageId,i.next=3,Object(Wh.b)(JE.fetchRoom,n);case 3:return r=i.sent,o=Ka(r),i.next=7,Object(Wh.h)(Cr,n);case 7:if(s=i.sent,!a){i.next=13;break}return i.next=11,Object(Wh.f)(no.getPivotMessages(n,a));case 11:i.next=20;break;case 13:if(!(s&&s.unread_count&&s.oldest_message_id)){i.next=18;break}return i.next=16,Object(Wh.f)(no.getPivotMessages(n,s.oldest_message_id));case 16:i.next=20;break;case 18:return i.next=20,Object(Wh.f)(no.getMessages(n));case 20:return i.next=22,Object(Wh.f)(bo.getParticipants(n));case 22:return i.next=24,Object(Wh.f)({type:$r.GET_ROOM_FULFILLED,payload:o});case 24:case"end":return i.stop()}},XE)}function rg(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.roomId,a=t.lastVisited,o.next=3,Object(Wh.b)(fv.updateUnread,n,a);case 3:return r=o.sent,o.next=6,Object(Wh.f)({type:$r.UPDATE_LAST_VISITED_FULFILLED,payload:{roomId:n,lastVisited:a,unreads:Object(N.a)({room_id:n},r)}});case 6:case"end":return o.stop()}},QE)}function og(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload.roomId,r.next=3,Object(Wh.b)(fv.fetchRoomMetaByRoomId,t);case 3:return n=r.sent,a=re()(n,"data.project")||void 0,r.next=7,Object(Wh.f)({type:$r.GET_ROOM_META_FULFILLED,payload:{roomId:t,project:a}});case 7:case"end":return r.stop()}},$E)}function sg(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)($r.GET_ROOM_META_START,ev(og,"GET_ROOM_META",$r));case 2:case"end":return e.stop()}},ZE)}function ig(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)($r.GET_ROOM_START,ev(ag,"GET_ROOM",$r));case 2:case"end":return e.stop()}},eg)}function cg(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)($r.UPDATE_LAST_VISITED_START,ev(rg,"UPDATE_LAST_VISITED",$r));case 2:case"end":return e.stop()}},tg)}function ug(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([ig(),cg(),sg()]);case 2:case"end":return e.stop()}},ng)}var lg=function(e){return{thread_id:e.room_id,topic:Object(N.a)({},e.room_payload)}},dg=Ra.a.mark(Og),mg=Ra.a.mark(Sg),pg=Ra.a.mark(Ig),fg=Ra.a.mark(yg),_g=Ra.a.mark(Tg),hg=Ra.a.mark(jg),vg=Ra.a.mark(Ag),Eg=Ra.a.mark(Rg),gg=Ra.a.mark(Cg),bg=Ra.a.mark(Ng);function Og(e){var t,n,a,r,o,s,i,c,u;return Ra.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload.roomId,l.next=3,Object(Wh.a)([Object(Wh.b)(JE.fetchRoom,t),Object(Wh.b)(Ov,{payload:{roomIds:[t]}})]);case 3:if(n=l.sent,a=Object(ba.a)(n,2),r=a[0],o=a[1],s=o[t],i=lg(r),c=Ys(i),!(s&&s.unread_count&&s.oldest_message_id)){l.next=15;break}return l.next=13,Object(Wh.f)(no.getPivotMessages(t,s.oldest_message_id));case 13:l.next=17;break;case 15:return l.next=17,Object(Wh.f)(no.getMessages(t));case 17:return u=r.room_payload.room_id,l.next=20,Object(Wh.f)(bo.getParticipants(t,u));case 20:return l.next=22,Object(Wh.f)({type:_d.GET_THREAD_FULFILLED,payload:c});case 22:case"end":return l.stop()}},dg)}function Sg(e){var t,n,a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.roomId,a=t.messageId,c.next=3,Object(Wh.e)(ag,{payload:{roomId:n}});case 3:return c.next=5,Object(Wh.b)(JE.fetchNewThread,n,a);case 5:return r=c.sent,o=lg(r),c.next=9,Object(Wh.f)(Qr.getProfiles(n,[o.topic.user_id]));case 9:return s=ar(o.topic),i=s.entities.messages[a],c.next=13,Object(Wh.f)({type:_d.GET_NEW_THREAD_FULFILLED,payload:o,meta:{message:i}});case 13:case"end":return c.stop()}},mg)}function Ig(e){var t,n,a,r,o,s;return Ra.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload.cursor,i.next=3,Object(Wh.h)(Or,{includeConversations:!0});case 3:return n=i.sent,i.next=6,Object(Wh.b)(JE.fetchNextThreads,n,t);case 6:if(a=i.sent,r=qs(a),!(o=ce()(r.entities.threads)).length){i.next=15;break}return i.next=12,Object(Wh.f)(Qr.getRoomsProfiles(o));case 12:return s=o.map(function(e){return e.thread_id}),i.next=15,Object(Wh.b)(Ov,{payload:{roomIds:s}});case 15:return i.abrupt("return",{payload:r});case 16:case"end":return i.stop()}},pg)}function yg(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.b)(Ig,e);case 2:return t=n.sent,n.next=5,Object(Wh.f)(Object(N.a)({type:_d.GET_NEXT_THREADS_FULFILLED},t));case 5:case"end":return n.stop()}},fg)}function Tg(){var e,t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e={payload:{cursor:"0"}},n.next=3,Object(Wh.b)(Ig,e);case 3:return t=n.sent,n.next=6,Object(Wh.f)(Object(N.a)({type:_d.GET_THREADS_FULFILLED},t));case 6:case"end":return n.stop()}},_g)}function jg(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(_d.GET_THREAD_START,ev(Og,"GET_THREAD",_d));case 2:case"end":return e.stop()}},hg)}function Ag(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(_d.GET_NEW_THREAD_START,ev(Sg,"GET_NEW_THREAD",_d));case 2:case"end":return e.stop()}},vg)}function Rg(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(_d.GET_NEXT_THREADS_START,ev(yg,"GET_NEXT_THREADS",_d));case 2:case"end":return e.stop()}},Eg)}function Cg(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(_d.GET_THREADS_START,ev(Tg,"GET_THREADS",_d));case 2:case"end":return e.stop()}},gg)}function Ng(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([jg(),Ag(),Cg(),Rg()]);case 2:case"end":return e.stop()}},bg)}var kg=Ra.a.mark(Mg),Lg=Ra.a.mark(Dg),Pg=Ra.a.mark(Ug),wg=Ra.a.mark(Fg),xg=Ra.a.mark(Gg);function Mg(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.h)(Oi,e);case 2:return t=n.sent,n.abrupt("return",!me()(t));case 4:case"end":return n.stop()}},kg)}function Dg(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=Ee(e.room_id),n=t?e.room_id:e.parent_message_id||e.room_id,s.next=4,Object(Wh.h)(bi);case 4:if(a=s.sent,r=ce()(a),!(o=yo()(r,function(t){return ui(t,e)}))){s.next=10;break}return s.next=10,Object(Wh.f)(no.replacePendingMessage(n,String(o.message_id),e.message_id));case 10:return s.abrupt("return",o||void 0);case 11:case"end":return s.stop()}},Lg)}function Ug(e,t,n){var a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(Wh.h)(Gt);case 2:return a=s.sent,r=new Date(Date.now()).toISOString(),s.next=6,Object(Wh.b)(ci,r,e.content);case 6:return o=s.sent,s.abrupt("return",{content:e.content,created_at:r,message_id:o,message_id_str:o,room_id:t,parent_message_id:n,user_id:a.id,_participant:a.id,_profile:a.id});case 8:case"end":return s.stop()}},Pg)}function Fg(e,t,n){var a,r,o,s,i,c,u,l;return Ra.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,Object(Wh.h)(qr,n);case 2:if(a=d.sent,r=a?"New message in ".concat(a):"New message",!ge(n)){d.next=10;break}return d.next=7,Object(Wh.h)(Jn,e.user_id);case 7:o=d.sent,r="New private message",o&&(s=rn(void 0,o,n),i=s.name,r=i);case 10:c=Ue.get("shouldNotify",t.id),u=!!me()(c)||c,(di(e,t.id)||ge(n))&&u&&(l=mt(e.content||""),wa.pushIfHidden(r,l));case 14:case"end":return d.stop()}},wg)}function Gg(e,t,n){var a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(a=e.created_at,r=e.message_id,o=re()(e,"thread_message_id"),!Ee(n)||!o){c.next=9;break}return c.next=5,Object(Wh.h)(Oi,o);case 5:if(s=c.sent,re()(s,"thread.participants",[]).includes(t.id)){c.next=9;break}return c.abrupt("return");case 9:return i=e.mentions&&e.mentions.includes(t.id),c.next=12,Object(Wh.f)(Rh.incrementRoomUnreads(n,a,r,i));case 12:case"end":return c.stop()}},xg)}var Bg=Ra.a.mark(Tb),Hg=Ra.a.mark(jb),Vg=Ra.a.mark(Ab),zg=Ra.a.mark(Rb),Wg=Ra.a.mark(Cb),Yg=Ra.a.mark(Nb),qg=Ra.a.mark(kb),Kg=Ra.a.mark(Lb),Jg=Ra.a.mark(Pb),Xg=Ra.a.mark(wb),Qg=Ra.a.mark(xb),$g=Ra.a.mark(Mb),Zg=Ra.a.mark(Db),eb=Ra.a.mark(Ub),tb=Ra.a.mark(Fb),nb=Ra.a.mark(Gb),ab=Ra.a.mark(Bb),rb=Ra.a.mark(Hb),ob=Ra.a.mark(Vb),sb=Ra.a.mark(zb),ib=Ra.a.mark(Wb),cb=Ra.a.mark(Yb),ub=Ra.a.mark(qb),lb=Ra.a.mark(Kb),db=Ra.a.mark(Jb),mb=Ra.a.mark(Xb),pb=Ra.a.mark(Qb),fb=Ra.a.mark($b),_b=Ra.a.mark(Zb),hb=Ra.a.mark(eO),vb=Ra.a.mark(tO),Eb=Ra.a.mark(nO),gb=Ra.a.mark(aO),bb=Ra.a.mark(rO),Ob=Ra.a.mark(oO),Sb=Ra.a.mark(sO),Ib=Ra.a.mark(iO),yb=Ra.a.mark(cO);function Tb(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.b)(Cb,e);case 2:return t=n.sent,n.next=5,Object(Wh.f)({type:to.GET_PREV_MESSAGES_FULFILLED,payload:t,meta:e.payload});case 5:case"end":return n.stop()}},Bg)}function jb(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Wh.b)(Cb,Object(N.a)({},e,{payload:Object(N.a)({},e.payload,{count:st+1})}));case 2:return t=a.sent,n=Object(N.a)({},t,{result:Object(N.a)({},t.result,{messages:t.result.messages.slice(1)})}),a.next=6,Object(Wh.f)({type:to.GET_NEXT_MESSAGES_FULFILLED,payload:n,meta:e.payload});case 6:case"end":return a.stop()}},Hg)}function Ab(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Wh.b)(Cb,e);case 2:return t=r.sent,r.next=5,Object(Wh.b)(Cb,Object(N.a)({},e,{payload:Object(N.a)({},e.payload,{prevMessageId:e.payload.nextMessageId,nextMessageId:void 0})}));case 5:return n=r.sent,a=sr([n,t]),r.next=9,Object(Wh.f)({type:to.GET_PIVOT_MESSAGES_FULFILLED,payload:a,meta:e.payload});case 9:case"end":return r.stop()}},Vg)}function Rb(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.b)(Cb,e);case 2:return t=n.sent,n.next=5,Object(Wh.f)({type:to.GET_MESSAGES_FULFILLED,payload:t,meta:e.payload});case 5:case"end":return n.stop()}},zg)}function Cb(e){var t,n,a,r,o,s,i,c,u,l,d;return Ra.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.payload,n=t.roomId,a=t.prevMessageId,r=t.nextMessageId,o=t.count,s=a?String(a):void 0,i=r?String(r):void 0,m.next=5,Object(Wh.b)(JE.fetchMessages,n,s,i,o);case 5:return c=m.sent,u=nr(c),l=c.messages.map(function(e){return e.user_id}),m.next=10,Object(Wh.f)(Qr.getProfiles(n,l));case 10:if(!(d=mi(c.messages)).length){m.next=14;break}return m.next=14,Object(Wh.f)(Rh.getRoomsUnreads(d));case 14:return m.abrupt("return",u);case 15:case"end":return m.stop()}},Wg)}function Nb(e){var t,n,a,r,o,s,i,c,u,l,d;return Ra.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(t=e.payload,n=t.roomId,a=t.message,r=t.parentRoomId,o=e.normalizedMessage,s=e.me,!r||!a.mentions){m.next=9;break}if(i=a.mentions,c=n,!i.includes(s.id)){m.next=9;break}return m.next=7,Object(Wh.b)(Og,hd.getThread(c));case 7:return m.next=9,Object(Wh.f)(hd.addNewThreadId(c));case 9:if(u=a.message_id,l=a.content,d=a.user_id,!lt(l||"")){m.next=13;break}return m.next=13,Object(Wh.f)(no.getLinksInfo(u,l||""));case 13:if(!ge(n)){m.next=22;break}return m.next=16,Object(Wh.h)(Ir,n);case 16:if(m.sent){m.next=20;break}return m.next=20,Object(Wh.f)(Zf.getLobby());case 20:return m.next=22,Object(Wh.f)(wr.setConversationRecency(n));case 22:return m.next=24,Object(Wh.f)(Qr.getProfiles(n,[d]));case 24:if(s.id===d){m.next=29;break}return m.next=27,Gg(a,s,n);case 27:return m.next=29,Fg(a,s,n);case 29:return m.next=31,Object(Wh.f)(no.mergeNewMessageById(o));case 31:case"end":return m.stop()}},Yg)}function kb(e){var t,n,a,r,o,s,i,c;return Ra.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=e.payload,n=t.roomId,a=t.message,r=t.roomSerialId,o=ar(Object(N.a)({},a,{room_id:n,room_serial_id:r})),u.next=4,Mg(a.message_id);case 4:return s=u.sent,u.next=7,Object(Wh.h)(Gt);case 7:if(i=u.sent,c=i.id===a.user_id,s){u.next=12;break}return u.next=12,Object(Wh.b)(Nb,Object(N.a)({},e,{me:i,normalizedMessage:o}));case 12:return u.next=14,Object(Wh.b)(Dg,Object(N.a)({},a,{room_id:n}));case 14:return u.next=16,Object(Wh.f)({type:to.RECEIVE_MESSAGE_FULFILLED,payload:o,meta:{payload:Object(N.a)({},e.payload),isNewMessage:!s,isMe:c}});case 16:case"end":return u.stop()}},qg)}function Lb(e){var t,n,a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.roomId,a=t.messageId,r=t.message,c.next=3,Object(Wh.b)(JE.replyToMessage,r,n,a);case 3:return o=c.sent,s=o.room_id,c.next=7,Object(Wh.h)(Zs,s);case 7:if(i=c.sent,!me()(i)){c.next=13;break}return c.next=11,Object(Wh.b)(Og,hd.getThread(s));case 11:return c.next=13,Object(Wh.f)(hd.addNewThreadId(s));case 13:return c.next=15,Object(Wh.f)(no.receiveMessage(s,o.room_serial_id,o,n));case 15:return c.next=17,Object(Wh.f)({type:to.REPLY_TO_MESSAGE_FULFILLED,meta:Object(N.a)({},e.payload,{response:o})});case 17:case"end":return c.stop()}},Kg)}function Pb(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.roomId,a=t.message,o.next=3,Object(Wh.b)(JE.postMessage,a,n);case 3:return r=o.sent,o.next=6,Object(Wh.f)(no.receiveMessage(n,r.room_serial_id,r));case 6:return o.next=8,Object(Wh.f)({type:to.POST_MESSAGE_FULFILLED,meta:e.payload});case 8:case"end":return o.stop()}},Jg)}function wb(e){var t,n,a,r,o,s,i,c,u;return Ra.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=e.payload,n=t.roomId,a=t.message,r=t.messageId,!(o=t.pendingMessageId)){l.next=5;break}return l.next=4,Object(Wh.h)(gi,o);case 4:s=l.sent;case 5:if(!(!o||o&&me()(s))){l.next=9;break}return l.next=8,Object(Wh.b)(Ug,a,n,r);case 8:s=l.sent;case 9:return l.prev=9,l.next=12,Object(Wh.f)({type:to.POST_MESSAGE_PENDING,payload:{message:s}});case 12:return l.next=14,Object(Wf.d)(10);case 14:if(Pa.track(Ta.SendMessage,{roomId:n,messageId:r}),i=Ee(n),!r){l.next=22;break}return Pa.track(Ta.CreateThread,{roomId:n}),l.next=20,Object(Wh.b)(Lb,{payload:{message:a,messageId:r,roomId:n}});case 20:l.next=33;break;case 22:if(r||!i){l.next=31;break}return l.next=25,Object(Wh.h)(Zs,n);case 25:return c=l.sent,u=c.topic||{},l.next=29,Object(Wh.b)(Lb,{payload:{message:a,messageId:u.message_id,roomId:u.room_id}});case 29:l.next=33;break;case 31:return l.next=33,Object(Wh.b)(Pb,{payload:{message:a,roomId:n}});case 33:l.next=39;break;case 35:return l.prev=35,l.t0=l.catch(9),l.next=39,Object(Wh.f)({type:to.POST_MESSAGE_REJECTED,payload:Object(N.a)({},e.payload,{message:s,error:l.t0})});case 39:case"end":return l.stop()}},Xg,null,[[9,35]])}function xb(e){var t,n,a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.roomId,a=t.file,r=t.messageId,o=td(a),c.next=4,Object(Wh.b)(NE,{payload:{file:a,fileIdentifierString:o}});case 4:if(s=c.sent,le()(s)){c.next=9;break}return i={attachments:s},c.next=9,Object(Wh.b)(wb,{payload:{roomId:n,message:i,messageId:r}});case 9:case"end":return c.stop()}},Qg)}function Mb(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.messageId,a=t.content,o.next=3,Object(Wh.b)(JE.getLinksInfo,String(n),a);case 3:return r=o.sent,o.next=6,Object(Wh.f)({type:to.GET_LINKS_INFO_FULFILLED,payload:r});case 6:case"end":return o.stop()}},$g)}function Db(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.messageId,a=t.roomId,Pa.track(Ta.DeleteMessage,{roomId:a,messageId:n}),o.next=4,Object(Wh.b)(JE.deleteMessage,n,a);case 4:return r=o.sent,o.next=7,Object(Wh.f)({type:to.DELETE_MESSAGE_FULFILLED,payload:r});case 7:case"end":return o.stop()}},Zg)}function Ub(e){var t,n,a,r,o,s,i,c;return Ra.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return t=e.payload,Pa.track(Ta.CreateMessageAction,{messageAction:t}),u.next=4,Object(Wh.b)(JE.createMessageAction,t);case 4:return n=u.sent,u.next=7,Object(Wh.h)(pi,t.message_id);case 7:return a=u.sent,r=a.message_actions,o=void 0===r?[]:r,u.next=11,Object(Wh.h)(ln,a.user_id);case 11:s=u.sent;case 12:if(s){u.next=20;break}return u.next=15,Object(Wh.i)();case 15:return u.next=17,Object(Wh.h)(ln,a.user_id);case 17:s=u.sent,u.next=12;break;case 20:return u.next=22,Object(Wh.h)(Jn,a.user_id);case 22:i=u.sent;case 23:if(i){u.next=31;break}return u.next=26,Object(Wh.i)();case 26:return u.next=28,Object(Wh.h)(Jn,a.user_id);case 28:i=u.sent,u.next=23;break;case 31:return c=Object(N.a)({},a,{_participant:s,_profile:i,message_actions:[].concat(Object(yt.a)(o),[n])}),u.next=34,Object(Wh.f)({type:to.CREATE_MESSAGE_ACTION_FULFILLED,payload:{action:n,message:c}});case 34:case"end":return u.stop()}},eb)}function Fb(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload.messageActionId,Pa.track(Ta.DeleteMessageAction,{messageActionId:t}),a.next=4,Object(Wh.b)(JE.deleteMessageAction,t);case 4:return n=a.sent,a.next=7,Object(Wh.f)({type:to.DELETE_MESSAGE_ACTION_FULFILLED,payload:n});case 7:case"end":return a.stop()}},tb)}function Gb(e){var t,n,a,r,o,s,i,c,u,l,d,m,p;return Ra.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.payload,n=t.roomId,a=t.actionType,f.next=3,Object(Wh.b)(JE.getMessagesByActionType,n,a);case 3:r=f.sent,o=[],s=!0,i=!1,c=void 0,f.prev=8,u=r[Symbol.iterator]();case 10:if(s=(l=u.next()).done){f.next=38;break}return d=l.value,f.next=14,Object(Wh.h)(ln,d.user_id);case 14:m=f.sent;case 15:if(m){f.next=23;break}return f.next=18,Object(Wh.i)();case 18:return f.next=20,Object(Wh.h)(ln,d.user_id);case 20:m=f.sent,f.next=15;break;case 23:return f.next=25,Object(Wh.h)(Jn,d.user_id);case 25:p=f.sent;case 26:if(p){f.next=34;break}return f.next=29,Object(Wh.i)();case 29:return f.next=31,Object(Wh.h)(Jn,d.user_id);case 31:p=f.sent,f.next=26;break;case 34:o.push(Object(N.a)({},d,{room_id:n,_participant:m,_profile:p}));case 35:s=!0,f.next=10;break;case 38:f.next=44;break;case 40:f.prev=40,f.t0=f.catch(8),i=!0,c=f.t0;case 44:f.prev=44,f.prev=45,s||null==u.return||u.return();case 47:if(f.prev=47,!i){f.next=50;break}throw c;case 50:return f.finish(47);case 51:return f.finish(44);case 52:return f.next=54,Object(Wh.f)({type:to.GET_MESSAGES_BY_ACTION_FULFILLED,payload:{actionType:a,roomId:n,messages:o}});case 54:case"end":return f.stop()}},nb,null,[[8,40,44,52],[45,,47,51]])}function Bb(e){var t,n,a,r,o,s,i,c,u,l,d;return Ra.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.payload,n=t.roomId,a=t.messageAction,m.next=3,Object(Wh.h)(Gt);case 3:return r=m.sent,o=r.id===a.user_id,m.next=7,Object(Wh.h)(pi,a.message_id);case 7:return s=m.sent,i=s.message_actions,c=void 0===i?[]:i,m.next=11,Object(Wh.h)(ln,s.user_id);case 11:u=m.sent;case 12:if(u){m.next=20;break}return m.next=15,Object(Wh.i)();case 15:return m.next=17,Object(Wh.h)(ln,s.user_id);case 17:u=m.sent,m.next=12;break;case 20:return m.next=22,Object(Wh.h)(Jn,s.user_id);case 22:l=m.sent;case 23:if(l){m.next=31;break}return m.next=26,Object(Wh.i)();case 26:return m.next=28,Object(Wh.h)(Jn,s.user_id);case 28:l=m.sent,m.next=23;break;case 31:return d=Object(N.a)({},s,{_participant:u,_profile:l,message_actions:[].concat(Object(yt.a)(c),[a])}),m.next=34,Object(Wh.f)({type:to.RECEIVE_MESSAGE_ACTION_FULFILLED,payload:{roomId:n,action:a,message:d,isMe:o}});case 34:case"end":return m.stop()}},ab)}function Hb(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.messageId,a=t.roomId,r=t.message,Pa.track(Ta.EditMessage,{roomId:a,messageId:n}),s.next=4,Object(Wh.b)(JE.editMessage,a,n,r);case 4:return o=s.sent,s.next=7,Object(Wh.f)({type:to.EDIT_MESSAGE_FULFILLED,payload:o});case 7:case"end":return s.stop()}},rb)}function Vb(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.message,Pa.track(Ta.ResendPendingMessage,{roomId:t.room_id}),n.next=4,Object(Wh.b)(wb,{payload:Object(N.a)({message:t,roomId:t.room_id,pendingMessageId:t.message_id},t.parent_message_id&&{messageId:t.parent_message_id})});case 4:return n.next=6,Object(Wh.f)({type:to.RESEND_PENDING_MESSAGE_FULFILLED,payload:e.payload});case 6:case"end":return n.stop()}},ob)}function zb(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.message,Pa.track(Ta.CancelPendingMessage,{roomId:t.room_id}),n.next=4,Object(Wh.f)({type:to.CANCEL_PENDING_MESSAGE_FULFILLED,payload:e.payload});case 4:case"end":return n.stop()}},sb)}function Wb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.GET_MESSAGES_START,ev(Rb,"GET_MESSAGES",to));case 2:case"end":return e.stop()}},ib)}function Yb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.GET_PREV_MESSAGES_START,ev(Tb,"GET_PREV_MESSAGES",to));case 2:case"end":return e.stop()}},cb)}function qb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.GET_NEXT_MESSAGES_START,ev(jb,"GET_NEXT_MESSAGES",to));case 2:case"end":return e.stop()}},ub)}function Kb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.GET_PIVOT_MESSAGES_START,ev(Ab,"GET_PIVOT_MESSAGES",to));case 2:case"end":return e.stop()}},lb)}function Jb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.RECEIVE_MESSAGE_START,ev(kb,"RECEIVE_MESSAGE",to));case 2:case"end":return e.stop()}},db)}function Xb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.POST_MESSAGE_START,wb);case 2:case"end":return e.stop()}},mb)}function Qb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.POST_IMAGE_MESSAGE_START,xb);case 2:case"end":return e.stop()}},pb)}function $b(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.REPLY_TO_MESSAGE_START,ev(Lb,"REPLY_TO_MESSAGE",to));case 2:case"end":return e.stop()}},fb)}function Zb(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.GET_LINKS_INFO_START,ev(Mb,"GET_LINKS_INFO",to));case 2:case"end":return e.stop()}},_b)}function eO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.DELETE_MESSAGE_START,ev(Db,"DELETE_MESSAGE",to));case 2:case"end":return e.stop()}},hb)}function tO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.DELETE_MESSAGE_ACTION_START,ev(Fb,"DELETE_MESSAGE_ACTION",to));case 2:case"end":return e.stop()}},vb)}function nO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.CREATE_MESSAGE_ACTION_START,ev(Ub,"CREATE_MESSAGE_ACTION",to));case 2:case"end":return e.stop()}},Eb)}function aO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(to.GET_MESSAGES_BY_ACTION_START,ev(Gb,"GET_MESSAGES_BY_ACTION",to));case 2:case"end":return e.stop()}},gb)}function rO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.RECEIVE_MESSAGE_ACTION_START,ev(Bb,"RECEIVE_MESSAGE_ACTION",to));case 2:case"end":return e.stop()}},bb)}function oO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.EDIT_MESSAGE_START,ev(Hb,"EDIT_MESSAGE",to));case 2:case"end":return e.stop()}},Ob)}function sO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.RESEND_PENDING_MESSAGE_START,ev(Vb,"RESEND_PENDING_MESSAGE",to));case 2:case"end":return e.stop()}},Sb)}function iO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(to.CANCEL_PENDING_MESSAGE_START,ev(zb,"CANCEL_PENDING_MESSAGE",to));case 2:case"end":return e.stop()}},Ib)}function cO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([Wb(),Yb(),qb(),Kb(),Jb(),Xb(),Qb(),$b(),Zb(),eO(),oO(),sO(),iO(),nO(),tO(),aO(),rO()]);case 2:case"end":return e.stop()}},yb)}var uO="{\n  can_see_career_portal,\n  has_enterprise_enrollments,\n  graduated_nanodegrees_count,\n  subscribed_nanodegrees_count,\n  image_url\n}",lO=k.REACT_APP_NAME,dO=function(e){return xl(k.REACT_APP_CLASSROOM_API_URL,e)};function mO(e){var t="query fetchClassroomUserMetadata($userId: String!) {\n    user(id: $userId) ".concat(uO,"\n  }\n  ");return dO({query:t,variables:{userId:e}})}var pO=function(){var e=Object(Ca.a)(Ra.a.mark(function e(t){var n,a;return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="\n    query ".concat(lO,"_FetchNanodegree($key: String!) {\n      nanodegree(key: $key) {\n        locale\n        title\n        version\n        key\n        id\n      }\n    }\n  "),a={key:t},e.next=4,dO({query:n,variables:a});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fO=Ra.a.mark(vO),_O=Ra.a.mark(EO),hO=Ra.a.mark(gO);function vO(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload.ndKey,r.next=3,Object(Wh.b)(pO,t);case 3:return n=r.sent,a=n.data,r.next=7,Object(Wh.f)({type:ep.GET_NANODEGREE_FULFILLED,payload:a});case 7:case"end":return r.stop()}},fO)}function EO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(ep.GET_NANODEGREE_START,ev(vO,"GET_NANODEGREE",ep));case 2:case"end":return e.stop()}},_O)}function gO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([EO()]);case 2:case"end":return e.stop()}},hO)}var bO=n(482),OO=n.n(bO),SO=Ra.a.mark(kO),IO=Ra.a.mark(LO),yO=Ra.a.mark(PO),TO=Ra.a.mark(wO),jO=Ra.a.mark(xO),AO=Ra.a.mark(MO),RO=Ra.a.mark(DO),CO=Ra.a.mark(UO),NO=Ra.a.mark(FO);function kO(e){var t,n,a,r,o,s,i,c,u,l,d,m,p,f,_,h;return Ra.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return t=e.payload,n=t.roomId,a=t.parentRoomId,v.next=3,Object(Wh.b)(JE.fetchParticipants,n);case 3:return r=v.sent,o=tn(r),s=o.result,i=s.admins,c=void 0===i?[]:i,u=s.active,l=void 0===u?[]:u,d=s.inactive,m=void 0===d?[]:d,p=[].concat(Object(yt.a)(c),Object(yt.a)(l),Object(yt.a)(m)),f=Et(Object(yt.a)(p)),v.next=10,Object(Wh.f)(Qr.getProfiles(n,f));case 10:return v.next=12,Object(Wh.f)({type:go.GET_PARTICIPANTS_FULFILLED,payload:o});case 12:if(!a){v.next=19;break}return v.next=15,Object(Wh.b)(JE.fetchParticipants,a);case 15:return _=v.sent,h=tn(_),v.next=19,Object(Wh.f)({type:go.GET_PARTICIPANTS_FULFILLED,payload:h});case 19:case"end":return v.stop()}},SO)}function LO(e){var t,n,a,r,o;return Ra.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.payload,n=t.roomId,a=t.search,s.next=3,Object(Wh.b)(fv.searchRoomParticipants,{room_id:n,count:50,search:a});case 3:return r=s.sent,o=OO()(r.data.participants.participants,function(e){return e.id}),s.next=7,Object(Wh.f)(Qr.getProfiles(n,o));case 7:return s.next=9,Object(Wh.f)({type:go.SEARCH_PARTICIPANTS_FULFILLED,payload:r.data.participants,meta:{roomId:n}});case 9:case"end":return s.stop()}},IO)}function PO(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.roomId,a=t.search,o.next=3,Object(Wh.b)(fv.searchRoomParticipants,{room_id:n,search:a});case 3:return r=o.sent,o.next=6,Object(Wh.f)({type:go.SEARCH_PARTICIPANTS_TO_MENTION_FULFILLED,payload:r.data.participants,meta:{roomId:n}});case 6:case"end":return o.stop()}},yO)}function wO(e){var t,n,a,r,o,s;return Ra.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=t.userId,a=t.roomId,r=t.isActive,i.next=3,Object(Wh.h)(Gt);case 3:return o=i.sent,s=n===o.id,i.next=7,Object(Wh.f)({type:go.SET_PARTICIPANT_STATUS_FULFILLED,payload:{userId:n,roomId:a,isActive:r,isMe:s}});case 7:case"end":return i.stop()}},TO)}function xO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(go.SET_PARTICIPANT_STATUS_START,ev(wO,"SET_PARTICIPANT_STATUS",go));case 2:case"end":return e.stop()}},jO)}function MO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.l)(100,go.SEARCH_PARTICIPANTS_START,ev(LO,"SEARCH_PARTICIPANTS",go));case 2:case"end":return e.stop()}},AO)}function DO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.l)(100,go.SEARCH_PARTICIPANTS_TO_MENTION_START,ev(PO,"SEARCH_PARTICIPANTS_TO_MENTION",go));case 2:case"end":return e.stop()}},RO)}function UO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(go.GET_PARTICIPANTS_START,ev(kO,"GET_PARTICIPANTS",go));case 2:case"end":return e.stop()}},CO)}function FO(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([UO(),MO(),DO(),xO()]);case 2:case"end":return e.stop()}},NO)}var GO=Ra.a.mark(BO);function BO(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.h)(Kn);case 2:return t=n.sent,n.abrupt("return",e.reduce(function(e,n){var a=[].concat(Object(yt.a)(n._threadParticipants),[n._threadAuthorParticipant]),r=HO(t,a);return r.length&&e.push({room_id:n.thread_id,users:r}),e},[]));case 4:case"end":return n.stop()}},GO)}function HO(e,t){return t.filter(function(t){return!e.includes(t)})}var VO=Ra.a.mark($O),zO=Ra.a.mark(ZO),WO=Ra.a.mark(eS),YO=Ra.a.mark(tS),qO=Ra.a.mark(nS),KO=Ra.a.mark(aS),JO=Ra.a.mark(rS),XO=Ra.a.mark(oS),QO=Ra.a.mark(sS);function $O(e){var t,n,a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.roomId,a=t.userIds,c.next=3,Object(Wh.h)(Kn);case 3:if(r=c.sent,o=HO(r,a),s=[],!o.length){c.next=10;break}return c.next=9,Object(Wh.b)(JE.fetchProfiles,n,o);case 9:s=c.sent;case 10:return i=$t(s),c.next=13,Object(Wh.f)({type:Xr.GET_PROFILES_FULFILLED,payload:i});case 13:case"end":return c.stop()}},VO)}function ZO(e){var t,n,a,r,o,s,i,c,u,l,d;return Ra.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.payload,n=t.roomId,a=t.index,m.next=3,Object(Wh.h)(_n,n);case 3:return r=m.sent,o=r.admins,s=r.active,i=r.inactive,c=[].concat(Object(yt.a)(o),Object(yt.a)(s),Object(yt.a)(i)),m.next=10,Object(Wh.b)(Et,c,a);case 10:return u=m.sent,m.next=13,Object(Wh.h)(Kn);case 13:return l=m.sent,m.next=16,Object(Wh.b)(HO,l,u);case 16:return d=m.sent,m.next=19,Object(Wh.f)(Qr.getProfiles(n,d));case 19:case"end":return m.stop()}},zO)}function eS(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload.threads,o.next=3,Object(Wh.b)(BO,t);case 3:if(!(n=o.sent).length){o.next=12;break}return a=[],o.next=8,Object(Wh.b)(JE.fetchRoomsProfiles,n);case 8:return a=o.sent,r=$t(a),o.next=12,Object(Wh.f)({type:Xr.GET_ROOMS_PROFILES_FULFILLED,payload:r});case 12:case"end":return o.stop()}},WO)}function tS(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload.userId,a.next=3,Object(Wh.b)(fv.fetchAdditionalProfileInfo,t);case 3:return n=a.sent,a.next=6,Object(Wh.f)({type:Xr.GET_ADDITIONAL_INFO_FULFILLED,payload:n,meta:Object(N.a)({},e.payload)});case 6:case"end":return a.stop()}},YO)}function nS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Xr.GET_PROFILES_START,ev($O,"GET_PROFILES",Xr));case 2:case"end":return e.stop()}},qO)}function aS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Xr.GET_ROOMS_PROFILES_START,ev(eS,"GET_ROOMS_PROFILES",Xr));case 2:case"end":return e.stop()}},KO)}function rS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Xr.RESOLVE_ADDITIONAL_PROFILES,ZO);case 2:case"end":return e.stop()}},JO)}function oS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Xr.GET_ADDITIONAL_INFO_START,ev(tS,"GET_ADDITIONAL_INFO",Xr));case 2:case"end":return e.stop()}},XO)}function sS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([nS(),aS(),rS(),oS()]);case 2:case"end":return e.stop()}},QO)}var iS=Ra.a.mark(hS),cS=Ra.a.mark(vS),uS=Ra.a.mark(ES),lS=Ra.a.mark(gS),dS=Ra.a.mark(bS),mS=Ra.a.mark(OS),pS=Ra.a.mark(SS),fS=Ra.a.mark(IS),_S=Ra.a.mark(yS);function hS(){var e,t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.b)(fv.fetchPendingRatings);case 2:return e=n.sent,t=re()(e,"data.user.project_mentor_ratings_due")||void 0,n.next=6,Object(Wh.f)({type:Hr.GET_PENDING_RATINGS_FULFILLED,payload:t});case 6:case"end":return n.stop()}},iS)}function vS(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Wh.b)(fv.fetchRatingsByRoomId,e.payload.roomId);case 2:return t=a.sent,n=re()(t,"data.user.project_mentor_ratings_due")||void 0,a.next=6,Object(Wh.f)({type:Hr.GET_ROOM_RATINGS_FULFILLED,payload:n,meta:Object(N.a)({},e.payload)});case 6:case"end":return a.stop()}},cS)}function ES(e){var t,n,a,r,o,s,i;return Ra.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.roomId,a=t.mentorId,r=t.userId,o=t.rating,c.next=3,Object(Wh.b)(fv.mutateMentorRating,a,r,n,o);case 3:return s=c.sent,i=re()(s,"data.create_project_mentor_rating")||void 0,c.next=7,Object(Wh.f)({type:Hr.MUTATE_MENTOR_RATING_FULFILLED,payload:i,meta:Object(N.a)({},e.payload)});case 7:case"end":return c.stop()}},uS)}function gS(e){var t,n,a,r;return Ra.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.roomId,a=t.participantIds,o.next=3,Object(Wh.b)(fv.fetchPassedUsersByRoomId,n,a);case 3:return r=o.sent,o.next=6,Object(Wh.f)({type:Hr.GET_PASSED_USERS_FULFILLED,payload:r||void 0,meta:Object(N.a)({},e.payload)});case 6:case"end":return o.stop()}},lS)}function bS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Hr.GET_PENDING_RATINGS_START,ev(hS,"GET_PENDING_RATINGS",Hr));case 2:case"end":return e.stop()}},dS)}function OS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Hr.GET_ROOM_RATINGS_START,ev(vS,"GET_ROOM_RATINGS",Hr));case 2:case"end":return e.stop()}},mS)}function SS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(Hr.MUTATE_MENTOR_RATING_START,ev(ES,"MUTATE_MENTOR_RATING",Hr));case 2:case"end":return e.stop()}},pS)}function IS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.k)(Hr.GET_PASSED_USERS_START,ev(gS,"GET_PASSED_USERS",Hr));case 2:case"end":return e.stop()}},fS)}function yS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([bS(),OS(),SS(),IS()]);case 2:case"end":return e.stop()}},_S)}var TS={getStatuspageComponents:function(){return e="/components.json",Ll(k.REACT_APP_STATUSPAGE_API_URL,e);var e}},jS=function(e){if(le()(e))return"operational";var t=yo()(e,function(e){return e.id===k.REACT_APP_STATUSPAGE_STUDENTHUB_ID});return t?t.status:"operational"},AS=Ra.a.mark(DS),RS=Ra.a.mark(US),CS=Ra.a.mark(FS),NS=Ra.a.mark(GS),kS=Ra.a.mark(BS),LS=Ra.a.mark(HS),PS=Ra.a.mark(VS),wS=Ra.a.mark(zS),xS=Ra.a.mark(WS),MS=Ra.a.mark(YS);function DS(){var e,t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Wh.b)(fv.syncLobby);case 3:return a.next=5,Object(Wh.a)([Object(Wh.b)(JE.fetchProfile),Object(Wh.b)(FE,Zf.getLobby())]);case 5:return e=a.sent,t=Object(ba.a)(e,1),n=t[0],Pa.identify({id:n.id}),a.next=11,Object(Wh.f)(Zf.cancelPollLobbyUpdates());case 11:return a.next=13,Object(Wh.f)(Zf.startPollLobbyUpdates());case 13:return a.next=15,Object(Wh.e)(FS);case 15:return a.next=17,Object(Wh.f)({payload:{me:n},type:x.BOOTSTRAP_FULFILLED});case 17:a.next=23;break;case 19:return a.prev=19,a.t0=a.catch(0),a.next=23,Object(Wh.f)(w(x.BOOTSTRAP_REJECTED,a.t0));case 23:case"end":return a.stop()}},AS,null,[[0,19]])}function US(e){var t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload.userId,r.next=3,Object(Wh.b)(mO,t);case 3:return n=r.sent,a=n.data,r.next=7,Object(Wh.f)({type:x.FETCH_CLASSROOM_METADATA_FULFILLED,payload:a});case 7:case"end":return r.stop()}},RS)}function FS(){var e,t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Wh.b)(TS.getStatuspageComponents);case 2:return e=n.sent,t="operational",e&&e.components&&(t=jS(e.components)),n.next=7,Object(Wh.f)({type:x.FETCH_STATUS_FULFILLED,payload:t});case 7:case"end":return n.stop()}},CS)}function GS(){var e;return Ra.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Wh.b)(JE.fetchProfile);case 2:return e=t.sent,t.next=5,Object(Wh.f)({type:x.FETCH_ME_FULFILLED,payload:{me:e}});case 5:case"end":return t.stop()}},NS)}function BS(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload.profile,a.next=3,Object(Wh.b)(JE.updateProfile,t);case 3:return n=a.sent,a.next=6,Object(Wh.f)({type:x.UPDATE_ME_FULFILLED,payload:n});case 6:case"end":return a.stop()}},kS)}function HS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(x.BOOTSTRAP_PENDING,DS);case 2:case"end":return e.stop()}},LS)}function VS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(x.FETCH_ME_START,GS);case 2:case"end":return e.stop()}},PS)}function zS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(x.UPDATE_ME_START,ev(BS,"UPDATE_ME",x));case 2:case"end":return e.stop()}},wS)}function WS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)(x.FETCH_CLASSROOM_METADATA_START,ev(US,"FETCH_CLASSROOM_METADATA",x));case 2:case"end":return e.stop()}},xS)}function YS(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([HS(),VS(),zS(),WS()]);case 2:case"end":return e.stop()}},MS)}var qS=n(483),KS={minReconnectionDelay:50,reconnectionDelayGrowFactor:2,debug:"production"!==k.REACT_APP_ENV},JS=function(){function e(t,n,a,r){Object(i.a)(this,e),this.websocketUrl=void 0,this.userId=void 0,this.rooms=void 0,this.authenticated=void 0,this.authenticationError=void 0,this.authenticationTokenErrors=void 0,this.socket=void 0,this.heartbeat=void 0,this.events=void 0,this.navigator=void 0,this.websocketUrl=t,this.userId=n,this.rooms=a,this.authenticated=!1,this.authenticationError=!1,this.authenticationTokenErrors=0,this.events={},this.navigator=r}return Object(c.a)(e,[{key:"initialize",value:function(){var e=this;if(!this.socket){this.socket=new qS.a(this.websocketUrl,[],KS),this.socket.onopen=function(){e.authenticateConnection()},this.socket.onclose=function(t){1008===t.code&&(e.authenticationError=!0,e.socket.close(1e3,"client disconnected",{keepClosed:!0,fastClose:!0})),e.authenticated=!1},this.socket.onmessage=function(t){var n;try{n=JSON.parse(t.data)}catch(t){throw new Error("Error parsing : ".concat(t.data))}var a=n.version,r="v1.3.0".split(".").slice(0,-1).join("."),o=a.includes(r);switch(n.type){case"accepted":return e.authenticated=!0,e.authenticationError=!1,void e.emit("authenticated");case"joined":case"quit":case"message":case"message_action":case"delete_message_action":case"delete":case"edit":case"active_users":case"reply":if(!o)return;break;default:return}e.emit("message",n)};this.heartbeat=setInterval(function(){var t=e.connected();e.emit("ping",t)},100)}}},{key:"close",value:function(){this.heartbeat&&clearInterval(this.heartbeat),this.socket&&this.socket.close(1e3,"client disconnected",{keepClosed:!0})}},{key:"connected",value:function(){return!!this.socket&&(this.authenticated&&this.socket.readyState===WebSocket.OPEN&&this.navigator.onLine)}},{key:"on",value:function(e,t){return this.events[e]?this.events[e].push(t):this.events[e]=[t],this}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return this.events[e]?(this.events[e].forEach(function(e){e.apply(void 0,n)}),this):this}},{key:"authenticateConnection",value:function(){var e=this;return JE.fetchConnectToken(this.rooms).then(function(t){e.authenticationTokenErrors=0;var n={type:"handshake",version:"v1.3.0",payload:{user_id:e.userId,rooms:e.rooms,challenge_token:t}};e.socket.send(JSON.stringify(n))}).catch(function(){e.authenticationTokenErrors++,e.authenticationError=!0,e.authenticationTokenErrors>=3?e.socket.close(1e3,"client disconnecting",{keepClosed:!0}):e.socket.close(1e3,"client disconnecting",{keepClosed:!1,delay:5e3})})}}]),e}(),XS=Ra.a.mark(eI),QS=Ra.a.mark(rI),$S=Ra.a.mark(oI),ZS=Ra.a.mark(sI);function eI(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Wh.h)(Or,{includeConversations:!0});case 2:return t=a.sent,(n=new JS(k.REACT_APP_UCHAT_REAL_TIME_API_URL,e,t,navigator)).initialize(),a.abrupt("return",n);case 6:case"end":return a.stop()}},XS)}function tI(e){e.close()}function nI(e){return Pa.track(Ta.EnterLobby),Object(Wf.e)(function(t){var n=null;return e.on("message",function(e){!function(e,t){switch(e.type){case"message":return t(no.receiveMessage(e.room_id,e.room_serial_id,e.payload));case"reply":return t(no.receiveMessage(e.payload.thread_room_id,e.payload.thread_room_serial_id,e.payload,e.room_id));case"delete":return t(no.receiveDeleteMessage(e.room_id,e.payload.message_id));case"edit":return t(no.receiveMessage(e.room_id,e.room_serial_id,e.payload));case"joined":var n=e.payload.user_id;return t(bo.setParticipantStatus(n,e.room_id,!0));case"quit":var a=e.payload.user_id;return t(bo.setParticipantStatus(a,e.room_id,!1));case"active_users":var r=e.payload.active||[];return t(Zf.checkActiveUsersReceived(r));case"delete_message_action":return t(no.receiveDeleteMessageAction(e.payload));case"message_action":t(no.receiveMessageAction(e.room_id,e.payload))}}(e,t)}).on("close",function(){return Pa.track(Ta.LeaveLobby),t(Wf.a)}).on("ping",function(e){e!==n&&(t(Br.connectionStatusChange(e)),n=e)}),function(){}})}function aI(e){Pa.track(Ta.LeaveLobby),e.close()}function rI(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,Object(Wh.i)(e);case 3:return t=n.sent,n.next=6,Object(Wh.f)(t);case 6:n.next=0;break;case 8:case"end":return n.stop()}},QS)}function oI(){var e,t,n,a;return Ra.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,Object(Wh.i)(Gr.INIT_SOCKET);case 3:return e=r.sent,t=e.payload.userId,r.next=7,Object(Wh.b)(eI,t);case 7:return n=r.sent,r.next=10,Object(Wh.b)(nI,n);case 10:return a=r.sent,r.next=13,Object(Wh.g)({watchers:Object(Wh.a)([rI(a)]),cancel:Object(Wh.i)(Gr.CLOSE_SOCKET)});case 13:return r.next=15,Object(Wh.b)(tI,n);case 15:return r.next=17,Object(Wh.b)(aI,a);case 17:r.next=0;break;case 19:case"end":return r.stop()}},$S)}function sI(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([oI()]);case 2:case"end":return e.stop()}},ZS)}var iI={BLUR:"".concat("WINDOW","/BLUR"),FOCUS:"".concat("WINDOW","/FOCUS")},cI={onBlur:function(){return L(iI.BLUR,{event:"blur"})},onFocus:function(){return L(iI.FOCUS,{event:"focus"})}},uI=Ra.a.mark(fI),lI=Ra.a.mark(_I),dI=Ra.a.mark(hI),mI=Ra.a.mark(vI),pI=Ra.a.mark(EI);function fI(e){var t,n;return Ra.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:a.t0=e.type,a.next=a.t0===to.RECEIVE_MESSAGE_FULFILLED?3:a.t0===iI.BLUR?3:a.t0===iI.FOCUS?8:10;break;case 3:return a.next=5,Object(Wh.h)(kr);case 5:return(t=a.sent)>0&&(n=t>9?"9+":t,Nm.blinkTitle("(".concat(n,") unread messages"))),a.abrupt("return");case 8:return Nm.clearBlink(),a.abrupt("return");case 10:case"end":return a.stop()}},uI)}function _I(e){var t;return Ra.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.event,n.next=3,"blur"===t?Object(Wh.f)(cI.onBlur()):Object(Wh.f)(cI.onFocus());case 3:case"end":return n.stop()}},lI)}function hI(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.j)([iI.BLUR,iI.FOCUS,to.RECEIVE_MESSAGE_FULFILLED],fI);case 2:case"end":return e.stop()}},dI)}function vI(){var e;return Ra.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(Wf.e)(function(e){var t=function(){e({event:"blur"})};window.addEventListener("blur",t);var n=function(){e({event:"focus"})};return window.addEventListener("focus",n),function(){window.removeEventListener("blur",t),window.removeEventListener("focus",n)}}),t.next=3,Object(Wh.j)(e,_I);case 3:case"end":return t.stop()}},mI)}function EI(){return Ra.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Wh.a)([hI(),vI()]);case 2:case"end":return e.stop()}},pI)}var gI={alertsSagas:Zh,conversationsSagas:eE,experimentsSagas:vE,filesSagas:LE,lobbySagas:VE,messagesSagas:cO,nanodegreesSagas:gO,participantsSagas:FO,profilesSagas:sS,projectsSagas:yS,roomsSagas:ug,sessionSagas:YS,socketsSagas:sI,threadsSagas:Ng,unreadsSagas:yv,windowSagas:EI};var bI=Object(Wf.c)(),OI=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||zf.c,SI=Object(zf.d)(Hh,OI(Object(zf.a)(bI)));zh()(gI,function(e){bI.run(e)});var II=SI,yI=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(kf,null,r.a.createElement(f.Provider,null,r.a.createElement(j,null,r.a.createElement("div",null,r.a.createElement(m.a,{store:II},r.a.createElement(Vf,null,r.a.createElement(p.a,null,r.a.createElement(Z,null,r.a.createElement(Nf,null))),r.a.createElement(Bf,null)))))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(797);s.a.render(r.a.createElement(yI,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},85:function(e,t,n){e.exports={container:"user-message_container__iNMoH",avatar:"user-message_avatar__2bk48",selected:"user-message_selected__nc6Xp",fadeout:"user-message_fadeout__DnIl-",messageActions:"user-message_messageActions__36VfH",header:"user-message_header__3HG5Y",name:"user-message_name__WSQPs",messageWrapper:"user-message_messageWrapper__2Ck3e",failedPending:"user-message_failedPending__HpEih",hasOlderSibling:"user-message_hasOlderSibling__2r4xT"}},90:function(e,t,n){e.exports={listContainer:"message-list_listContainer__3LmSk",list:"message-list_list__2nrda",dayDivider:"message-list_dayDivider__1Ho1C",unreadDivider:"message-list_unreadDivider__1_onY",dayBlock:"message-list_dayBlock__1Oh9d",authorBlock:"message-list_authorBlock__3rWsM"}},92:function(e,t,n){e.exports={maxImageHeight:"384px",wrapper:"display-user-message_wrapper__Nl-Kn",emojiMessage:"display-user-message_emojiMessage__226zh",messageContent:"display-user-message_messageContent__7yiEE",menuContainer:"display-user-message_menuContainer__3QJRB",bottom:"display-user-message_bottom__1K4H5",failedPendingMessage:"display-user-message_failedPendingMessage__2_I_5",failedPendingActions:"display-user-message_failedPendingActions__3UEVs",reactionList:"display-user-message_reactionList__2SY_u"}},93:function(e,t,n){e.exports={highlights:"metric-highlights_highlights__1y4bM",iconWrapper:"metric-highlights_iconWrapper__11iET",statsWrapper:"metric-highlights_statsWrapper__tiVJK",stat:"metric-highlights_stat__20qXu",label:"metric-highlights_label__2gQe9",gridCenter:"metric-highlights_gridCenter__2md1U"}},94:function(e,t,n){e.exports={conversation:"conversations-list-item_conversation__3HMnQ",inner:"conversations-list-item_inner__1F1IC",avatar:"conversations-list-item_avatar__3uoC8",content:"conversations-list-item_content__36SzJ",messageTop:"conversations-list-item_messageTop__2EQW_",notification:"conversations-list-item_notification__oG-5R",imageContentPreview:"conversations-list-item_imageContentPreview__2M5gY",unarchive:"conversations-list-item_unarchive__2IMo0"}}},[[489,1,2]]]);
//# sourceMappingURL=main.617ca690.chunk.js.map